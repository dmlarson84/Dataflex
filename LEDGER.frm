/SCRMENU
                                        _. ______________________________
อออออ< General Ledger / Menu >อออออออออออออออออออออออออออออออออออออออออออออออออ

 1.  Add New Ledger Accounts            15.  Print G/L Accounts Detail (Month)
 2.  Review Ledger Accounts             16.  Reserved                    
 3.  Combine / Delete Accounts          17.  Print Account Balances       
 4.  Print Chart Of Accounts            18.  Create (Add) Divisions      
 5.  Cash Disbursements                 19.  Reserved               
 6.  Enter General Journal              20.  Reserved                  
 7.  Change Journal Entry               21.  Replicate Ledger Accounts
 8.  Print General Account Journals     22.  Reserved                 
 9.  Print General Accounts Detail      23.  Repost All Journals        
 10. Print General Accounts Summary     24.  Process End Of Year
 11. General Accounts Detail (Select)   25.  Reserved            
 12. Reserved                           26.  Enter Last Year's Balances
 13. Print Receipts Statement (Range)   27.  Maintain Budget 
 14. Print General Ledger Trial Balance 28.  Setup & Maintenance Menu

อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ
 
                Please Enter Your Selection : ___

      
/SCRSTART resident
                                  User ID..{ _. ______________________________

อออออออออ< General Ledger Main Menu >อออออออออออออออออออออออออออออออออออออออออ

                  1.  Hot Check Trust Accounts 
                  2.  Prosecutors Fees Accounts
                  3.  Print General Ledger Trial Balance
                  4.  General Ledger Support Programs
                  5.  General Ledger Setup 
                  6.  Quit



อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ




   Please Enter Your Selection..............{ _
                   
/SCRHC resident


ออออออออ< General Ledger / Hot Check Trust >อออออออออออออออออออออออออออออออออออ

                  1.  Print General Ledger Trial Balance
                  2.  Print Chart of Accounts
                  3.  Cash Disbursements (Bank Adjustments)
                  4.  Reserved
                  5.  Print Account Journals
                  6.  Review Ledger Accounts
                  7.  Quit to General Ledger Main Menu


อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ




    Please Enter Your Selection............{ _


/SCRPROS resident


ออออออออ< General Ledger / Prosecutors Fees Account >ออออออออออออออออออออออออออ

                  1.  Print General Ledger Trial Balance
                  2.  Enter Receipts / Deposits
                  3.  Enter Disbursements
                  4.  Print Chart of Accounts
                  5.  Check Register
                  6.  Print Account Journals
                  7.  Review Ledger Accounts 
                  8.  Quit to General Ledger Main Menu

อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ




   Please Enter Your selection............{ _


/REPBODY
______.   
___       
__ 
_________________________
_
/SCRREP       
อออออออ< Replicate Accounts >อออออออออออออออออออออออออออออออออออออออออออออออออ=





    Select Ledger Number Greater Than Or Equal To.....{ ___.
    Select Ledger Number Less Than Or Equal To........{ ___.
    District .........................................{ ___
    Select Division Equal To..........................{ __

    Replicate For District............................{ ___
    Replicate For Division............................{ __


/SCRREP2
อออออออ=< Duplicate Ledger Accounts >ออออออออออออออออออออออออออออออออออออออออออ





   Copying Selected Accounts to Temporary File:

      Account #  District   Division   B/R         Description
      ---------  ---------  --------   ---   -----------------------------
         ___.      ___        __        _    _____________________________



   Creating New Account With Selected Division ..{ __

      Account #  District   Division   B/R         Description
      ---------- ---------  --------   ---   ------------------------------
         ___.      ___        __        _    ______________________________





/SCRDIV
อออออ< General Ledger / Divisions >อออออออออออออออออออออออออออออออออออออออออออ




           Code..........................{ __
           Division Name.................{ ______________________________
         
           Accounts Payable Account #....{ ___.
           Accounts Receivable Account #.{ ___.
          
           Bank Code.....................{ __
           Type of Bank Account..........{ __  

  Number Of Ledger Accounts Using This Division.........{ __.

/SCRMAST     
อออออออ< General Ledger / Accounts >อออออออออออออออออออออออออออออออออออออออออออ

Division < __  District ___  Account# ___.  _________________________  Type  _
                                              
                    Totals This Year     Totals Last Year      Budget
Beginning Balance     _______.__           _______.__
January               _______.__           _______.__         _______.__
Feburary              _______.__           _______.__         _______.__
March                 _______.__           _______.__         _______.__
April                 _______.__           _______.__         _______.__        
May                   _______.__           _______.__         _______.__        
June                  _______.__           _______.__         _______.__
July                  _______.__           _______.__         _______.__
August                _______.__           _______.__         _______.__   
September             _______.__           _______.__         _______.__   
October               _______.__           _______.__         _______.__
November              _______.__           _______.__         _______.__
December              _______.__           _______.__         _______.__
                      ฤฤฤฤฤฤฤฤฤฤฤ          ฤฤฤฤฤฤฤฤฤฤฤ        ฤฤฤฤฤฤฤฤฤฤฤ
Current / Ending Bal  _______.__           _______.__         _______.__   
อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ
<F9> To Clear           <F10> Save record           <ESC> To return to menu   


/SCRADD          
อออออ< General Ledger / Create New Ledger Accounts >ออออออออออออออออออออออออออ





  

       Account Number...{ ___. District..{ ___ Division  ..{ __

       Account Description...{ _________________________

       B)alance or R)evenue..{ _  (B/R)           

       D)etail or T)otals....{ _  (D/T)                  

       Opening Balance.......{ _______.__   Dr = Plus  Cr = Minus             




       ________________________________________  _

/SCRGEN         
อออออ=< General Ledger / General Journal Entry >อออออออออออออออออออออออออออออออ
Journal: __   Entry Date: YR _____. MN _. DAY _.  Desc.: ______________________
อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ
   G/L Dist Div   Description          D/C   Amount      Seq#    Ref#        
 1.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
 2.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
 3.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
 4.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
 5.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
 6.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
 7.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
 8.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
 9.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
10.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
11.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
12.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
13.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
14.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
15.___. ___ __ _________________________ _ ________.__ _______. _______. _____.
Journal Balance _______.__ _______          _______.__ ______ TOTAL
<F1> For Help  <F9> To Clear        Press <ENTER>  if less than 15 accounts.
<F10> To Save Entries               Press <ESCAPE> to quit to main menu
______________________________ _.   D/C  D = Debit    C = Credit             

/SCRGEN2     
ษอออ< General Journal Explanation >ออออออออออออออออออออออออออออออออออออออออออป
บ                                          Reference Number..{ ____.         บ
บ   Operator...{ __. _____________________________                           บ
บ                                                                            บ
บ   Notation...{ ________________________________________                    บ
บ              { ________________________________________                    บ
บ              { ________________________________________                    บ
บ                                                                            บ
บ                                                                            บ
บ             ________________________________________  _                    บ
ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ

/SCRGENHELP
อออออ< General Journal Help Screen >ออออออออออออออออออออออออออออออออออออออออออ=

 The General Journal allows creation of journal entries for Revenue or
  Expense items for which there are no provisions for entry into the 
  system thru the regular division's journals.

 Remember all journal entries MUST balance before updating your entries,
  ie: Debits must equal Credits

 1.  When you have completed your entries, Press <ENTER> to proceed to
     update, You will then be given your options.

 2.  Your Options are:
       Key to Press             Action
       -------------         ------------------------------------------------
            (U) ............. Entries will be updated to proper journal and 
                              ledger accounts, screen will be cleared and it
                              will ask whether to create more entries.

            (D) ............. Clears screen and readies same for entries

            (E) ............. This selection allows you to edit any entry
   


Press any key to continue. 


/SCREDIT     RESIDENT
อออ< General Ledger / Change Journal Entries >ออออออออออออออออออออออออออออออออ
                  
                       Record Number _____.

              Current                                Changed
                                                                               
    Journal : __                       บ    Journal : __                       
                                       บ                                       
Entry Date :Yr ____. Month __. Day __. บEntry Date :Yr ____. Month __. Day __.
                                       บ
Account # : ___. District  ___ Div  __ บAccount # : ___. District  ___ Div  __
                                       บ
Description : _________________________บDescription : _________________________
                                       บ                                       
     Amount : _______.__               บ     Amount : _______.__               
                                       บ                                       
 Sequence #     : ______.              บ  Sequence #        : ______.           
                                       บ                                       
Defendant/Ref # : ______.              บ  Defendant / Ref # : ______.         
                                       บ                                       
Offense #       : ______.              บ  Offense #         : ______.          



/SCRALTER       
ออออ< General Ledger / Delete  Accounts >อออออออออออออออออออออออออออออออออออออ=
Delete                                 Account
Move.. G/L# < ___.   Dist ___ Div __ >  Description _________________________

                                                Balance or Revenue _  (B or R) 
Monthly Totals This Year:
Jan _______.__ Feb _______.__ Mar _______.__ Apr _______.__ May _______.__ 
Jun _______.__ Jul _______.__ Aug _______.__ Sep _______.__ Oct _______.__ 
Nov _______.__ Dec _______.__    Opening Bal _______.__      New Bal _______.__
ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ
Monthly Totals Last Year:
Jan _______.__ Feb _______.__ Mar _______.__ Apr _______.__ May _______.__ 
Jun _______.__ Jul _______.__ Aug _______.__ Sep _______.__ Oct _______.__ 
Nov _______.__ Dec _______.__    Opening Bal _______.__   Ending Bal _______.__
ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ
Budget Per Month This Year:
Jan _______.__ Feb _______.__ Mar _______.__ Apr _______.__ May _______.__ 
Jun _______.__ Jul _______.__ Aug _______.__ Sep _______.__ Oct _______.__ 
Nov _______.__ Dec _______.__                           Budget Total _______.__
ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ
Options:   Enter one of the Options (D/T/M/C) .............{ _
D)elete acc't only,  T)ransfer amts only,  M)ove amts & delete acc't , C)ancel 

/SCRALTER2    
ออออออ< General Ledger / Combine Accounts >ออออออออออออออออออออออออออออออออออออ
                                     Account
ADD TO G/L# <___. Dist ___ Div  __ >  Description _________________________

                      Balance or Revenue _  (B or R) 
Monthly Totals This Year:
Jan _______.__ Feb _______.__ Mar _______.__ Apr _______.__ May _______.__ 
Jun _______.__ Jul _______.__ Aug _______.__ Sep _______.__ Oct _______.__ 
Nov _______.__ Dec _______.__   Opening Bal _______.__   New Bal ______.__
ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ
Monthly Totals Last Year
Jan _______.__ Feb _______.__ Mar _______.__ Apr _______.__ May _______.__ 
Jun _______.__ Jul _______.__ Aug _______.__ Sep _______.__ Oct _______.__ 
Nov _______.__ Dec _______.__  Opening Bal _______.__  Ending Bal _______.__
ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ
Budget Per Month This Year:
Jan _______.__ Feb _______.__ Mar _______.__ Apr _______.__ May _______.__ 
Jun _______.__ Jul _______.__ Aug _______.__ Sep _______.__ Oct _______.__ 
Nov _______.__ Dec _______.__                      Budget Total _______.__
ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ
________________________________________ (Y/N) _



/SCRALTER3        RESIDENT
~~~~~~~< Update Journals >~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~





       <<<    Please Standby - Journals Are Being Updated   >>>





/SCRALTERHELP    
ออออออ=< Help Screen For Deleting or Moving Ledger Accounts >อออออออออออออออออ=

Your Selections Are:

1.  <D> = Delete a ledger account if there are no amounts in any of the
          beginning, monthly or ending fields

2.  <T> = Transfer account balances to another account only, this routine
          will not delete the transfer from account.

3.  <M> = Move account balances to another account (deletes the balances
          from the original account.

4.  <C> = Cancel, clear the screen and start over again


<F9>  key = To clear screen and return to ledger number field
<ESC> key = Clearall and return to main menu

               <<<< Press any key to continue.... >>>>
/CHTHEADER 
===============================================================================

                  GENERAL LEDGER CHART OF ACCOUNTS                            
                               for
           ______________________________________________
 
-------------------------------------------------------------------------------
 G/L Number  District  Division     Description                   Type    
-------------------------------------------------------------------------------
/CHTBODY 
    ___.      ___         __      _________________________         _   
/SCRCHART    
----< General Ledger / Print Chart Of Accounts >-------------------------------



              District................{  ___         
                     Select Optional Division   __  (A=ALL)

             Output to Printer or Console (C,P) _



/LDHEADER  
======< General Ledger Detail >================================================

For { ________________________________________________                Page __

Date Printed { __/__/____
============================================================================== 

/LDSUBHEADER1 
-------------------------------------------------------------------------------
___.-___-__ _________________________    Beginning Balance ___,___,___.__ 
__,___,___.__ ___   __,___,___.__ ___   __,___,___.__ ___   __,___,___.__ ___ 
__,___,___.__ ___   __,___,___.__ ___   __,___,___.__ ___   __,___,___.__ ___ 
__,___,___.__ ___   __,___,___.__ ___   __,___,___.__ ___   __,___,___.__ ___ 
                                                  
Oper    Date    Description              JR   Ref#  Off#  Seq #    Amount
----    ----    -----------              --   ---  -----  -----    ------
/LDBODY 
 __Z. _./_./___. _______________________ __ ____Z. ____Z. ____Z. _,___,___.__
/LDSUBTOTAL1 
                                                              ---------------
                                           < Ending Balance >  ___,___,___.__  
/LDTOTAL
===============================================================================
                                            General Ledger Balance _______.__ 
/STNBYLD      
~~~~~~~~< Report Printing >~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~






                    <<<<  Please Standby  >>>>


             Now Printing Ledger Account  ____. Detail











Press Any Key To Abort

/SCRLD     
ออออ< General Ledger / Detail Report >อออออออออออออออออออออออออออออออออออออออออ






      District................{  ___         
          Enter Division  ........{  __  (A=ALL)




      Output To  P)rinter  C)onsole  or A)bort.......... { _  (P/C/A)



/JRHEADER RESIDENT
~~~~~~~~~~~~< __     _________________________ >~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

JOURNAL LISTING FOR ______________________________________________   PAGE __.
===============================================================================
  Date   G/L DIS DIV     Description            Ref#   Off#   Rec#     Amt.
-------------------------------------------------------------------------------
/JRBODY RESIDENT
_./_./___. ___.-___-__ ______________________ ____Z. ____Z. ____Z. _,___,___.__
/JRDAYSUBTOTAL      RESIDENT
-------------------------------------------------------------------------------
 # OF  ENTRIES ____.         DAY OUT OF BALANCE BY *************   _,___,___.__
                           ====================================================
/JRSUBTOTAL2 RESIDENT
-------------------------------------------------------------------------------
 # OF  ENTRIES _____.        MONTH OUT OF BALANCE BY ***********   _,___,___.__
                            ===================================================
/JRSUBTOTAL1 RESIDENT
-------------------------------------------------------------------------------
TOTAL JOURNAL ENTRIES _____. JOURNAL OUT OF BALANCE BY *********   _,___,___.__
                            ===================================================
/JRTOTAL RESIDENT
-------------------------------------------------------------------------------
TOTAL JOURNAL ENTRIES _____. JOURNALS OUT OF BALANCE BY ********   _,___,___.__
===============================================================================
/JRNONE
No Journal Entries To Print
/JRBLANK      RESIDENT
-----
/SCRJR     
อออออออ< Journal Entries >อออออออออออออออออออออออออออออออออออออออออออออออออออออ


     Please Enter The Your Options Below To Print Journals.   



    Enter The Starting Month...................{ _. Day _.  Year ___.

        Enter The Ending Month ....................{ _. Day _.  Year ___.

        Enter The Journal First Journal To Print...{ __
        Enter The Last Journal To Print............{ __

        District ..................................{ ___             
        Enter Division  ...........................{ __             

      Output To  P)rinter  C)onsole  or A)bort.......... { _  (P/C/A)

/STNBYJR    RESIDENT
~~~~~~~~< Report Printing >~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~







                       <<<< Please Standby >>>>




                       Now Printing Journal __







Press Any Key To Abort:

/REVTOP














/REVHEADER 
===============================================================================
              __________________________________________________
              __________________________________________________
              __________________________________________________
              __________________________________________________
   District < ___ >    Division/Entity < __ >  ________________________ 

                                 Month Of _____              YEAR TO DATE
--------------------------------------------------------------------------------
/REVSUBHEADER1 
  ________________________
/REVBODY 
____ __________________________ _,___,___.__            _,___,___.__
/REVBODY2
____ __________________________                         _,___,___.__
/REVDASHES 
                               -------------            -------------
/REVDASHES2
                                                        -------------
/REVBLANKLINE

/REVEQUALS 
                               ==============           =============
/REVEQUALS2
                                                        =============
/REVEQ3
==============================================================================
/REVCOMMENT
                 _____________________________________________
/REV2HEADER 
              __________________________________________________
              __________________________________________________
              __________________________________________________
              __________________________________________________

                                  ____ THRU ____               YEAR TO DATE
                                 AMOUNT     RATIO            AMOUNT     RATIO
/REV2SUBHEADER1 
  ________________________
/REV2BODY 
________________________ ___,___,___.__   ____.__    ___,___,___.__   ____.__ 
/REV2DASHES 
                         --------------   -------    --------------   -------
/REV2BLANKLINE 

/REV2EQUALS 
                         ==============   =======    ==============   =======
/REV2COMMENT 
                 _____________________________________________
/SCRREV2
ออออออออออ< Revenue Statement / Range of Months >ออออออออออออออออออออออออออออออ


  


     Enter First Month..................{ _.

     Enter Final Month..................{ _.

     Enter Alternate Header Discription.{ _________________________

     Enter Date To Appear On Report.....{ _________________________

     Enter Report Number................{ _.

    Print Zero Balance Accounts.... (Y/N) _

Output To (C)onsole, (P)rinter or (A)bort _




/SELHEADER 
=========< General Ledger Detail >=============================================
Date Printed             Selected Activity of Accounts                  Page _.
__/__/____               ______________________________
===============================================================================

/SELSUBHEADER1 
____ ___ __ _________________________        BEGINNING BALANCE   __,___,___.__ 
Oper     Date   Description               JR  Ref#   Off # Rec # 
/SELBODY 
 ____. _./_./____ _______________________ __ ____Z. ____Z. ____Z. _,___,___.__
/SELSUBTOTAL1 
                                                                 -------------
              Transaction Total __,___,___.__     Account Total  __,___,___.__ 

/SELTOTAL 
                                 General Ledger Out Of Balance By _,___,___.__ 
/SCRSEL
อออออ< General Ledger / Print Account Detail >อออออออออออออออออออออออออออออออออ

   Select up to 9 Accounts to Print :       Number Of Accounts Selected.{ _

          Account #  ___. District ___ Div . __ _________________________
  
   
          Enter First Month To Process _.  Year ___.
          Enter Final Month To Process _.  Year ___.
          D)ebits only   C)redits only   B)oth ....{ _  (D/C/B)

    Output This Report To :  P)rinter  C)onsole  A)bort......{ _  (P/C/A)

        If Output To Printer, Print New Page Per Account..{ _  (Y/N)

F7 = View Selected Accounts      F9 = Clear and Restart       ESC = Quit
                                     






/STNBYDET   RESIDENT
ออออ=< General Ledger Detail Printing >อออออออออออออออออออออออออออออออออออออออ=







                         <<<<<  STANDBY  >>>>>


                Now Printing Account Number ____ Detail





Press any Key To Quit:




/SCRSEL2   
Accounts Selected:
___. ___ __   ___. ___ __   ___. ___ __   ___. ___ __   ___. ___ __ 
___. ___ __   ___. ___ __   ___. ___ __   ___. ___ __ 

Press Any Key To Continue
/SUMHEADER 
General Ledger Detail__________________________________________________ Page __
===============================================================================
/SUMBODY 
___.-___-__ _________________________         Beginning Balance ___,___,___.__ 
__,___,___.__  ____ __,___,___.__  ____ __,___,___.__  ____ __,___,___.__  ____
__,___,___.__  ____ __,___,___.__  ____ __,___,___.__  ____ __,___,___.__  ____
__,___,___.__  ____ __,___,___.__  ____ __,___,___.__  ____ __,___,___.__  ____
                                               Ending Balance ___,___,___.__  *
    ---------------------------------------------------------------------------
/SUMTOTAL 
===============================================================================
                                           General Ledger Balance _,___,___.__
     This balance should be equal to net Revenue for year to date.
/SCRSUM
อออออออ< General Ledger / Summary Trial Balance >ออออออออออออออออออออออออออออออ





            District....................{ ___           
            Select Division  ...........{ __  (A=ALL)





        Output To  P)rinter, C)onsole or A)bort (Y/N)..{ _



/BALHEADER 
              __________________________________________________
              __________________________________________________
              __________________________________________________
              __________________________________________________
/BALSUBHEADER1 
  ________________________
/BALBODY 
________________________   ___,___,___.__  
/BALDASHES 
                           --------------
/BALSUBTOTAL 
  _________________________                 ___,___,___.__  
/BALCDASH 
                                            --------------
/BALRDASH 
                                                               --------------
/BALBLANKLINE 

/BALTOTAL 
  _________________________                                    ___,___,___.__
/BALEQUALS 
                                                               ==============
/BALEQUALSM 
                                            ==============
/BALNETINCOME
   NET REVENUE (LOSS) SHOULD NOT BE USED FOR BALANCE SHEETS
/BALCOMMENT2
                 _____________________________________________
                 _____________________________________________
/SCRBAL
ออออออออ< Balance Sheet / Revenue Statement >ออออออออออออออออออออออออออออออออออ



          Enter Month To Report................{ _.
 
          Enter Report Title...................{ _________________________

          Enter Date To Appear On Report.......{ ______________________________

          Enter Report Number..................{ _.

          Print Zero Balance Account (Y/N).....{ _

Output to  C)onsole,  P)rinter, or  A)bort.....{ _

Report Numbers:
     Hot Checks..............{ 20
     Prosecutors Fees........{ 01

/PRTENDBODY
___. _. _.

/QIKHEADER RESIDENT
=========< General Ledger / Trial Balance >====================================
 __________________________________________________                   PAGE __
===============================================================================
 G/L#     Dist   Div         Description                Amount
-------------------------------------------------------------------------------
/QIKBODY RESIDENT
 ___.     ___    __      _________________________   _,___,___.__ 
/QIKTOTAL RESIDENT
                                                     ------------
                           Out Of Balance By .....{  _,___,___.__ 
/SCRQIK
---------< General Ledger / Print Trial Balance >------------------------------








            District......................{ ___          
            Select Division  .............{ __  (A=ALL)





       Output To  P)rinter, C)onsole, A)bort ............{ _



Press Any Key To Interrupt Printing....

/SHOWQIK    RESIDENT
ออออออออ=< General Ledger / Trial Balance >ออออออออออออออออออออออออออออออออออออ








        Now Printing Account Number.{ ___.  _________________________





Press Any Key To Interrupt...




/SCRUPDATE
ออออ< General Ledger / Repost All Journal Entries To Ledger >ออออออออออออออออออ


All journal transactions will be reposted to the proper General Ledger Master 
record.  This program need be run only if errors have occurred or accounts 
have been improperly deleted.

Depending on equipment and number of journal transactions this program can
take some time.  If it is late in the year, run this when the computer is not
going to be needed for 30 minutes to an hour or more.


    (C)ontinue or (A)bort (C/A) _






/PRTTRHEADER RESIDENT 
==========< General Ledger / Trial Balance >===================================
__/__/____     _________________________________________             Page ____
===============================================================================
 Rec     Date   Description                 ID #  JOB #  REF #
-------------------------------------------------------------------------------
/PRTTRSUBHEADER1 RESIDENT
___.-___-__ _________________________         Beginning Balance   __,___,___.__
/PRTTRBODY RESIDENT
 ____. _./_./_. _________________________ ____Z. ____Z. ____Z. _,___,___.__ 
/PRTTRSUBTOTAL2 RESIDENT
                                  __ Journals Total               __,___,___.__
/PRTTRSUBTOTAL1  RESIDENT
                                      Account Total  __,___,___.__ *

/PRTTRTOTAL RESIDENT
                                General Ledger Out Of Balance By _,___,___.__ 
/SCRTRIAL
----< General Ledger / Trial Balance >----------------------------------------







          District...................{ ___          
          Select Division  ..........{ __  (A=ALL)

          Enter Month To Print.......{ _. YR _.






/HELPSCR1

อออออ< General Ledger Help Screen >ออออออออออออออออออออออออออออออออออออออออออออ

CREATE NEW LEDGER ACCOUNTS:  Enter Account number, District and Division  
                             if known.

                             The B)alance or R)evenue field requires an entry 
                             of "B" OR "R", B = This account will be printed on
                             the Revenue Statement.



/PRINTSCR
อออออออ< Report Printing >อออออออออออออออออออออออออออออออออออออออออออออออออออออ









                   Please Standby Printing Report








Press any key to stop

/OPABORT

*******  Aborted By Operator  *******
/REPBOT

*******  E N D    O F    R E P O R T  ******
/TEMP
       This screen will never display, it just holds temporary data in windows

__/__/____    __/__/____   __/__/____    ______.__  ______.__ ______.__

______.   ______.   ______.    _______________________________________
                                    ASCII  40 char

     
/SCRSWITCH  
อออออออ< Switch Fiscal Years >อออออออออออออออออออออออออออออออออออออออออออออออออ



This program toggles the working journals between last year's and this year's
journals.  Upon completion the first journal in the file will show it's month
and year.  If the wrong information is displayed answer Y to the retoggle
question.

                  First Journal _./_./____

                    Switch Again (Y/N) _

    

                   <<<<   DO NOT INTERRUPT   >>>>

/SCRLY    
อออออออออออ< Enter Last Years Totals >อออออออออออออออออออออออออออออออออออออออออ

 Ledger Number....{ ___.  District..{ ___ Division..{ __    
 Account Description....{ _________________________   
   
 Monthly Totals Last Year:

 Beginning Balance...{ _______.__

 January.{ _______.__     February.{ _______.__     March......{ _______.__   

 April...{ _______.__     May......{ _______.__     June.......{ _______.__  

 July....{ _______.__     August...{ _______.__     September..{ _______.__  

 October.{ _______.__     November.{ _______.__     December...{ _______.__  


 Total................{ _______.__   

 F1 = Help      F9 = Clear      <ESC> = Clear and return to Main Menu

/SCRLYHELP
อออออออออออ< Help Screen For Entering Last Year's Balances >อออออออออออออออออออ


     You may enter the previous accounting year's account balances for 
     comparative analysis with the current year's data and the budget data.

     When entering, find the first account by entering Account #, District
     and Division.
     Enter amounts and save by either entering all the fields to the
     end or using the <F10> key.

     You may then page thru the accounts using the <Pg Up> and <Pg Dn> keys
     and entering amounts as necessary.






    <Press any key to Continue>     






/SCRBUD
อออออออออ< Maintain Budget Amounts >อออออออออออออออออออออออออออออออออออออออออออ

Ledger Number..{ ___.  District..{ ___ Division..{ __
Account  Description.......{ _________________________

Budget For Current Year:

Total For Year...{ ________.__  

January.{ ________.__   February.{ ________.__   March.....{ ________.__   

April...{ ________.__   May......{ ________.__   June......{ ________.__  

July....{ ________.__   August...{ ________.__   September.{ ________.__  

October.{ ________.__   November.{ ________.__   December..{ ________.__  

ออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ

<F9> Clear                 <F10> To Save             <ESC> To Return To Menu



/SCRLOAD   RESIDENT
อออออออออออออ< General Ledger System >อออออออออออออออออออออออออออออออออออออออออ










                       Now Loading Program Selected



/SCRJR2
อออออออออออออ< General Ledger System >อออออออออออออออออออออออออออออออออออออออออ





   Please Standby :

                    Searching for your selections



   Now looking at Journal record # ...................{ ________.



                       Press any key to abort

/YRENDWARN
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


   You have selected to process year end !!!!!

      This routine clears all journal records and prepares 
      system for next year.

   ARE YOU SURE THIS IS WHAT YOU WISH TO DO ?..(Y/N)....{ _




/info

  change made 04/02/91 by gary grooms
       added a chain to pchecks in the prosecutor menu to provide
       for the printing of the fees account check register

  change made 10/26/94 by Gary Grooms
       Installed a new journals print program independant from the
       routine included within this ledger program.
       Accessed VIA the chain command



    01-28-1999 By Gary Grooms
        Modified program to comply with y2k - 4 digit years and changed
        save routines to comply with v3.1d re-read, save, unlock etc.
        edited the sysdate command to sysdate4 command (new V3.1d)


    08-12-1999 By Gary Grooms
        Changed the YEAR field in the General Journal entry screen to
        allow for 4 digt year. The limits (CHECK = ) was set at 79 thru 99
        Changed to 1979 thru 2100

    10-08-99 By Gary Grooms
        Added reread and unlock to General journal entry routine


    10-21-99 By Gary Grooms
        Corrected the year range from 80 - 99 to 1980 - 2100 in print
        journal select routine

    10-28-99 By Jeff March 
        Added direct output to LPT1:

Recompiled 01-19-2000 by Jeff March
        Recognize new backspace command in calcdate.inc
		
	2-18-2011 Jeff March/Luke Minkner	
        Changed Revenue Statement - 1215 Partial Receipts to reflect YTD
        instead of To-Date.  Added seperate GOSUB for "PN" Accts.

/*

Use y2k.pkg
Read_dfini "df23ini.cfg"

//----------------- Cannot Run Program From Command Line (DOS)
IF NEXT_MENU LE 0 ABORT
INTEGER USER_NUMB USER$_ACCESS   //must be first integers defined in program
STRING USER$ 30
MOVE '' TO USER$
MOVE 0 TO USER$_ACCESS
//------------------------------------------------------------
//-------------- Find Logged On User For Program Use
#INCLUDE calcdate.inc
#Include macs.frm


OPEN USERX
CLEAR USERX
MOVE USER_NUMB TO USERX.USER_NUMB
FIND EQ USERX BY INDEX.1
MOVE USERX.USER_NAME TO USER$
MOVE USERX.ACCS_LEVL TO USER$_ACCESS

//----------------------------------------------------

//-------< Declare Variables >------------------------------------------------
INDICATOR DIS DIV FIRST SECOND THIRD GOOD OK 
INDICATOR MAST_SCR ADD_SCR GEN_SCR EDIT_SCR ALTER_SCR ALTER2_SCR ALTER3_SCR
INDICATOR CHART_SCR LD_SCR JR_SCR REV_SCR SEL_SCR SEL2_SCR SUM_SCR BAL_SCR
INDICATOR YREND_SCR QIK_SCR UPDATE_SCR ADJ_SCR INC_SCR
INDICATOR MENU_SCR INJOURNAL  STOP_PRINT DIV_SCR PRT changejr nojr
INDICATOR NEWREC REP_SCR COMBINE_SCREENS NOTZERO DEL GEN2_SCR SWITCH_SCR
INDICATOR LY_SCR BUD_SCR BUSY REV2_SCR START_SCR HC_SCR PROS_SCR

STRING EXIT_SCREEN 1 CHAR 1 JR 2 STARTDATE 6 ENDDATE 6 LONG 50 SHORT 50
STRING QUIT 1 ANSW 1 VALID_DIVISIONS 11 CHECK_DIV 2 JRNAME 25 out_dest 1
String legdate

INTEGER COUNT RECORD GLCOUNT LINE LCOUNT SEQ RECORD2
INTEGER ADAY AMONTH AYEAR JR_MONTH TIMER JR_DAY

NUMBER ANSWER ACCUM ACCUM1 ACCUM2 ACCUM3 ACCUM4 ACCUM5 ACCUM6 ACCUM7        
NUMBER ACCUM8 ACCUM9 ACCUM10 ACCUM11 ACCUM12 ACCUM13 ACCUM14 TRANS
NUMBER RUN_BAL SIZE_OF_FILE PERIOD div_accts hr min sec

DATE ENTDATE DFR_DATE DFR_DATE2 Today

DATE_MACRO_INIT

// NAMES FOR MENU SCREEN

NAME scrmenu  menu_user_num menu_user option_num

// NAMES FOR MASTER LEDGER SCREEN

NAME scrmast  mast_dept mast_div mast_acc Mast_desc Mast_type 
NAME          mast_curyr_beg mast_lastyr_beg
NAME          mast_tyjan mast_lyjan mast_bjan
NAME          mast_tyfeb mast_lyfeb mast_bfeb
NAME          mast_tymar mast_lymar mast_bmar
NAME          mast_tyapr mast_lyapr mast_bapr
NAME          mast_tymay mast_lymay mast_bmay
NAME          mast_tyjun mast_lyjun mast_bjun
NAME          mast_tyjul mast_lyjul mast_bjul
NAME          mast_tyaug mast_lyaug mast_baug
NAME          mast_tysep mast_lysep mast_bsep
NAME          mast_tyoct mast_lyoct mast_boct
NAME          mast_tynov mast_lynov mast_bnov
NAME          mast_tydec mast_lydec mast_bdec
NAME          mast_tytot mast_lytot mast_btot

//-------< open files >--------------------------------------------------------

multi$ OPEN REF LEDGER MONTHS SYSFILE RPTMAST JRLIST BANK RECON
OPEN JOURNALS 3
OPEN DIVISION 1
OPEN RECHANGE
//-------< Set Variables >----------------------------------------------------

INDICATE DIS TRUE                      
INDICATE DIV AS REF.DIVISION  MATCH "Y"
MOVE 0 TO RUN_BAL
MOVE 0 TO SIZE_OF_FILE
MOVE '' TO VALID_DIVISIONS
MOVE 'HC|CM|VR|PO' TO VALID_DIVISIONS
Sysdate4 Today Hr Min

PAGE SET SCRSEL2 AT 18 20
PAGE SET SCRGEN2 AT 12 1

FORMAT SCRBAL.1     {RANGE=1,12}
FORMAT SCRBAL.4     {RANGE=1,99}
FORMAT SCRBAL.5     {CAPSLOCK,CHECK="YN"}
FORMAT SCRBAL.6     {CAPSLOCK,CHECK="CPA"}

//=======< Main Program Subroutines >==========================================

//****< General Ledger Menu >**************************************************

     MOVE 0 TO SIZE_OF_FILE
      FILE_SIZE REF TO SIZE_OF_FILE
      IF SIZE_OF_FILE EQ 0 GOSUB DO_SETUP_FIRST
     MOVE 0 TO SIZE_OF_FILE
      FILE_SIZE DIVISION TO SIZE_OF_FILE
      IF SIZE_OF_FILE EQ 0  GOSUB DO_SETUP_FIRST
     MOVE 0 TO SIZE_OF_FILE
      FILE_SIZE MONTHS TO SIZE_OF_FILE
      IF SIZE_OF_FILE EQ 0 GOSUB DO_SETUP_FIRST
     MOVE 0 TO SIZE_OF_FILE

     FORMAT OPTION_NUM          {RANGE=1,28}
     FORMAT SCRSTART.3          {RANGE=1,6}
     FORMAT SCRHC.1             {RANGE=1,7}
     FORMAT SCRPROS.1           {RANGE=1,8}

START_MENU:
    INDICATE START_SCR TRUE
    INDICATE HC_SCR FALSE
    INDICATE PROS_SCR FALSE
    INDICATE MENU_SCR FALSE
    PAGE SCRSTART
    DISPLAY USER_NUMB TO SCRSTART.1
    DISPLAY USERX.USER_NAME TO SCRSTART.2

  TOP_START_GL:
    REPEAT
         CLEARFORM SCRSTART.3
         ACCEPT SCRSTART.3
         IF ~ SCRSTART.3 IN '123456' LOOP
              IF SCRSTART.3 EQ (1) GOTO HC_MENU
              IF SCRSTART.3 EQ (2) GOTO PROS_MENU
              IF SCRSTART.3 EQ (3) gosub print_revenue
              IF SCRSTART.3 EQ (4) GOTO LEDGER_MENU
              IF SCRSTART.3 EQ (5) BEGIN
                                       PAGE SCRLOAD
                                       CHAIN "LEGSETUP"
                                   END
              IF SCRSTART.3 EQ (6) ABORT

  HC_MENU:
    PAGE SCRHC
    INDICATE HC_SCR TRUE
    INDICATE START_SCR FALSE
    INDICATE PROS_SCR FALSE
    INDICATE MENU_SCR FALSE
  TOP_HC_GL:
    REPEAT
         CLEARFORM SCRHC.1
         ACCEPT SCRHC.1
    IF ~ SCRHC.1 IN '1234567'LOOP

    IF SCRHC.1 EQ (1) GOSUB PRINT_revenue
    IF SCRHC.1 EQ (2) GOSUB CHART_LEDGER
    IF SCRHC.1 EQ (3) BEGIN
                         PAGE SCRLOAD
                         CHAIN 'CHECKS'
                      END
    IF SCRHC.1 EQ (4) BEGIN
                        CLEARFORM SCRHC
                        GOTO TOP_HC_GL
                      END
    IF SCRHC.1 EQ (5) Begin                                          //GOSUB PRINT_JOURNALS
                           Page scrload
                           chain 'jrnls'
                      end
    IF SCRHC.1 EQ (6) GOSUB MASTER_LEDGER
    IF SCRHC.1 EQ (7) GOTO START_MENU
goto hc_menu


PROS_MENU:
    PAGE SCRPROS
    INDICATE PROS_SCR TRUE
    INDICATE HC_SCR FALSE
    INDICATE START_SCR FALSE
    indicate menu_scr false
  TOP_PROS_GL:
    repeat
        CLEARFORM SCRPROS.1
        ACCEPT SCRPROS.1
    if ~ scrpros.1 in '12345678' loop

    IF SCRPROS.1 EQ (1) GOSUB PRINT_REVENUE
    IF SCRPROS.1 EQ (2) BEGIN
                          PAGE SCRLOAD
                          CHAIN 'DEPOSIT'
                        END
    IF SCRPROS.1 EQ (3) BEGIN
                          PAGE SCRLOAD
                          CHAIN 'CHECKS'
                        END
    IF SCRPROS.1 EQ (4) GOSUB CHART_LEDGER
    IF SCRPROS.1 EQ (5) BEGIN
                           page scrload
                           chain 'pchecks'
                        END
    IF SCRPROS.1 EQ (6) Begin                              //GOSUB PRINT_JOURNALS
                           Page scrload
                           chain 'jrnls'
                        end
    IF SCRPROS.1 EQ (7) GOSUB MASTER_LEDGER
    IF SCRPROS.1 EQ (8) GOTO START_MENU
goto pros_menu


LEDGER_MENU:

    REPEAT
         CLEARFORM OPTION_NUM
         PAGE SCRMENU
         DISPLAY USER_NUMB TO SCRMENU.1
         DISPLAY USERX.USER_NAME TO SCRMENU.2
  TOP_MENU:
         INDICATE MENU_SCR TRUE
         INDICATE HC_SCR FALSE
         INDICATE PROS_SCR FALSE
         MOVE '' TO OPTION_NUM
         ACCEPT OPTION_NUM
         IF OPTION_NUM EQ 1  GOSUB ADD_ACCOUNTS 
         IF OPTION_NUM EQ 2  GOSUB MASTER_LEDGER
         IF OPTION_NUM EQ 3  GOSUB COMBINE_ACCOUNTS
         IF OPTION_NUM EQ 4  GOSUB CHART_LEDGER    
         IF OPTION_NUM EQ 5  BEGIN
                               PAGE SCRLOAD
                               CHAIN "CHECKS"
                             END       
         IF OPTION_NUM EQ 6  GOSUB GENERAL_JOURNAL
         IF OPTION_NUM EQ 7  GOSUB EDIT_JOURNAL    
         IF OPTION_NUM EQ 8  Begin              //GOSUB PRINT_JOURNALS
                                Page Scrload
                                Chain  "Jrnls"
                              end
         IF OPTION_NUM EQ 9  GOSUB DETAIL_LEDGER
         IF OPTION_NUM EQ 10 GOSUB PRINT_TRIAL_SUM
         IF OPTION_NUM EQ 11 GOSUB PRINT_JOURNALS_SELECT
         IF OPTION_NUM EQ 12 GOto  top_menu
         IF OPTION_NUM EQ 13 GOSUB PRINT_REVENUE2
         IF OPTION_NUM EQ 14 GOSUB PRINT_revenue
         IF OPTION_NUM EQ 15 begin
                               PAGE SCRLOAD
                               CHAIN "JRMON"
                               MOVE (0) TO PAGECOUNT
                             end
         IF OPTION_NUM EQ 16 GOTO TOP_MENU         
         IF OPTION_NUM EQ 17 GOSUB QUICK_BALANCE
         IF OPTION_NUM EQ 18 GOSUB MASTER_DIV
         IF OPTION_NUM EQ 19 GOTO TOP_MENU      
         IF OPTION_NUM EQ 20 GOTO TOP_MENU      
         IF OPTION_NUM EQ 21 GOSUB REP_ACCOUNTS
         IF OPTION_NUM EQ 22 GOTO TOP_MENU      
         IF OPTION_NUM EQ 23 GOSUB JOURNAL_UPDATE
         IF OPTION_NUM EQ 24 GOSUB PROCESS_YREND    
         IF OPTION_NUM EQ 25 GOTO TOP_MENU    
         IF OPTION_NUM EQ 26 GOSUB LAST_YEAR_BAL
         IF OPTION_NUM EQ 27 GOSUB MAINTAIN_BUDGET
         IF OPTION_NUM EQ 28 BEGIN
                               PAGE SCRLOAD
                               CHAIN 'LEGSETUP'
                             END
     LOOP
     CLEARSCREEN
     GOTO LEDGER_MENU

DO_SETUP_FIRST:
    CLEARSCREEN
    GOTOXY 12 10
    SHOW ' G/L Setup incomplete , Now Loading Setup Program'
     CHAIN 'LEGSETUP'
RETURN


//**********< General Ledger Trial Balance >***********************************

PRINT_BALANCE:

  INDICATE BAL_SCR TRUE
  INDICATE STOP_PRINT FALSE
  CLEAR LEDGER RPTMAST
  CLEARFORM SCRBAL
  MOVE (0) TO LINECOUNT

  FORMAT BALBODY.2         {SIGNRT}
  FORMAT BALSUBTOTAL.2     {SIGNRT}
  FORMAT BALTOTAL.2        {SIGNRT}
  DISPLAY 'Y' TO SCRBAL.5
  DISPLAY 'P' TO SCRBAL.6

  PAGE SCRBAL
START_BALSCR:
    ACCEPT SCRBAL.1
    ACCEPT SCRBAL.2
    ACCEPT SCRBAL.3
    ACCEPT SCRBAL.4 TO RPTMAST.REPORT
    ACCEPT SCRBAL.5
    ACCEPT SCRBAL.6
  
    INDICATE OKA AS SCRBAL.5 MATCH "N"
    INDICATE PRT FALSE
    move scrbal.6 to out_dest
    gosub output_dest
    IF SCRBAL.6 EQ 'P' INDICATE PRT TRUE
    [prt]  PAGE PRINTSCR
    [STOP_PRINT] GOTO QUIT_BAL_SCR  

    FIND GE RPTMAST BY INDEX.1
    [FOUND] REPEAT
    
         RELATE RPTMAST
         INDICATE OK TRUE

         IF RPTMAST.CT  MATCH "PH" BEGIN
              TRIM REF.PROSECUTOR TO SHORT
              GOSUB CENT
              PRINT LONG TO BALHEADER.1
              TRIM REF.ADDRESS TO SHORT
              GOSUB CENT
              PRINT LONG TO BALHEADER.2
              TRIM REF.CITY_STATE TO SHORT
              GOSUB CENT
              PRINT LONG TO BALHEADER.3
              LENGTH SCRBAL.2 TO ANSWER
              MOVE RPTMAST.ALTDESC TO SHORT
              IF ANSWER GT (0) MOVE SCRBAL.2 TO SHORT
              TRIM SHORT TO SHORT
              TRIM SCRBAL.3 TO LONG
              APPEND SHORT " " LONG
              TRIM SHORT TO SHORT
              GOSUB CENT
              PRINT LONG TO BALHEADER.4
              [PRT] OUTPUT BALHEADER
         END

         IF RPTMAST.CT  MATCH "AH" BEGIN
              TRIM REF.PROSECUTOR TO SHORT
              GOSUB CENT
              PRINT LONG               TO BALHEADER.1
              TRIM REF.ADDRESS TO SHORT
              GOSUB CENT
              PRINT LONG               TO BALHEADER.2
              TRIM REF.CITY_STATE TO SHORT
              GOSUB CENT
              PRINT LONG               TO BALHEADER.3
              LENGTH SCRBAL.2 TO ANSWER
              MOVE RPTMAST.ALTDESC TO SHORT
              IF ANSWER GT (0) MOVE SCRBAL.2 TO SHORT
              TRIM SHORT TO SHORT
              TRIM SCRBAL.3 TO LONG
              APPEND SHORT " " LONG
              TRIM SHORT TO SHORT
              GOSUB CENT
              PRINT LONG               TO BALHEADER.4
              OUTPUT BALHEADER
         END

         IF RPTMAST.CT  MATCH "GH" BEGIN
              PRINT RPTMAST.ALTDESC    TO BALSUBHEADER1.1
              OUTPUT BALSUBHEADER1
         END  

         IF RPTMAST.CT MATCH "AC" BEGIN
              MOVE SCRBAL.1 TO FIELDINDEX
              MOVE (LEDGER.CD&+ACCUM5) TO ACCUM5
              GOSUB GLUTIL1
              MOVE (ANSWER+ACCUM6)     TO ACCUM6
         END

         IF RPTMAST.CT  MATCH "BL" BEGIN
              PAGECHECK 1
              OUTPUT BALBLANKLINE
         END  

         IF RPTMAST.CT  MATCH "PA" BEGIN
              PRINT RPTMAST.ALTDESC         TO BALBODY.1
              PRINT (ACCUM6*RPTMAST.SC)     TO BALBODY.2
              MOVE (ACCUM8+ACCUM6)     TO ACCUM8
              [OKA] INDICATE OK AS ACCUM6 NE (0)
              MOVE (0.00)              TO ACCUM6
              [OK] OUTPUT BALBODY
         END

         IF RPTMAST.CT  MATCH "AA" BEGIN
              MOVE (ACCUM8+ACCUM6) TO ACCUM8
              MOVE (0.00)          TO ACCUM6
         END

         IF RPTMAST.CT  MATCH "ST" BEGIN
              PRINT RPTMAST.ALTDESC     TO BALSUBTOTAL.1
              PRINT (ACCUM8*RPTMAST.SC) TO BALSUBTOTAL.2 
              OUTPUT BALSUBTOTAL
              MOVE (ACCUM8+ACCUM10) TO ACCUM10
              MOVE (0.00)           TO ACCUM8
         END  

         IF RPTMAST.CT  MATCH "AS" BEGIN
              MOVE (ACCUM8+ACCUM10) TO ACCUM10
              MOVE (0.00)           TO ACCUM8
         END

         IF RPTMAST.CT  MATCH "TT" BEGIN
              PRINT RPTMAST.ALTDESC      TO BALTOTAL.1
              PRINT (ACCUM10*RPTMAST.SC) TO BALTOTAL.2 
              OUTPUT BALTOTAL
              MOVE (ACCUM10+ACCUM12) TO ACCUM12
              MOVE (0.00)            TO ACCUM10
         END  

         IF RPTMAST.CT  MATCH "GT" BEGIN
              PRINT RPTMAST.ALTDESC      TO BALTOTAL.1
              PRINT (ACCUM12*RPTMAST.SC) TO BALTOTAL.2 
              OUTPUT BALTOTAL
              MOVE (ACCUM12+ACCUM14) TO ACCUM14
              MOVE (0.00)            TO ACCUM12
         END  

         IF RPTMAST.CT  MATCH "AG" BEGIN
              MOVE (ACCUM12+ACCUM14) TO ACCUM14
              MOVE (0.00)            TO ACCUM12
         END  

         IF RPTMAST.CT  MATCH "AT" BEGIN
              MOVE (ACCUM10+ACCUM12) TO ACCUM12
              MOVE (0.00)            TO ACCUM10
         END  

         IF RPTMAST.CT  MATCH "GI" gosub set_1_6

         IF RPTMAST.CT  MATCH "PC" BEGIN
              FOR COUNT FROM LINECOUNT TO (60)
              OUTPUT BALBLANKLINE
              LOOP
              IF RPTMAST.REPORT NE 20 PRINT "          "   TO BALCOMMENT2.1
              IF RPTMAST.REPORT EQ 20 PRINT "HOT CHECK DIVISION (20)" ;
                                                           TO BALCOMMENT2.1
              PRINT ref.prosecutor                       TO BALCOMMENT2.2
              OUTPUT BALCOMMENT2
         END

         IF RPTMAST.CT  MATCH "PD" BEGIN
              IF RPTMAST.SC EQ (-1) OUTPUT BALDASHES
              IF RPTMAST.SC EQ (0)  OUTPUT BALCDASH
              IF RPTMAST.SC EQ (1)  OUTPUT BALRDASH
         END  

         IF RPTMAST.CT  MATCH "PE" BEGIN
              IF RPTMAST.SC EQ (1) OUTPUT BALEQUALS
              IF RPTMAST.SC EQ (0) OUTPUT BALEQUALSM
         END  
         IF RPTMAST.CT  MATCH "PN" BEGIN
              IF RPTMAST.USEALT MATCH "Y" PRINT RPTMAST.ALTDESC TO BALBODY.1
              IF RPTMAST.USEALT MATCH "N" PRINT LEDGER.DESC     TO BALBODY.1
              GOSUB GLUTIL1
              PRINT (ANSWER*RPTMAST.SC)                         TO BALBODY.2
              MOVE (ANSWER+ACCUM8) TO ACCUM8
              [OKA] INDICATE OK AS ANSWER NE (0)
              [OK] OUTPUT BALBODY
         END

         IF RPTMAST.CT  MATCH "CL" GOSUB CLEAR_ACCUMALATORS
         IF RPTMAST.CT MATCH "NP" FORMFEED
         IF RPTMAST.CT MATCH "RE" GOTO END_OF_BAL_REPORT

         KEYCHECK BEGIN
          CHK_BAL:
              gosub key_prss
              IF ANSW EQ 'Y' BEGIN
                   CLEAR LEDGER RPTMAST
                   CLEARFORM SCRBAL
                   OUTPUT OPABORT
                   [PRT] gosub ff_despool
                   GOTO QUIT_BAL_SCR
              END
         END

         FIND GT RPTMAST BY INDEX.1
         [FOUND] IF RPTMAST.REPORT NE SCRBAL.4 GOTO END_OF_BAL_REPORT
    [FOUND] LOOP

 END_OF_BAL_REPORT:
    [PRT] DESPOOL
    GOTO QUIT_BAL_SCR

 GLUTIL1:
    MOVE (-1) TO COUNT
    MOVE LEDGER.TYBEG TO ANSWER
    REPEAT
         INCREMENT COUNT
         MOVE COUNT TO FIELDINDEX
         MOVE REF.PER1& TO FIELDINDEX
         CALC (ANSWER+LEDGER.CD&) TO ANSWER
         MOVE COUNT TO FIELDINDEX
         UNTIL REF.PER1& EQ SCRBAL.1
    RETURN

    CENT:       LENGTH SHORT TO LCOUNT
         MOVE "" TO LONG
         MOVE (50 - LCOUNT / 2 + (.5)) TO LCOUNT
         FOR COUNT FROM 0 TO LCOUNT
              APPEND LONG " "
         LOOP
         APPEND LONG SHORT
    RETURN

  QUIT_BAL_SCR:
    INDICATE BAL_SCR FALSE
    INDICATE PRT FALSE
    [HC_SCR] RETURN HC_MENU
RETURN    // for  (print_balance:)


//*******< Add New Ledger Accounts >************************************* 1 ***

ADD_ACCOUNTS:
    IF USER$_ACCESS LT 4 RETURN
    BLANKFORM SCRADD.8 THRU SCRADD.9
    INDICATE NEWREC TRUE  
    ENTERGROUP
    AUTOPAGE SCRADD
    INDICATE MENU_SCR FALSE
    INDICATE ADD_SCR TRUE
    ENTRY LEDGER.NUMBER                SCRADD.1                     
    MOVE REF.DISTRICT TO SCRADD.2
    [NOT DIV] MOVE ''  TO SCRADD.3
    ENTRY LEDGER.DISTRICT              SCRADD.2  {NOENTER}
  START_DIV_ENTRY:
    [DIV]  ENTRY LEDGER.DIVISION       SCRADD.3  {CAPSLOCK,AUTOFIND,RETAIN}
    [NOT DIV] ENTRY LEDGER.DIVISION    SCRADD.3  {NOENTER,AUTOFIND}
    [FOUND] INDICATE NEWREC FALSE
    [DIV] BEGIN
         CLEAR DIVISION
         MOVE SCRADD.3 TO DIVISION.CODE
         FIND EQ DIVISION BY INDEX.1
         [FOUND] GOTO PASS_DIV
         [FINDERR] BEGIN
              gosub ERR_msg_124
              GOTO START_DIV_ENTRY
         END
    END
  PASS_DIV:
    ENTRY LEDGER.DESC                  SCRADD.4
    IF SCRADD.1 NE '' FORMAT SCRADD.4 THRU SCRADD.6   {REQUIRED}
    ENTRY LEDGER.BR                    SCRADD.5  {RETAIN,CAPSLOCK,CHECK="BR"}
    MOVE "D" TO SCRADD.6
    ENTRY LEDGER.CD                    SCRADD.6  {RETAIN,CAPSLOCK,CHECK="DT"}
    ENTRY LEDGER.TYBEG                 SCRADD.7

  SAVE_ACC_QUES:
    DISPLAY " Do You Wish To Save This Record ? " TO SCRADD.8
    DISPLAY 'Y' TO SCRADD.9
    ACCEPT SCRADD.9       {CAPSLOCK,CHECK="YN"}
    IF NOT SCRADD.9 IN 'YN' GOTO SAVE_ACC_QUES
         BLANKFORM SCRADD.8 THRU SCRADD.9
    IF SCRADD.9 IN 'Y' BEGIN
         GOTO SAVE_ACC_DOIT
    END
    IF SCRADD.9 IN 'N' BEGIN
         CLEAR LEDGER DIVISION
         CLEARFORM SCRADD.1
         CLEARFORM SCRADD.4
         CLEARFORM SCRADD.7 
         GOTO ADD_ACCOUNTS
    END

  SAVE_ACC_DOIT:

    [multiuser] REREAD
    ENDGROUP
    IF STATUS LEDGER INDICATE NEWREC FALSE
    [NEWREC] IF STATUS DIVISION MOVE (DIVISION.ACCOUNTS + 1);
                                               TO DIVISION.ACCOUNTS
    [NEWREC] SAVERECORD DIVISION
    [NEWREC] INDICATE NEWREC FALSE
    SAVE LEDGER
    UNLOCK
    CLEAR LEDGER DIVISION
    CLEARFORM   SCRADD.1
    CLEARFORM   SCRADD.4
    CLEARFORM   SCRADD.7
    GOTO ADD_ACCOUNTS

  QUIT_ADD_ACCOUNTS:
    CLEAR LEDGER
    CLEARFORM
    INDICATE ADD_SCR FALSE
RETURN   // for (add_accounts:)
//------------end option 1-----------------------------


//*******< General Ledger Accounts Master File >************************ 2 ****

MASTER_LEDGER:

    ENTERGROUP
  TOP_MAST:
         AUTOPAGE SCRMAST
         INDICATE MAST_SCR TRUE
         [~ DIV] MOVE (0) TO MAST_DEPT
         [DIV] ENTRY LEDGER.DIVISION                 SCRMAST.1
         [~ DIV] ENTRY LEDGER.DIVISION               SCRMAST.1
         MOVE REF.DISTRICT TO SCRMAST.2
         ENTRY LEDGER.DISTRICT                       SCRMAST.2  {NOENTER}
  TOP_MAST2:
         REPEAT
              ENTRY LEDGER.NUMBER                    SCRMAST.3  {AUTOFIND}     
         IF SCRMAST.3 EQ 0 LOOP

  PASS_SCRMAST_FIND:
         ENTRY LEDGER.DESC       SCRMAST.4          
         ENTRY LEDGER.BR         SCRMAST.5         {CAPSLOCK,CHECK="B,R"}
         ENTRY LEDGER.TYBEG      SCRMAST.6         {NOENTER}
         ENTRY LEDGER.LYBEG      SCRMAST.7         {NOENTER} 
         ENTRY LEDGER.TYJAN      SCRMAST.8         {NOENTER}
         ENTRY LEDGER.LYJAN      SCRMAST.9         {NOENTER}
         ENTRY LEDGER.BJAN       SCRMAST.10        {NOENTER}
         ENTRY LEDGER.TYFEB      SCRMAST.11        {NOENTER}
         ENTRY LEDGER.LYFEB      SCRMAST.12        {NOENTER}
         ENTRY LEDGER.BFEB       SCRMAST.13        {NOENTER}
         ENTRY LEDGER.TYMAR      SCRMAST.14        {NOENTER}
         ENTRY LEDGER.LYMAR      SCRMAST.15        {NOENTER}
         ENTRY LEDGER.BMAR       SCRMAST.16        {NOENTER}
         ENTRY LEDGER.TYAPR      SCRMAST.17        {NOENTER}
         ENTRY LEDGER.LYAPR      SCRMAST.18        {NOENTER}
         ENTRY LEDGER.BAPR       SCRMAST.19        {NOENTER}
         ENTRY LEDGER.TYMAY      SCRMAST.20        {NOENTER}
         ENTRY LEDGER.LYMAY      SCRMAST.21        {NOENTER}
         ENTRY LEDGER.BMAY       SCRMAST.22        {NOENTER}
         ENTRY LEDGER.TYJUN      SCRMAST.23        {NOENTER}
         ENTRY LEDGER.LYJUN      SCRMAST.24        {NOENTER}
         ENTRY LEDGER.BJUN       SCRMAST.25        {NOENTER}
         ENTRY LEDGER.TYJUL      SCRMAST.26        {NOENTER}
         ENTRY LEDGER.LYJUL      SCRMAST.27        {NOENTER}
         ENTRY LEDGER.BJUL       SCRMAST.28        {NOENTER}
         ENTRY LEDGER.TYAUG      SCRMAST.29        {NOENTER}
         ENTRY LEDGER.LYAUG      SCRMAST.30        {NOENTER}
         ENTRY LEDGER.BAUG       SCRMAST.31        {NOENTER}
         ENTRY LEDGER.TYSEP      SCRMAST.32        {NOENTER}
         ENTRY LEDGER.LYSEP      SCRMAST.33        {NOENTER}
         ENTRY LEDGER.BSEP       SCRMAST.34        {NOENTER}
         ENTRY LEDGER.TYOCT      SCRMAST.35        {NOENTER}
         ENTRY LEDGER.LYOCT      SCRMAST.36        {NOENTER}
         ENTRY LEDGER.BOCT       SCRMAST.37        {NOENTER}
         ENTRY LEDGER.TYNOV      SCRMAST.38        {NOENTER}
         ENTRY LEDGER.LYNOV      SCRMAST.39        {NOENTER}
         ENTRY LEDGER.BNOV       SCRMAST.40        {NOENTER}
         ENTRY LEDGER.TYDEC      SCRMAST.41        {NOENTER}
         ENTRY LEDGER.LYDEC      SCRMAST.42        {NOENTER}
         ENTRY LEDGER.BDEC       SCRMAST.43        {NOENTER}
         ENTRY LEDGER.TYTOTAL    SCRMAST.44        {NOENTER}
         ENTRY LEDGER.LYTOTAL    SCRMAST.45        {NOENTER}
         ENTRY LEDGER.BYTOTAL    SCRMAST.46        {NOENTER}

  SAVE_LEDGER_QUES:
         IF USER$_ACCESS LT 90 GOTO TOP_MAST2
         gosub sav_rec
         IF ANSW IN 'Y' GOTO SAVE_LEDGER_DOIT
         IF ANSW IN 'N' BEGIN
              CLEAR LEDGER
              CLEARFORM
              GOTO MASTER_LEDGER
         END

  SAVE_LEDGER_DOIT:
         REREAD
         ENDGROUP
         SAVERECORD LEDGER
     UNLOCK
    GOTO TOP_MAST2

  QUIT_MASTER_LEDGER:
    CLEAR LEDGER
    CLEARFORM
    INDICATE MAST_SCR FALSE
    [HC_SCR] RETURN HC_MENU
    [PROS_SCR] RETURN PROS_MENU
    [MENU_SCR] RETURN LEDGER_MENU

RETURN   // for (general_ledger:)
//--------------------end option 2------------------


//*********< Combine & Delete Ledger Accounts >************************** 3 ***

COMBINE_ACCOUNTS:

  STARTOLD:
    INDICATE COMBINE_SCREENS TRUE
    INDICATE NOTZERO FALSE
    INDICATE FIRST FALSE

    PAGE SCRALTER
    CLEAR LEDGER
    INDICATE ALTER_SCR TRUE 
    INDICATE ALTER2_SCR FALSE
    INDICATE ALTER3_SCR FALSE
    INDICATE DEL FALSE
    INDICATE DIS TRUE 
    INDICATE DIV AS REF.Division  MATCH "Y"

    ENTERGROUP 
  DO_ENT1:
         ENTRY LEDGER.NUMBER              SCRALTER.1
         MOVE REF.DISTRICT TO SCRALTER.2
         ENTRY LEDGER.DISTRICT            SCRALTER.2                    
         [DIV] ENTRY LEDGER.DIVISION      SCRALTER.3       {AUTOFIND,FINDREQ}
         [NOT DIV] ENTRY LEDGER.DIVISION  SCRALTER.3       {AUTOFIND}
         [NOT DIV] IFNOT STATUS LEDGER GOTO DO_ENT1
         ENTRY LEDGER.DESC                SCRALTER.4       {NOENTER}
         ENTRY LEDGER.BR                  SCRALTER.5       {NOENTER}
    ENDGROUP

    FOR COUNT FROM 0 TO 39
         MOVE COUNT TO WINDOWINDEX
         MOVE COUNT TO FIELDINDEX
         DISPLAY LEDGER.TYJAN& TO SCRALTER.6&
         IF LEDGER.TYJAN& NE 0 INDICATE NOTZERO TRUE
    LOOP

    DISPLAY LEDGER.BYTOTAL  TO SCRALTER.46

  ASK_JR_COMBINE:
    INDICATE FIRST TRUE
    FORMAT SCRALTER.47                             {CAPSLOCK,CHECK="DTMC"}
    DISPLAY 'C' TO SCRALTER.47
    ACCEPT SCRALTER.47
    IF SCRALTER.47 MATCH 'C' CLEARFORM SCRALTER.1 THRU SCRALTER.46
    IF SCRALTER.47 MATCH 'C' GOTO STARTOLD
    IF SCRALTER.47 MATCH 'D' GOSUB CHECK_JR_ENTRIES
    IF SCRALTER.47 MATCH 'M' INDICATE DEL TRUE
    IF SCRALTER.47 MATCH 'M' GOTO CREATENEW
    IF SCRALTER.47 MATCH 'T' INDICATE DEL FALSE
    INDICATE FIRST FALSE

  CREATENEW:
    PAGE SCRALTER2 
    INDICATE ALTER_SCR FALSE
    INDICATE ALTER2_SCR TRUE 
    INDICATE ALTER3_SCR FALSE
    CLEAR LEDGER
    ENTERGROUP 
  DO_ENT2:
         ENTRY LEDGER.NUMBER                SCRALTER2.1
         MOVE REF.DISTRICT TO SCRALTER2.2
         [DIS] ENTRY LEDGER.DISTRICT        SCRALTER2.2    {NOENTER}
         [DIV]  ENTRY LEDGER.DIVISION       SCRALTER2.3    {AUTOFIND,FINDREQ}
         [NOT DIV] ENTRY LEDGER.DIVISION    SCRALTER2.3    {NOENTER,AUTOFIND}
         [NOT DIV] IFNOT STATUS LEDGER GOTO DO_ENT2
         ENTRY LEDGER.DESC                  SCRALTER2.4    {NOENTER}
         ENTRY LEDGER.BR                    SCRALTER2.5    {NOENTER}
    ENDGROUP

    FOR COUNT FROM 0 TO 39
         MOVE COUNT TO WINDOWINDEX
         MOVE COUNT TO FIELDINDEX
         DISPLAY LEDGER.TYJAN& TO SCRALTER2.6&
    LOOP

    DISPLAY LEDGER.BYTOTAL  TO SCRALTER2.46
  
     MOVE "IS THIS THE RIGHT ACCOUNT TO TRANSFER TO" TO SCRALTER2.47
    FORMAT SCRALTER2.48    {CAPSLOCK,CHECK="YN"}
    ACCEPT SCRALTER2.48
    IF SCRALTER2.48 MATCH "N" GOTO CREATENEW
     MOVE "COMBINE THE TWO ACCOUNTS TOGETHER" TO SCRALTER2.47
    ACCEPT SCRALTER2.48
    IF SCRALTER2.48 MATCH "Y" BEGIN
         FOR COUNT FROM 0 TO 40
              MOVE COUNT TO WINDOWINDEX
              MOVE (SCRALTER.6& + SCRALTER2.6&) TO SCRALTER2.6&
              [~ DEL] MOVE 0 TO SCRALTER.6&
         LOOP
    END
     MOVE "IS THIS THE CORRECT LEDGER INFORMATION" TO SCRALTER2.47
    ACCEPT SCRALTER2.48
    IF SCRALTER2.48 MATCH "N" GOTO STARTOLD
    [multiuser] REREAD
         FOR COUNT FROM 0 TO 39
              MOVE COUNT TO WINDOWINDEX
              MOVE COUNT TO FIELDINDEX
              MOVE SCRALTER2.6& TO LEDGER.TYJAN&
         LOOP

         MOVE SCRALTER2.46 TO LEDGER.BYTOTAL
         SAVERECORD LEDGER
     UNLOCK
    CLEAR LEDGER
    CLEAR DIVISION
    MOVE SCRALTER.3 TO DIVISION.CODE
    FIND EQ DIVISION BY INDEX.1
    [FINDERR] ERROR 124
    [FOUND] MOVE (DIVISION.ACCOUNTS - 1) TO DIV_ACCTS
    [found] gosub d_accts
    CLEAR DIVISION
    MOVE SCRALTER2.3 TO DIVISION.CODE
    FIND EQ DIVISION BY INDEX.1
    [FINDERR] ERROR 124
    [FOUND] MOVE (DIVISION.ACCOUNTS + 1) TO DIV_ACCTS
    [found] gosub d_accts

    PAGE SCRALTER3
    INDICATE ALTER_SCR FALSE
    INDICATE ALTER2_SCR FALSE
    INDICATE ALTER3_SCR TRUE
    MOVE SCRALTER.1 TO LEDGER.NUMBER
    MOVE SCRALTER.2 TO LEDGER.DISTRICT
    MOVE SCRALTER.3 TO LEDGER.DIVISION
    FIND EQ LEDGER BY INDEX.1
    CLEAR JOURNALS 
    REPEAT
         FIND GT JOURNALS BY RECNUM
         [FINDERR] GOTO LASTONE 
         [multiuser] reread
              IF JOURNALS.DIST_DIV NE LEDGER.OVERLAP GOTO SKIP
              MOVE SCRALTER2.1 TO JOURNALS.GL
              MOVE SCRALTER2.2 TO JOURNALS.BR
              MOVE SCRALTER2.3 TO JOURNALS.DP
              SAVERECORD JOURNALS
          unlock
  SKIP:         
    LOOP
  
  LASTONE:
    [DEL] DELETE LEDGER
    [~ DEL] BEGIN
         FOR COUNT FROM 0 TO 40
              MOVE COUNT TO FIELDINDEX
              MOVE 0 TO LEDGER.TYJAN&
         LOOP
         IF STATUS LEDGER begin
               reread
                   SAVERECORD LEDGER
               unlock
         end
    END
    GOTO STARTOLD

  QUIT_ALTER_SCR:

    INDICATE COMBINE_SCREENS FALSE
    CLEAR LEDGER
    CLEARFORM SCRALTER
    CLEARFORM SCRALTER2
  RETURN   // for (COMBINE_ACCOUNTS:)

  d_accts:
     REREAD
         MOVE DIV_ACCTS TO DIVISION.ACCOUNTS
         SAVERECORD DIVISION
     UNLOCK
return
//------------------end option 3-----------------------


//***********< Print Chart Of Accounts >********************************* 4 ***

CHART_LEDGER:
    Direct_Output "Chart.txt"
    INDICATE CHART_SCR TRUE

    FORMAT SCRCHART.1  {CAPSLOCK}
    FORMAT SCRCHART.2  {CAPSLOCK}
    FORMAT SCRCHART.3  {CAPSLOCK,CHECK="CP"}
    [NOT DIV] MOVE (0) TO SCRCHART.2

    PAGE SCRCHART
  QUES2:
    MOVE REF.DISTRICT TO SCRCHART.1
    [DIV] ACCEPT SCRCHART.2
    ACCEPT SCRCHART.3
    move scrchart.3 to out_dest
    gosub output_dest
    IF out_dest MATCH "P" begin
         PAGE PRINTSCR
    end
    CLEAR LEDGER
    FIND GE LEDGER.OVERLAP
    [FINDERR] GOTO  QUIT_PRINT_CHART
    GOSUB PRINT_CHART_HEADER
    REPEAT
         INDICATE SELECT TRUE
         IFNOT "A" IN SCRCHART.2 INDICATE SELECT AS LEDGER.DIVISION EQ ;
                                                                     SCRCHART.2
         [NOT SELECT] GOTO DO_CHART_AGAIN
  DO_CHART_PRINT:
         PAGECHECK 5
         [PAGEBREAK] GOSUB PRINT_CHART_HEADER

         PRINT LEDGER.NUMBER         TO CHTBODY.1
         PRINT LEDGER.DISTRICT       TO CHTBODY.2
         PRINT LEDGER.DIVISION       TO CHTBODY.3
         PRINT LEDGER.DESC           TO CHTBODY.4
         PRINT LEDGER.BR             TO CHTBODY.5 
         OUTPUT CHTBODY
         KEYCHECK  GOSUB STOP_CHART
         DO_CHART_AGAIN:
         FIND GT LEDGER.OVERLAP
    [FOUND] LOOP

    FORMFEED
  QUIT_PRINT_CHART:
    INDICATE CHART_SCR FALSE
    CLEAR LEDGER
    CLEARFORM SCRCHART
    despool
    copyfile "\dataflex\Chart.txt" to "LPT1:"

  RETURN    //for (chart_ledger:)

  PRINT_CHART_HEADER:
    PRINT REF.PROSECUTOR TO CHTHEADER.1
    OUTPUT CHTHEADER
  RETURN

  STOP_CHART:
    gosub key_prss
    IF ANSW IN "Y" BEGIN
         INDICATE CHART_SCR FALSE
         gosub ff_despool
         RETURN quit_print_chart                      //END_SELECT_CHART
    END
    CLEARXY 24 0
  END_STOP_CHART:
    INDICATE CHART_SCR FALSE
     DESPOOL
RETURN
// -------end option 4--------


//********-< General Journal Entry >-*********************************** 6 ***

GENERAL_JOURNAL:
     REREAD REF
    MOVE 0.00 TO REF.RUN_BAL
    SAVERECORD REF
    UNLOCK
    PAGE SCRGEN
    BLANKFORM SCRGEN.145 THRU SCRGEN.146
    INDICATE GEN_SCR TRUE
    sysdate4 ENTDATE
    DECOMPOSE_DATE ENTDATE TO ADAY AMONTH AYEAR
    MOVE 0 TO TRANS
    MOVE 0 TO RUN_BAL
         FORMAT SCRGEN.1    {CAPSLOCK}
         FORMAT SCRGEN.2    {RANGE=1979,2100}
         FORMAT SCRGEN.3    {RANGE=1,12}
         FORMAT SCRGEN.4    {RANGE=1,31}
         FORMAT SCRGEN.10   {CAPSLOCK,CHECK="DC"}
         FORMAT SCRGEN.19   {CAPSLOCK,CHECK="CD"}
         FORMAT SCRGEN.28   {CAPSLOCK,CHECK="CD"}
         FORMAT SCRGEN.37   {CAPSLOCK,CHECK="CD"}
         FORMAT SCRGEN.46   {CAPSLOCK,CHECK="CD"}
         FORMAT SCRGEN.55   {CAPSLOCK,CHECK="CD"}
         FORMAT SCRGEN.64   {CAPSLOCK,CHECK="CD"}
         FORMAT SCRGEN.73   {CAPSLOCK,CHECK="CD"}
         FORMAT SCRGEN.82   {CAPSLOCK,CHECK="CD"}
         FORMAT SCRGEN.91   {CAPSLOCK,CHECK="CD"}
         FORMAT SCRGEN.100  {CAPSLOCK,CHECK="CD"}
         FORMAT SCRGEN.109  {CAPSLOCK,CHECK="CD"}
         FORMAT SCRGEN.118  {CAPSLOCK,CHECK="CD"}
         FORMAT SCRGEN.127  {CAPSLOCK,CHECK="CD"}
         FORMAT SCRGEN.136  {CAPSLOCK,CHECK="CD"}
    INDICATE DIS TRUE
    INDICATE DIV AS REF.DIVISION MATCH "Y"
    IF REF.RUN_BAL LT 0.00 BEGIN
         SCREENMODE 240 ON
         MOVE (REF.RUN_BAL * (-1)) TO SCRGEN.141
         SCREENMODE 1 ON
         MOVE "CREDIT"             TO SCRGEN.142
    END
    IF REF.RUN_BAL GT 0 BEGIN
         SCREENMODE 240 ON
         MOVE REF.RUN_BAL TO SCRGEN.141
         SCREENMODE 1 ON
         MOVE "DEBIT"     TO SCRGEN.142
    END
                                        
  START_GEN_ENTRY:   
    MOVE 'JR'      TO SCRGEN.1
    DISPLAY AYEAR  TO SCRGEN.2
    DISPLAY AMONTH TO SCRGEN.3
    ACCEPT  SCRGEN.2 
    ACCEPT  SCRGEN.3 
    DISPLAY ADAY   TO SCRGEN.4
    ACCEPT  SCRGEN.4
    ACCEPT  SCRGEN.5
    INDICATE FIRST TRUE
    MOVE  0  TO COUNT
    REPEAT
         MOVE (COUNT *  9) TO WINDOWINDEX
  GETGL:
         ACCEPT SCRGEN.6&
         IF SCRGEN.6  EQ 0 GOTO GETGL
         IF SCRGEN.6& EQ 0 BEGIN
              GOTOXY 24 0
              SCREENMODE 112 ON
              SHOW ' Options: U)pdate Jr , D)elete entries , E)dit entries. '
              SCREENMODE 1 ON
  DO_OPTION:
              INKEY ANSW
              UPPERCASE ANSW
              IF NOT ANSW IN 'UDE' GOTO DO_OPTION
              IF ANSW EQ 'U' IF SCRGEN.141 EQ (0) GOTO START_DAY
                 ELSE MOVE 'E' TO ANSW
              IF ANSW EQ 'D' BEGIN
                If ref.ref_num EQ seq Begin
                   REREAD
                        MOVE (SEQ - 1) TO REF.REF_NUM
                        SAVERECORD REF
                   UNLOCK
                End

                   CLEAR LEDGER JOURNALS
                   CLEARFORM SCRGEN
                   CLEARXY 24 0
                   GOTO GENERAL_JOURNAL
              END
              IF ANSW EQ 'E' BEGIN
                   CLEARXY 24 0
                   MOVE '' TO SCRGEN.145
                   SCREENMODE 112 ON
                   MOVE ' Which Line To Edit..' TO SCRGEN.145
                   SCREENMODE 1 ON
  DO_OPTION_EDIT:
                   ACCEPT SCRGEN.146
                   MOVE SCRGEN.146 TO TRANS
                   IF (TRANS - 1) GT COUNT BEGIN
                        ERROR 128
                        GOSUB TIME_DELAY
                        CLEARWARNING
                        BLANKFORM SCRGEN.146
                        MOVE 0 TO TRANS
                        GOTO DO_OPTION_EDIT
                   END
                   BLANKFORM SCRGEN.145 THRU SCRGEN.146
                   MOVE (( TRANS - 1) * 9) TO WINDOWINDEX
                   MOVE (TRANS - 1) TO COUNT
                   GOTO GETGL
              END  
         END   
         MOVE REF.DISTRICT TO SCRGEN.7&
         [~ DIV] MOVE 0 TO SCRGEN.8&
         [DIV] ACCEPT SCRGEN.8&
         CLEAR LEDGER
         MOVE SCRGEN.6& TO LEDGER.NUMBER  
         MOVE SCRGEN.7& TO LEDGER.DISTRICT
         MOVE SCRGEN.8& TO LEDGER.DIVISION

         FIND EQ LEDGER.OVERLAP

         [FINDERR]  BEGIN
              ERROR 127                   
              GOSUB TIME_DELAY
              CLEARWARNING
              GOTO GETGL
         END

         MOVE LEDGER.DESC TO SCRGEN.9& 
         ACCEPT SCRGEN.10&
         ACCEPT SCRGEN.11&
         IF SCRGEN.10& EQ 'C' MOVE ((SCRGEN.11& * (-1))+REF.RUN_BAL) ;
                                                              TO REF.RUN_BAL
         IF SCRGEN.10& EQ 'D' MOVE (SCRGEN.11& + REF.RUN_BAL) TO REF.RUN_BAL
         IF REF.RUN_BAL LT 0 BEGIN
              SCREENMODE 240 ON
              MOVE REF.RUN_BAL         TO SCRGEN.141
              SCREENMODE 1 ON
         END
         IF REF.RUN_BAL GT 0 BEGIN
              SCREENMODE 240 ON
              MOVE REF.RUN_BAL         TO SCRGEN.141
              SCREENMODE 1 ON
         END
         IF REF.RUN_BAL EQ 0 MOVE 0    TO SCRGEN.141 

         IF SCRGEN.12& EQ "" BEGIN
           MOVE (REF.REF_NUM + 1) TO SEQ
           MOVE SEQ TO REF.REF_NUM
           MOVE SEQ TO SCRGEN.12&
         END
         ACCEPT SCRGEN.13&
         ACCEPT SCRGEN.14& 
         INCREMENT COUNT
    UNTIL COUNT EQ  15 

  START_DAY:
    CLEARXY 24 0
    MOVE 0 TO COUNT
    REPEAT
         CLEAR JOURNALS
         MOVE (COUNT * 9) TO WINDOWINDEX
         IF SCRGEN.6& LE 0 BEGIN
              FOR COUNT FROM 0 TO 14
                   MOVE (COUNT * 9) TO WINDOWINDEX
                   CLEARFORM SCRGEN.6& THRU SCRGEN.14&
              LOOP
              CLEARFORM SCRGEN.143
              MOVE (0) TO ACCUM
              GOTO END_GEN_ROUTINE
         END
         CLEAR LEDGER
         MOVE SCRGEN.6& TO LEDGER.NUMBER  
         MOVE SCRGEN.7& TO LEDGER.DISTRICT
         MOVE SCRGEN.8& TO LEDGER.DIVISION
         FIND EQ LEDGER BY INDEX.1
     Reread
         IF SCRGEN.10& MATCH "C" MOVE (SCRGEN.11& * (-1)) TO JOURNALS.AMOUNT 
         IF SCRGEN.10& MATCH "D" MOVE SCRGEN.11& TO JOURNALS.AMOUNT 
         MOVE SEQ        TO JOURNALS.CHK
         MOVE SCRGEN.6&  TO JOURNALS.GL 
         MOVE SCRGEN.7&  TO JOURNALS.BR
         MOVE SCRGEN.8&  TO JOURNALS.DP
         MOVE SCRGEN.13& TO JOURNALS.EMPLY
         MOVE SCRGEN.14& TO JOURNALS.JOB
         MOVE SCRGEN.5   TO JOURNALS.DESC
         MOVE SCRGEN.1   TO JOURNALS.JR                    
         MOVE SCRGEN.2   TO JOURNALS.YR 
         MOVE SCRGEN.3   TO JOURNALS.MN 
         MOVE SCRGEN.4   TO JOURNALS.DY
         MOVE SCRGEN2.2  TO JOURNALS.OPERATOR
         MOVE (REF.RUN_BAL +JOURNALS.AMOUNT) TO REF.RUN_BAL 
         //SAVERECORD REF

         IF REF.RUN_BAL LT 0 BEGIN
              SCREENMODE 240 ON
              MOVE (REF.RUN_BAL * (-1)) TO SCRGEN.141
              SCREENMODE 1 ON
              MOVE "CREDIT"             TO SCRGEN.142
         END
         IF REF.RUN_BAL GT  0  BEGIN
              SCREENMODE 240 ON
              MOVE REF.RUN_BAL TO SCRGEN.141
              SCREENMODE 1 ON
              MOVE "DEBIT"     TO SCRGEN.142
         END
         IF REF.RUN_BAL EQ 0 BEGIN
              SCREENMODE 1 ON
              MOVE 0  TO SCRGEN.141
              MOVE '' TO SCRGEN.142
         END

         MOVE (JOURNALS.AMOUNT + ACCUM) TO ACCUM
         IF ACCUM LT  0  BEGIN
              SCREENMODE 240 ON
              MOVE (ACCUM * (-1)) TO SCRGEN.143
              SCREENMODE 1 ON
              MOVE "CREDIT"       TO SCRGEN.144
         END
         IF ACCUM GT  0  BEGIN
              SCREENMODE 240 ON
              MOVE ACCUM          TO SCRGEN.143
              SCREENMODE 1 ON
              MOVE "DEBIT"        TO SCRGEN.144
         END

         IF ACCUM EQ 0 BEGIN
              SCREENMODE 1 ON
              MOVE ACCUM TO SCRGEN.143
              MOVE ''    TO SCRGEN.144
         END  
         MOVE (JOURNALS.MN - 1) TO FIELDINDEX
         MOVE (LEDGER.TYJAN& + JOURNALS.AMOUNT) TO LEDGER.TYJAN&
         IF SCRGEN.10& EQ 'C' MOVE ((SCRGEN.11& * (-1)) + LEDGER.TYTOTAL) ;
                                                           TO LEDGER.TYTOTAL
         IF SCRGEN.10& EQ 'D' MOVE (SCRGEN.11& + LEDGER.TYTOTAL) ;
                                                           TO LEDGER.TYTOTAL
        // IF SCRGEN.11& NE (0) SAVE LEDGER JOURNALS
         saverecord ledger journals ref
         Unlock                  // Unlock after save
         INCREMENT COUNT
    UNTIL COUNT EQ 15
    MOVE (0) TO COUNT
    FOR COUNT FROM (0) TO (14)
         MOVE (COUNT * (9)) TO WINDOWINDEX
        CLEARFORM SCRGEN.11& THRU SCRGEN.14&
    LOOP
    CLEARFORM SCRGEN.143
    MOVE (0.00) TO ACCUM
  END_GEN_ROUTINE:
    CLEAR LEDGER JOURNALS
    GOTOXY 24 0
    SHOW ' Do You Wish To Make More Entries?'
    INKEY ANSW
    UPPERCASE ANSW
    IF ~ ANSW IN 'YN' GOTO END_GEN_ROUTINE
    IF ANSW EQ 'Y' BEGIN
         CLEARFORM
         CLEARXY 24 0
         GOTO GENERAL_JOURNAL
    END

  QUIT_GENERAL_JOURNAL:
    GOSUB EXPLAIN_GEN
    [MULTIUSER] REREAD REF
      IF SEQ GE REF.REF_NUM MOVE SEQ TO REF.REF_NUM
      SAVERECORD REF
    [MULTIUSER] UNLOCK
    INDICATE GEN_SCR FALSE
    CLEARFORM
    MOVE 0 TO TRANS
  RETURN   // for (general_journal:)

  EXPLAIN_GEN:
  [~ KEY.ESCAPE] BEGIN
    BLANKFORM SCRGEN2.7 THRU SCRGEN2.8
    PAGE SCRGEN2
    INDICATE GEN2_SCR TRUE
    MOVE SEQ       TO SCRGEN2.1
    MOVE USER_NUMB TO SCRGEN2.2
    MOVE USER$     TO SCRGEN2.3
    IF NOT STATUS USERX MOVE '10'                TO SCRGEN2.2
    IF NOT STATUS USERX MOVE 'TEMP'              TO SCRGEN2.3
    FORMAT SCRGEN2.4                                  {CAPSLOCK,REQUIRED}
    FORMAT SCRGEN2.5 THRU SCRGEN2.8                   {CAPSLOCK}
  START_NOTES_GEN:
    ACCEPT SCRGEN2.4
    ACCEPT SCRGEN2.5
    ACCEPT SCRGEN2.6
  REDO_QUES_GEN:
     DISPLAY 'Are You Sure Of Your Notations '   TO SCRGEN2.7
    ACCEPT SCRGEN2.8
     IF SCRGEN2.8 EQ 'N' BEGIN
         BLANKFORM SCRGEN2.7 THRU SCRGEN2.8
         GOTO START_NOTES_GEN
     END
     IF NOT SCRGEN2.8 IN 'YN' GOTO REDO_QUES_GEN
     CLEAR RECHANGE
        MOVE SCRGEN2.2 TO RECHANGE.OPERATOR
        MOVE ENTDATE TO RECHANGE.DATE
        MOVE SCRGEN2.4 TO RECHANGE.DESC1
        MOVE SCRGEN2.5 TO RECHANGE.DESC2
        MOVE SCRGEN2.6 TO RECHANGE.DESC3
        MOVE "GENERAL JR" TO RECHANGE.FILE
        SAVE RECHANGE
     END
    INDICATE GEN2_SCR FALSE
    INDICATE FIRST FALSE
RETURN    // for explain_gen
// --------------end option 6-------------


//****< Change Journal Data >******************************************** 7 ***

EDIT_JOURNAL:
    INDICATE MENU_SCR FALSE
    INDICATE EDIT_SCR TRUE

  START: 
    ENTERGROUP
         ENTRY JOURNALS.RECNUM    SCREDIT.1      {AUTOFIND}
         ENTRY JOURNALS.JR        SCREDIT.2      {SKIPFOUND,NOPUT}
         ENTRY JOURNALS.YR        SCREDIT.4      {SKIPFOUND,NOPUT}
         ENTRY JOURNALS.MN        SCREDIT.5      {SKIPFOUND,NOPUT}
         ENTRY JOURNALS.DY        SCREDIT.6      {SKIPFOUND,NOPUT}
         ENTRY JOURNALS.GL        SCREDIT.10     {SKIPFOUND,NOPUT}
         ENTRY JOURNALS.BR        SCREDIT.11     {SKIPFOUND,NOPUT}
         ENTRY JOURNALS.DP        SCREDIT.12     {SKIPFOUND,NOPUT}
         ENTRY JOURNALS.DESC      SCREDIT.16     {SKIPFOUND,NOPUT}
         ENTRY JOURNALS.AMOUNT    SCREDIT.18     {SKIPFOUND,NOPUT}
         ENTRY JOURNALS.CHK       SCREDIT.20     {SKIPFOUND,NOPUT}
         ENTRY JOURNALS.EMPLY     SCREDIT.22     {SKIPFOUND,NOPUT}
         ENTRY JOURNALS.JOB       SCREDIT.24     {SKIPFOUND,NOPUT}
    ENDGROUP
    MOVE JOURNALS.JR     TO SCREDIT.3
    MOVE JOURNALS.YR     TO SCREDIT.7
    MOVE JOURNALS.MN     TO SCREDIT.8
    MOVE JOURNALS.DY     TO SCREDIT.9
    MOVE JOURNALS.GL     TO SCREDIT.13
    MOVE JOURNALS.BR     TO SCREDIT.14
    MOVE JOURNALS.DP     TO SCREDIT.15
    MOVE JOURNALS.DESC   TO SCREDIT.17
    MOVE JOURNALS.AMOUNT TO SCREDIT.19
    MOVE JOURNALS.CHK    TO SCREDIT.21
    MOVE JOURNALS.EMPLY  TO SCREDIT.23
    MOVE JOURNALS.JOB    TO SCREDIT.25
  
    ACCEPT SCREDIT.3
    ACCEPT SCREDIT.7
    ACCEPT SCREDIT.8
    ACCEPT SCREDIT.9
    ACCEPT SCREDIT.13
    ACCEPT SCREDIT.14
    ACCEPT SCREDIT.15
    ACCEPT SCREDIT.17
    ACCEPT SCREDIT.19
    ACCEPT SCREDIT.21
    ACCEPT SCREDIT.23
    ACCEPT SCREDIT.25

    [multiuser] reread
         RELATE JOURNALS
         MOVE (SCREDIT.5 - 1) TO FIELDINDEX
         MOVE ((SCREDIT.18 * (-1)) + LEDGER.TYJAN&) TO LEDGER.TYJAN&
         SAVERECORD LEDGER
         MOVE SCREDIT.3  TO JOURNALS.JR 
         MOVE SCREDIT.7  TO JOURNALS.YR 
         MOVE SCREDIT.8  TO JOURNALS.MN 
         MOVE SCREDIT.9  TO JOURNALS.DY 
         MOVE SCREDIT.13 TO JOURNALS.GL
         MOVE SCREDIT.14 TO JOURNALS.BR
         MOVE SCREDIT.15 TO JOURNALS.DP
         MOVE SCREDIT.17 TO JOURNALS.DESC
         MOVE SCREDIT.19 TO JOURNALS.AMOUNT
         MOVE SCREDIT.21 TO JOURNALS.CHK 
         MOVE SCREDIT.23 TO JOURNALS.EMPLY
         MOVE SCREDIT.25 TO JOURNALS.JOB 
         SAVERECORD JOURNALS
         CLEAR LEDGER
         RELATE JOURNALS
          MOVE (SCREDIT.8 - 1) TO FIELDINDEX
          MOVE (SCREDIT.19 + LEDGER.TYJAN&) TO LEDGER.TYJAN&
         SAVERECORD LEDGER
         IF JOURNALS.AMOUNT EQ (0) DELETE JOURNALS
    [multiuser] unlock
    CLEAR LEDGER JOURNALS
    CLEARFORM SCREDIT
    GOTO START

  END_EDIT_JOURNAL:
    INDICATE EDIT_SCR FALSE
RETURN   //for (edit_journal:)
//----------end option 7


//********< Print Journals >********************************************* 8 ***

//  PRINT_JOURNALS:
//    INDICATE JR_SCR TRUE
//    INDICATE STOP_PRINT FALSE
//    INDICATE PRT FALSE
//    MOVE '' TO JR
//    MOVE 0  TO JR_MONTH
//    MOVE 0  TO JR_DAY
//    MOVE 0  TO RECORD
//    MOVE 0  TO RECORD2
//    MOVE 0  TO PAGECOUNT
//    MOVE '' TO JRNAME
//    sysdate4 DFR_DATE
//
//
//    CLEARFORM SCRJR
//    CLEARFORM JRHEADER
//    CLEARFORM JRSUBTOTAL2
//    CLEARFORM JRDAYSUBTOTAL
//    CLEARFORM JRSUBTOTAL1
//
//    PAGE SCRJR
//         FORMAT SCRJR.1                {RANGE=1,12}
//         FORMAT SCRJR.2                {RANGE=1,31}
//         FORMAT SCRJR.3                {RANGE=80,99}
//         FORMAT SCRJR.4                {RANGE=1,12}
//         FORMAT SCRJR.5                {RANGE=1,31}
//         FORMAT SCRJR.6                {RANGE=80,99}
//         FORMAT SCRJR.7                {CAPSLOCK}
//         FORMAT SCRJR.8                {CAPSLOCK}
//         FORMAT SCRJR.9                {CAPSLOCK,REQUIRED}
//         FORMAT SCRJR.10               {CAPSLOCK,REQUIRED}
//         FORMAT SCRJR.11               {CAPSLOCK,REQUIRED}
//         FORMAT JRBODY.11              {SIGNRT}
//         FORMAT JRDAYSUBTOTAL.2        {SIGNRT}
//         FORMAT JRSUBTOTAL1.2          {SIGNRT}
//         FORMAT JRSUBTOTAL2.2          {SIGNRT}
//         FORMAT JRTOTAL.2              {SIGNRT}
//
//  QUES:
//    CLEAR JOURNALS
//
//    FIRST_DAY_OF_YEAR DFR_DATE TO DFR_DATE2
//    DECOMPOSE_DATE DFR_DATE2 TO ADAY AMONTH AYEAR
//     MOVE AMONTH        TO SCRJR.1
//     MOVE AYEAR         TO SCRJR.3
//    ACCEPT SCRJR.1      TO JOURNALS.MN
//    ACCEPT SCRJR.2      TO JOURNALS.DY
//    ACCEPT SCRJR.3      TO JOURNALS.YR
//     MOVE JOURNALS.DATE TO STARTDATE
//    CLEAR JOURNALS
//    DECOMPOSE_DATE DFR_DATE TO ADAY AMONTH AYEAR
//     MOVE AMONTH        TO SCRJR.4
//    DISPLAY ADAY        TO SCRJR.5
//     MOVE AYEAR         TO SCRJR.6
//    ACCEPT SCRJR.4      TO JOURNALS.MN
//     MOVE SCRJR.3       TO JOURNALS.YR
//    ACCEPT SCRJR.5      TO JOURNALS.DY
//    ACCEPT SCRJR.6
//     MOVE JOURNALS.DATE TO ENDDATE
//    CLEAR JOURNALS
//     DISPLAY 'AA'       TO SCRJR.7
//     DISPLAY 'ZZ'       TO SCRJR.8
//
//    ACCEPT SCRJR.7      TO JR
//         IF SCRJR.7 NE 'AA' DISPLAY SCRJR.7 TO SCRJR.8
//    ACCEPT SCRJR.8
//     MOVE REF.DISTRICT  TO SCRJR.9
//    ACCEPT SCRJR.10
//     DISPLAY "P"        TO SCRJR.11
//
//  REDO_OUTPUT:
//    ACCEPT SCRJR.11
//         IF NOT SCRJR.11 IN 'PCA' GOTO REDO_OUTPUT
//
//    INDICATE PRT AS SCRJR.11 EQ 'P'
//    move SCRJR.11 to out_dest
//    gosub output_dest
//    IF SCRJR.11 EQ 'A' IF ANSW EQ 'N' BEGIN
//         CLEARFORM SCRJR.11
//         CLEARXY 24 0
//         goto REDO_OUTPUT
//    END
//
//    [prt] PAGE STNBYJR
//    [STOP_PRINT] GOTO QUIT_PRINT_JOURNALS
//    [PRT] PAGE STNBYJR
//
//    MOVE (1) TO PAGECOUNT
//    MOVE (0) TO RECORD
//    MOVE (0) TO RECORD2
//    CLEAR JOURNALS
//    MOVE SCRJR.7 TO JRLIST.CODE
//    FIND GE JRLIST BY INDEX.1
//    [FOUND] BEGIN
//         MOVE JRLIST.CODE    TO JOURNALS.JR
//         MOVE SCRJR.3        TO JOURNALS.YR
//         MOVE SCRJR.1        TO JOURNALS.MN
//         MOVE SCRJR.2        TO JOURNALS.DY
//         MOVE SCRJR.9        TO JOURNALS.BR
//         MOVE SCRJR.10       TO JOURNALS.DP
//    END
//
//  START_JR_FIND:
//    FIND GE JOURNALS BY INDEX.3
//    [FINDERR] BEGIN
//         CLEAR JOURNALS JRLIST
//         OUTPUT JRNONE
//         GOTO ALL_TOTAL
//    END
//    [FOUND] INDICATE FIRST TRUE
//    [FOUND] GOTO START_JR_HERE
// REPEAT
//         FIND GT JOURNALS BY INDEX.3
//         [FINDERR] BEGIN
//              CLEAR JOURNALS JRLIST
//              GOSUB MONTH_TOTAL
//              GOSUB JOURNAL_TOTAL
//              GOTO ALL_TOTAL
//              PAGECHECK 4
//              OUTPUT REPBOT
//         END
//         KEYCHECK GOSUB STOP_PRT_JR
//
//  START_JR_HERE:
//         INDICATE SELECT AS JOURNALS.BR EQ SCRJR.9
//         [~ SELECT] BEGIN
//                        OUTPUT JRNONE
//                        GOTO ALL_TOTAL
//                    END
//         [SELECT]   INDICATE SELECT AS JOURNALS.DP EQ SCRJR.10
//         [~ SELECT] BEGIN
//                        OUTPUT JRNONE
//                        GOTO ALL_TOTAL
//                    END
//         [SELECT]   INDICATE SELECT AS JOURNALS.JR GE SCRJR.7
//         [SELECT]   INDICATE SELECT AS JOURNALS.JR LE SCRJR.8
//                    indicate nojr as [~ select]
//         [~ SELECT] GOTO QUIT_JR
//         [SELECT]   INDICATE SELECT AS JOURNALS.DATE GE STARTDATE
//         [SELECT]   INDICATE SELECT AS JOURNALS.DATE LE ENDDATE
//
//  //       [SELECT]   IF JOURNALS.JR NE JRLIST.CODE BEGIN
//  //                      CLEAR JRLIST
//  //                      MOVE JOURNALS.JR TO JRLIST.CODE
//  //                      FIND EQ JRLIST BY INDEX.1
//  //                  END
//
//         [~ SELECT] IF SCRJR.7 EQ SCRJR.8 GOTO QUIT_JR
//
//         [SELECT][FIRST]   GOSUB JR_HEADER
//         [SELECT][FIRST]   MOVE JOURNALS.MN TO JR_MONTH
//         [SELECT][FIRST]   MOVE JOURNALS.JR TO JR
//         [SELECT][FIRST]   MOVE JOURNALS.DY TO JR_DAY
//
//         [~ FIRST] BEGIN
//                        IF JRNAME NE JOURNALS.DESC OUTPUT JRBLANK
//                        IF JOURNALS.DY NE JR_DAY IF JOURNALS.MN EQ JR_MONTH;
//                                       IF JOURNALS.JR EQ JR GOSUB DAILY_TOTAL
//                        IF JOURNALS.MN NE JR_MONTH IF JOURNALS.JR EQ JR GOSUB ;
//                                                                  MONTH_TOTAL
//
//
//                        IF JOURNALS.JR NE JR BEGIN
//                             CLEAR JRLIST
//                             MOVE JR TO JRLIST.CODE    //WE NEED TO PRINT PRIOR
//                             FIND EQ JRLIST BY INDEX.1 // JR HEADING
//                             GOSUB MONTH_TOTAL
//                             GOSUB JOURNAL_TOTAL
//                             FORMFEED        //START NEW PAGE FOR NEW JOURNAL
//
//                             CLEAR JRLIST             // RESET JR HEADING FOR
//                             MOVE JOURNALS.JR TO JRLIST.CODE  // PRINTING
//                             FIND EQ JRLIST BY INDEX.1
//                             GOSUB JR_HEADER
//                        END
//                   END
//
//         [SELECT]   IF JOURNALS.JR NE JRLIST.CODE BEGIN
//                        CLEAR JRLIST
//                        MOVE JOURNALS.JR TO JRLIST.CODE
//                        FIND EQ JRLIST BY INDEX.1
//                    END
//
//
//         [~ SELECT] IF SCRJR.7 NE SCRJR.8 BEGIN
//                        FIND GT JRLIST BY INDEX.1
//                        [FINDERR] GOTO QUIT_JR
//                        [FOUND] BEGIN
//                             CLEAR JOURNALS
//                             MOVE JRLIST.CODE TO JOURNALS.JR
//                             MOVE SCRJR.1 TO JOURNALS.MN
//                             MOVE SCRJR.2 TO JOURNALS.DY
//                             MOVE SCRJR.3 TO JOURNALS.YR
//                             MOVE SCRJR.10 TO JOURNALS.DP
//                             GOTO START_JR_FIND
//                        END
//                    END
//
//
//
//
//         [PRT] IF JOURNALS.DESC NE JRNAME  PAGECHECK 8
//         [PRT] IF JOURNALS.DESC EQ JRNAME  PAGECHECK 2
//         [~ PRT] PAGECHECK 1
//         [PAGEBREAK] GOSUB JR_HEADER
//         [PRT] DISPLAY Jrlist.code TO STNBYJR.1
//         PRINT JOURNALS.MN        TO JRBODY.1
//         PRINT JOURNALS.DY        TO JRBODY.2
//         PRINT JOURNALS.YR        TO JRBODY.3
//         PRINT JOURNALS.GL        TO JRBODY.4
//         PRINT JOURNALS.BR        TO JRBODY.5
//         PRINT JOURNALS.DP        TO JRBODY.6
//         IF JOURNALS.DESC EQ JRNAME PRINT ' '              TO JRBODY.7
//         IF JOURNALS.DESC NE JRNAME PRINT JOURNALS.DESC    TO JRBODY.7
//         PRINT JOURNALS.EMPLY     TO JRBODY.8
//         PRINT JOURNALS.JOB       TO JRBODY.9
//         PRINT JOURNALS.RECNUM    TO JRBODY.10
//         PRINT JOURNALS.AMOUNT    TO JRBODY.11
//         [FIRST] INDICATE FIRST FALSE
//         OUTPUT JRBODY
//         KEYCHECK GOSUB STOP_PRT_JR
//
//         INCREMENT RECORD
//         INCREMENT RECORD2
//         MOVE JOURNALS.MN    TO JR_MONTH
//         MOVE JOURNALS.DY    TO JR_DAY
//         MOVE JOURNALS.JR    TO JR
//         MOVE JOURNALS.DESC  TO JRNAME
//
//  DO_AGAIN:
//    LOOP
//
//  JR_HEADER:
//    PRINT JRLIST.CODE    TO JRHEADER.1
//    PRINT JRLIST.DESC    TO JRHEADER.2
//    PRINT REF.PROSECUTOR TO JRHEADER.3
//    PRINT PAGECOUNT      TO JRHEADER.4
//    OUTPUT JRHEADER
//  RETURN
//
//  MONTH_TOTAL:
//    GOSUB DAILY_TOTAL
//    gosub pg_brkr
//    PRINT RECORD             TO JRSUBTOTAL2.1
//    SUBTOTAL JRDAYSUBTOTAL.2 TO JRSUBTOTAL2.2
//    MOVE 0                   TO RECORD
//    OUTPUT JRSUBTOTAL2
//  RETURN
//
//  DAILY_TOTAL:
//    gosub pg_brkr
//    PRINT RECORD2            TO JRDAYSUBTOTAL.1
//    SUBTOTAL JRBODY.11       TO JRDAYSUBTOTAL.2
//    MOVE 0                   TO RECORD2
//    OUTPUT JRDAYSUBTOTAL
//  RETURN
//
//  JOURNAL_TOTAL:
//    gosub pg_brkr
//    SUBTOTAL JRSUBTOTAL2.1   TO JRSUBTOTAL1.1
//    SUBTOTAL JRSUBTOTAL2.2   TO JRSUBTOTAL1.2
//    [~ PRT] MOVE (23) TO LINECOUNT
//    OUTPUT JRSUBTOTAL1
//
//  RETURN
//
//  ALL_TOTAL:
//   gosub pg_brkr
//    SUBTOTAL JRSUBTOTAL1.1   TO JRTOTAL.1
//    SUBTOTAL JRSUBTOTAL1.2   TO JRTOTAL.2
//    OUTPUT JRTOTAL
//    MOVE (0) TO JRTOTAL.1
//    MOVE (0) TO JRTOTAL.2
//    [~ PRT] INKEY ANSW
//    GOTO QUIT_PRINT_JOURNALS
//  RETURN
//
//  pg_brkr:
//    [PRT] PAGECHECK 8
//    [~ PRT] PAGECHECK 1
//    [PAGEBREAK][PRT] GOSUB JR_HEADER
//  return
//
//  STOP_PRT_JR:
//    gosub key_prss
//    IF ANSW IN "Y" BEGIN
//         [PRT] PAGECHECK 8
//         [~ PRT] PAGECHECK 1
//         [PRT][PAGEBREAK] FORMFEED
//         OUTPUT OPABORT
//         RETURN QUIT_JR
//    END
//
//  END_PRT_JR:
//  RETURN
//
//  QUIT_JR:
//     GOSUB MONTH_TOTAL
//     GOSUB JOURNAL_TOTAL
//     OUTPUT REPBOT
//    CLEARFORM JRDAYSUBTOTAL
//    CLEARFORM JRSUBTOTAL1
//    CLEARFORM JRSUBTOTAL2
//    CLEAR JOURNALS JRLIST
//
//  QUIT_PRINT_JOURNALS:
//    INDICATE JR_SCR FALSE
//    CLEARFORM SCRJR
//    [PRT] gosub ff_DESPOOL
//    [PRT] FORMFEED
//  RETURN     //for  (print_journals:)
////----------end option 8---------------------
//
//
//********< Print Detail Ledger >**************************************** 9 ***

  DETAIL_LEDGER:
    INDICATE LD_SCR TRUE
    INDICATE STOP_PRINT FALSE
    sysdate4 DFR_DATE
    MOVE 1 TO PAGECOUNT

    FORMAT LDSUBHEADER1.5         {SIGNRT}
    FORMAT LDSUBHEADER1.6         {SIGNRT}
    FORMAT LDSUBHEADER1.8         {SIGNRT}
    FORMAT LDSUBHEADER1.10        {SIGNRT}
    FORMAT LDSUBHEADER1.12        {SIGNRT}
    FORMAT LDSUBHEADER1.14        {SIGNRT}
    FORMAT LDSUBHEADER1.16        {SIGNRT}
    FORMAT LDSUBHEADER1.18        {SIGNRT}
    FORMAT LDSUBHEADER1.20        {SIGNRT}
    FORMAT LDSUBHEADER1.22        {SIGNRT}
    FORMAT LDSUBHEADER1.24        {SIGNRT}
    FORMAT LDSUBHEADER1.26        {SIGNRT}
    FORMAT LDSUBHEADER1.28        {SIGNRT}
    FORMAT LDBODY.10              {SIGNRT}
    FORMAT LDSUBTOTAL1.1          {SIGNRT}
    FORMAT LDTOTAL.1              {SIGNRT}
    FORMAT SCRLD.1 THRU SCRLD.3   {CAPSLOCK}

    PAGE SCRLD

  QUES4:   
    MOVE REF.DISTRICT   TO SCRLD.1
    [NOT DIV] MOVE (0)  TO SCRLD.2
    [DIV] ACCEPT SCRLD.2
  ACCEPT_QUES_LD:
    DISPLAY 'P'         TO SCRLD.3
    ACCEPT SCRLD.3
    IF ~ SCRLD.3 IN 'PCA' BEGIN
         CLEARFORM SCRLD
         GOTO QUES4
    END

    move scrld.3 to out_dest 
    gosub output_dest
//    [prt] Direct_Output "Ledgedet.txt"
    IF out_dest EQ 'P' PAGE STNBYLD
    IF SCRLD.3 EQ 'A' IF ANSW EQ 'N' BEGIN
         CLEARFORM SCRLD.3
         goto ACCEPT_QUES_LD
    END

    [STOP_PRINT]  GOTO QUIT_LD_SCR

    CLEAR LEDGER
    FIND GE LEDGER BY INDEX.1
    [FINDERR] GOTO QUIT_LD_SCR
    [FOUND]   GOSUB HEAD
    GOTO DO_LD_PRINT

    REPEAT      // Loop for finding and printing ledger account

         KEYCHECK GOSUB STOP_LD

  DO_LD_PRINT:
         INDICATE SELECT AS LEDGER.NUMBER NE REF.TYRETAINED
         [NOT SELECT] GOTO DO_LD_AGAIN
         [SELECT] IFNOT "A" IN SCRLD.2 INDICATE SELECT AS LEDGER.DIVISION ;
                                                                     EQ SCRLD.2
         [NOT SELECT] GOTO DO_LD_AGAIN

         PAGECHECK 5
         [PAGEBREAK] GOSUB HEAD
         DISPLAY LEDGER.NUMBER    TO STNBYLD.1
         PRINT LEDGER.NUMBER      TO LDSUBHEADER1.1
         PRINT LEDGER.DISTRICT    TO LDSUBHEADER1.2
         PRINT LEDGER.DIVISION    TO LDSUBHEADER1.3
         PRINT LEDGER.DESC        TO LDSUBHEADER1.4
         PRINT LEDGER.TYBEG       TO LDSUBHEADER1.5
         PRINT LEDGER.TYBEG       TO LDBODY.10
          MOVE REF.PER1 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO LDSUBHEADER1.7
         PRINT LEDGER.CD&         TO LDSUBHEADER1.6
          MOVE REF.PER2 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO LDSUBHEADER1.15
         PRINT LEDGER.CD&         TO LDSUBHEADER1.14
          MOVE REF.PER3 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO LDSUBHEADER1.23
         PRINT LEDGER.CD&         TO LDSUBHEADER1.22
          MOVE REF.PER4 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO LDSUBHEADER1.9
         PRINT LEDGER.CD&         TO LDSUBHEADER1.8
          MOVE REF.PER5 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO LDSUBHEADER1.17
         PRINT LEDGER.CD&         TO LDSUBHEADER1.16
          MOVE REF.PER6 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO LDSUBHEADER1.25
         PRINT LEDGER.CD&         TO LDSUBHEADER1.24
          MOVE REF.PER7 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO LDSUBHEADER1.11
         PRINT LEDGER.CD&         TO LDSUBHEADER1.10
          MOVE REF.PER8 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO LDSUBHEADER1.19
         PRINT LEDGER.CD&         TO LDSUBHEADER1.18
          MOVE REF.PER9 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO LDSUBHEADER1.27
         PRINT LEDGER.CD&         TO LDSUBHEADER1.26
          MOVE REF.PER10 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO LDSUBHEADER1.13
         PRINT LEDGER.CD&         TO LDSUBHEADER1.12
          MOVE REF.PER11 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO LDSUBHEADER1.21
         PRINT LEDGER.CD&         TO LDSUBHEADER1.20
          MOVE REF.PER12 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO LDSUBHEADER1.29
         PRINT LEDGER.CD&         TO LDSUBHEADER1.28
         PRINT LEDGER.TYTOTAL     TO LDSUBTOTAL1.1
         OUTPUT LDSUBHEADER1
         CLEAR JOURNALS
         MOVE LEDGER.OVERLAP TO JOURNALS.DIST_DIV

         LD_JOURNALS: REPEAT
              FIND GT JOURNALS BY INDEX.2
              [FINDERR] GOTO LASTJRNAL
              IF JOURNALS.DIST_DIV NE LEDGER.OVERLAP GOTO LASTJRNAL
              PAGECHECK 5
              [PAGEBREAK] GOSUB HEAD
              PRINT USERX.USER_NUMB    TO LDBODY.1
              PRINT JOURNALS.MN        TO LDBODY.2  
              PRINT JOURNALS.DY        TO LDBODY.3
              PRINT JOURNALS.YR        TO LDBODY.4
              PRINT JOURNALS.DESC      TO LDBODY.5
              PRINT JOURNALS.JR        TO LDBODY.6
              PRINT JOURNALS.EMPLY     TO LDBODY.7
              PRINT JOURNALS.JOB       TO LDBODY.8
              PRINT JOURNALS.CHK       TO LDBODY.9
              PRINT JOURNALS.AMOUNT    TO LDBODY.10
              OUTPUT LDBODY
 
              KEYCHECK GOSUB STOP_LD

         LOOP //UNTIL LAST JOURNAL

  LASTJRNAL: SUBTOTAL LDBODY.10 TO LDSUBTOTAL1.1
         OUTPUT LDSUBTOTAL1
  DO_LD_AGAIN:
         FIND GT LEDGER BY INDEX.1
         [FINDERR] GOTO END_LD_ROUTINE
    [FOUND]  LOOP
  
  END_LD_ROUTINE:
    SUBTOTAL LDSUBTOTAL1.1 TO LDTOTAL.1
    OUTPUT LDTOTAL
    GOTO QUIT_LD_SCR         

  HEAD:                  
    PRINT REF.PROSECUTOR TO LDHEADER.1
    PRINT PAGECOUNT      TO LDHEADER.2
    PRINT DFR_DATE       TO LDHEADER.3
    OUTPUT LDHEADER
  RETURN

  STOP_LD:
    gosub key_prss
    IF ANSW IN "Y" BEGIN
         INDICATE LD_SCR FALSE
         gosub ff_despool
         RETURN QUIT_LD_SCR
    END
    IF ~ ANSW IN "Y" BEGIN
         CLEARXY 24 0
         GOTO END_STOP_LD
    END

  END_STOP_LD:
  RETURN

  QUIT_LD_SCR:          
    INDICATE LD_SCR FALSE
    CLEARFORM SCRLD
    gosub ff_DESPOOL
//    copyfile "\dataflex\ledgdet.txt" to "LPT1:"

RETURN    // for (detail_ledger:)
//---------end option 9------------------------------


//**********< Print Ledger Summary >************************************ 10 ***

  PRINT_TRIAL_SUM:
    INDICATE SUM_SCR TRUE
    CLEAR LEDGER
         FORMAT SUMBODY.5  {SIGNRT}
         FORMAT SUMBODY.6  {SIGNRT}
         FORMAT SUMBODY.8  {SIGNRT}
         FORMAT SUMBODY.10 {SIGNRT}
         FORMAT SUMBODY.12 {SIGNRT}
         FORMAT SUMBODY.14 {SIGNRT}
         FORMAT SUMBODY.16 {SIGNRT}
         FORMAT SUMBODY.18 {SIGNRT}
         FORMAT SUMBODY.20 {SIGNRT}
         FORMAT SUMBODY.22 {SIGNRT}
         FORMAT SUMBODY.24 {SIGNRT}
         FORMAT SUMBODY.26 {SIGNRT}
         FORMAT SUMBODY.28 {SIGNRT}
         FORMAT SUMBODY.30 {SIGNRT}
         FORMAT SUMTOTAL.1 {SIGNRT}
         FORMAT SCRSUM.1   {CAPSLOCK}
         FORMAT SCRSUM.2   {CAPSLOCK}
         FORMAT SCRSUM.3   {CAPSLOCK,CHECK='PCA'}
    [NOT DIV] MOVE (0) TO SCRSUM.2
    PAGE SCRSUM

  START_SUMSCR:
    INDICATE STOP_PRINT FALSE
    MOVE 1 TO PAGECOUNT
    MOVE REF.DISTRICT TO SCRSUM.1
    [DIV]  ACCEPT SCRSUM.2

    DISPLAY 'P' TO SCRSUM.3
    ACCEPT SCRSUM.3
    move scrsum.3 to out_dest
    gosub output_dest
//    [prt] Direct_output "LedgeSum.txt"

    IF SCRSUM.3 EQ 'P' PAGE SCRSUM
    [STOP_PRINT] BEGIN
         gosub ff_despool
         GOTO QUIT_SUM_SCR
    END

    FIND GE LEDGER BY INDEX.1
    [FINDERR] GOTO QUIT_SUM_SCR
    [FOUND] INDICATE FIRST TRUE
    [FOUND] REPEAT

         INDICATE SELECT AS LEDGER.NUMBER NE REF.TYRETAINED
         [NOT SELECT] GOTO DO_SUM_AGAIN         
         [SELECT] IFNOT "A" IN SCRSUM.2 INDICATE SELECT AS LEDGER.DIVISION ;
                                                                    EQ SCRSUM.2
         [NOT SELECT] GOTO DO_SUM_AGAIN
         [FIRST] GOSUB DO_SUM_HEADER
         [~ FIRST] PAGECHECK 6 
         [~ FIRST] [PAGEBREAK] GOSUB DO_SUM_HEADER
         PRINT LEDGER.NUMBER      TO SUMBODY.1
         PRINT LEDGER.DISTRICT    TO SUMBODY.2
         PRINT LEDGER.DIVISION    TO SUMBODY.3
         PRINT LEDGER.DESC        TO SUMBODY.4
         PRINT LEDGER.TYBEG       TO SUMBODY.5
          MOVE REF.PER1 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO SUMBODY.7
         PRINT LEDGER.CD&         TO SUMBODY.6
          MOVE REF.PER2 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO SUMBODY.15
         PRINT LEDGER.CD&         TO SUMBODY.14
          MOVE REF.PER3 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO SUMBODY.23
         PRINT LEDGER.CD&         TO SUMBODY.22
          MOVE REF.PER4 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO SUMBODY.9
         PRINT LEDGER.CD&         TO SUMBODY.8
          MOVE REF.PER5 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO SUMBODY.17
         PRINT LEDGER.CD&         TO SUMBODY.16
          MOVE REF.PER6 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO SUMBODY.25
         PRINT LEDGER.CD&         TO SUMBODY.24
          MOVE REF.PER7 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO SUMBODY.11
         PRINT LEDGER.CD&         TO SUMBODY.10
          MOVE REF.PER8 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO SUMBODY.19
         PRINT LEDGER.CD&         TO SUMBODY.18
          MOVE REF.PER9 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO SUMBODY.27
         PRINT LEDGER.CD&         TO SUMBODY.26
          MOVE REF.PER10 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO SUMBODY.13
         PRINT LEDGER.CD&         TO SUMBODY.12
          MOVE REF.PER11 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO SUMBODY.21
         PRINT LEDGER.CD&         TO SUMBODY.20
          MOVE REF.PER12 TO FIELDINDEX
         PRINT MONTHS.MONTH&      TO SUMBODY.29
         PRINT LEDGER.CD&         TO SUMBODY.28
          REREAD ledger
              MOVE (0) TO LEDGER.TYTOTAL
              FOR FIELDINDEX FROM 0 TO 12
                   MOVE (LEDGER.TYJAN& + LEDGER.TYTOTAL) TO LEDGER.TYTOTAL
              LOOP
              PRINT LEDGER.TYTOTAL TO SUMBODY.30
              OUTPUT SUMBODY
              SAVERECORD LEDGER
          UNLOCK
         INDICATE FIRST FALSE
         KEYCHECK BEGIN
  ANS_SUM:
              gosub key_prss
              IF ANSW EQ 'Y' BEGIN
                   PAGECHECK 5
                   [PAGEBREAK] FORMFEED
                   OUTPUT OPABORT
                   FORMFEED
                   GOSUB DO_SUM_TOTAL
                   GOTO QUIT_SUM_SCR
              END
         END

  DO_SUM_AGAIN:
         FIND GT LEDGER BY INDEX.1
    [FOUND] LOOP
    [FINDERR] GOTO END_SUM_REPORT

  END_SUM_REPORT:
    GOSUB DO_SUM_TOTAL
    gosub ff_despool
//    copyfile "\dataflex\ledgesum.txt" to "LPT1:"
    GOTO QUIT_SUM_SCR
  RETURN

  DO_SUM_HEADER:
    PRINT REF.PROSECUTOR TO SUMHEADER.1
    PRINT PAGECOUNT      TO SUMHEADER.2
    OUTPUT SUMHEADER
  RETURN

  DO_SUM_TOTAL:
    PAGECHECK 6
    [PAGEBREAK] GOSUB DO_SUM_HEADER
    SUBTOTAL SUMBODY.30 TO SUMTOTAL.1
    OUTPUT SUMTOTAL
  RETURN

  QUIT_SUM_SCR:
    INDICATE SUM_SCR FALSE
    CLEARFORM SCRSUM
  RETURN    // for (print_trial_sum:)
//---------end option 10------------


//*********< Print Selected Journals >********************************** 11 ***

  PRINT_JOURNALS_SELECT:

    INDICATE SEL_SCR TRUE
    INDICATE STOP_PRINT FALSE
    INCREMENT PAGECOUNT
    sysdate4 DFR_DATE
        FORMAT SCRSEL.6  {RANGE=1,12}
        FORMAT SCRSEL.7  {RANGE=1980,2100}
        FORMAT SCRSEL.8  {RANGE=1,12}
        FORMAT SCRSEL.9  {RANGE=1980,2100}
        FORMAT SCRSEL.10 {CAPSLOCK,CHECK="CDB"}
        FORMAT SCRSEL.11 {CAPSLOCK,CHECK="CPA"}
        FORMAT SCRSEL.12 {CAPSLOCK,CHECK="YN"}
    CLEARFORM SCRSEL
    CLEARFORM SCRSEL2
  
    PAGE SCRSEL
    MOVE 0 TO GLCOUNT
  LOOKUP:
    CLEARFORM SCRSEL.2 THRU SCRSEL.5
    ACCEPT SCRSEL.2 
    IF SCRSEL.2 EQ 0 GOTO CONT
    MOVE REF.DISTRICT TO SCRSEL.3
    [DIV]  ACCEPT SCRSEL.4 
    CLEAR LEDGER
    MOVE SCRSEL.2 TO LEDGER.NUMBER
    MOVE SCRSEL.3 TO LEDGER.DISTRICT
    MOVE SCRSEL.4 TO LEDGER.DIVISION
    FIND EQ LEDGER.OVERLAP
    [FINDERR] GOTO LOOKUP
    MOVE (GLCOUNT + 1)   TO SCRSEL.1
    MOVE LEDGER.DESC     TO SCRSEL.5
    CALC (GLCOUNT*3) TO WINDOWINDEX
    MOVE LEDGER.NUMBER   TO SCRSEL2.1&
    MOVE LEDGER.DISTRICT TO SCRSEL2.2&
    MOVE LEDGER.DIVISION TO SCRSEL2.3&
    INCREMENT GLCOUNT
    CLEAR LEDGER
         FOR COUNT FROM 1 TO 200
         LOOP
    IF GLCOUNT LT 9 GOTO LOOKUP

  CONT:

    FIRST_DAY_OF_YEAR DFR_DATE TO DFR_DATE2
    DECOMPOSE_DATE DFR_DATE2 TO ADAY AMONTH AYEAR
    MOVE AMONTH TO SCRSEL.6
    MOVE AYEAR  TO SCRSEL.7
    
    ACCEPT SCRSEL.6
    ACCEPT SCRSEL.7  

    DECOMPOSE_DATE DFR_DATE TO ADAY AMONTH AYEAR
    MOVE AMONTH TO SCRSEL.8
    ACCEPT SCRSEL.8
   
     MOVE SCRSEL.7 TO SCRSEL.9 
     DISPLAY 'B'   TO SCRSEL.10
    ACCEPT SCRSEL.10
     DISPLAY 'P'   TO SCRSEL.11
    ACCEPT SCRSEL.11
    IF SCRSEL.11 MATCH "P" ACCEPT SCRSEL.12
     move scrsel.11 to out_dest
    gosub output_dest
//    [prt] Direct_output "ledgeSel.txt"


    IF out_dest EQ 'P' BEGIN
         CLEARFORM STNBYDET
         PAGE STNBYDET
    END

    [STOP_PRINT] GOTO QUIT_PRT_JR_SELECT

    MOVE 0 TO GLCOUNT

    FORMAT SELSUBHEADER1.5   {SIGNRT}
    FORMAT SELBODY.10        {SIGNRT}
    FORMAT SELSUBTOTAL1.2    {SIGNRT}
    FORMAT SELTOTAL.1        {SIGNRT}
    
    GOSUB JRHEAD

  MASTER:     REPEAT  //FIND,COMPUTE BEGINNING BALANCE, PRINT SCRGENERAL LEDGER ACCOUNT
         MOVE (GLCOUNT*3) TO WINDOWINDEX
         CLEAR LEDGER
         IF SCRSEL2.1& EQ (0) GOTO TOTAL //COMPLETED LAST ENTRY
         MOVE SCRSEL2.1&          TO LEDGER.NUMBER
         MOVE SCRSEL2.2&          TO LEDGER.DISTRICT
         MOVE SCRSEL2.3&          TO LEDGER.DIVISION
         FIND EQ LEDGER BY INDEX.1
         MOVE 0 TO COUNT
         MOVE LEDGER.TYBEG TO ANSWER
         PRINT LEDGER.NUMBER      TO SELSUBHEADER1.1
         PRINT LEDGER.DISTRICT    TO SELSUBHEADER1.2
         PRINT LEDGER.DIVISION    TO SELSUBHEADER1.3
         PRINT LEDGER.DESC        TO SELSUBHEADER1.4
         MOVE COUNT TO FIELDINDEX
         WHILE REF.PER1& NE SCRSEL.6
              MOVE REF.PER1& TO FIELDINDEX
              CALC (ANSWER+LEDGER.CD&) TO ANSWER
              INCREMENT COUNT
              MOVE COUNT TO FIELDINDEX
         END
         PRINT ANSWER             TO SELSUBHEADER1.5
         MOVE LEDGER.NUMBER       TO STNBYDET.1
         OUTPUT SELSUBHEADER1
         MOVE (0.00) TO TRANS
         INCREMENT LINE
  
         CLEAR JOURNALS
         MOVE LEDGER.OVERLAP TO JOURNALS.DIST_DIV
         MOVE SCRSEL.7       TO JOURNALS.YR
         MOVE SCRSEL.6       TO JOURNALS.MN 
   
         REPEAT  //FIND AND PRINT SUPPORTING JOURNALS
  JRNALS:     FIND GT JOURNALS BY INDEX.2
              [FINDERR]   GOTO LASTJR
              INDICATE GOOD AS JOURNALS.DIST_DIV EQ LEDGER.OVERLAP
              [NOT GOOD]  GOTO LASTJR
              [good] if journals.mn lt scrsel.6 goto xll
              [GOOD] INDICATE GOOD AS JOURNALS.YR LE SCRSEL.9 
              [GOOD] IF JOURNALS.YR EQ SCRSEL.9 INDICATE GOOD AS ;
                                                      JOURNALS.MN LE SCRSEL.8
              
              [NOT GOOD]  GOTO LASTJR
              [GOOD] IF SCRSEL.10 MATCH "C" INDICATE GOOD AS JOURNALS.AMOUNT ;
                                                      LT (0.00)
              [GOOD] IF SCRSEL.10 MATCH "D" INDICATE GOOD AS JOURNALS.AMOUNT ;
                                                      GE (0.00) 
              [NOT GOOD]  GOTO JRNALS

              PRINT USER_NUMB          TO SELBODY.1                           
              PRINT JOURNALS.MN        TO SELBODY.2                               
              PRINT JOURNALS.DY        TO SELBODY.3                               
              PRINT JOURNALS.YR        TO SELBODY.4                               
              PRINT JOURNALS.DESC      TO SELBODY.5                             
              PRINT JOURNALS.JR        TO SELBODY.6
              PRINT JOURNALS.EMPLY     TO SELBODY.7                            
              PRINT JOURNALS.JOB       TO SELBODY.8                              
              PRINT JOURNALS.RECNUM    TO SELBODY.9                              
              PRINT JOURNALS.AMOUNT    TO SELBODY.10                          
               MOVE (JOURNALS.AMOUNT+ANSWER) TO ANSWER                   
               MOVE (JOURNALS.AMOUNT+TRANS)  TO TRANS                     
              INCREMENT LINE                                            
              OUTPUT SELBODY                                                
              KEYCHECK GOSUB STOP_PRT_SEL
              [STOP_PRINT] OUTPUT OPABORT
              [STOP_PRINT] GOTO QUIT_PRT_JR_SELECT
              IF LINE GE 53 GOSUB JRHEAD
  xll:       
         LOOP      // TO NEXT JOURNAL

  LASTJR:     PRINT ANSWER TO SELSUBTOTAL1.2
         SUBTOTAL SELBODY.10 TO SELSUBTOTAL1.1
         OUTPUT SELSUBTOTAL1
         INCREMENT LINE
         INCREMENT LINE

         INCREMENT GLCOUNT
         IF SCRSEL.11 MATCH "C" INPUT "Depress Enter (Return) to continue." QUIT
         IF SCRSEL.12 MATCH "Y" GOSUB JRHEAD
    LOOP // TO NEXT GL NUMBER

  TOTAL:
    CLEARSCREEN
    PAGECHECK 1
    OUTPUT REPBOT
    DESPOOL
//    copyFile "\dataflex\ledgesel.txt" to "LPT1:"
    GOSUB DO_MORE
    GOTO QUIT_PRT_JR_SELECT

  JRHEAD:
    PAGECHECK 54
    MOVE 0 TO LINE
    MOVE (1) TO SYSFILE.RECNUM
    FIND EQ SYSFILE.RECNUM
    MOVE PAGECOUNT      TO SELHEADER.1
    MOVE SYSFILE.TODAY  TO SELHEADER.2
    MOVE REF.PROSECUTOR TO SELHEADER.3
    OUTPUT SELHEADER
  RETURN

  STOP_PRT_SEL:
    gosub key_prss
    IF ANSW EQ 'Y' BEGIN
         PAGECHECK 5
         [PAGEBREAK] FORMFEED
         OUTPUT OPABORT
         FORMFEED
         INDICATE STOP_PRINT TRUE 
    END
  RETURN

  DO_MORE:
    GOTOXY 24 0
    SHOW " Do You Wish To Print More Accounts ? (Y/N) "
    INKEY ANSW
    UPPERCASE ANSW
    IF ~ ANSW IN "YN" GOTO DO_MORE    
    IF ANSW EQ 'Y' BEGIN
         CLEARXY 24 0
         CLEARFORM SCRSEL 
         CLEARFORM SCRSEL2
         CLEAR LEDGER JOURNALS
         MOVE 0 TO PAGECOUNT
         RETURN PRINT_JOURNALS_SELECT
    END
    CLEARXY 24 0
  RETURN

  QUIT_PRT_JR_SELECT:
    gosub ff_despool
    INDICATE SEL_SCR FALSE
    CLEAR LEDGER JOURNALS
    CLEARFORM SCRSEL
    CLEARFORM SCRSEL2
    MOVE 0 TO PAGECOUNT
  RETURN     // for  (print_journals_select:)
//-------------end option 11-------------


//************< Print Revenue Statement >******************************* 12 ***

  PRINT_REVENUE:
    move "" to legdate
//    Direct_Output
    INDICATE REV_SCR TRUE
    INDICATE STOP_PRINT FALSE
    CLEAR LEDGER RPTMAST DIVISION
         FORMAT REVBODY.2 {SIGNRT}
         FORMAT REVBODY.3 {SIGNRT}
    PAGE Scrbal
  START_REVSCR:
    ACCEPT Scrbal.1
    ACCEPT Scrbal.2
      If scrbal.3 eq '' Begin
        Append Legdate Today ":" hr ":" min ":" sec
        Display Legdate to Scrbal.3
      End
    ACCEPT Scrbal.3
      Move "" to Legdate
      Display 20 to Scrbal.4
    ACCEPT Scrbal.4 TO RPTMAST.REPORT
      DISPLAY "Y" TO Scrbal.5
    ACCEPT Scrbal.5
      DISPLAY "P" TO Scrbal.6
    ACCEPT Scrbal.6
      IF ~ Scrbal.6 IN "PCA" goto START_REVSCR

    INDICATE OKA AS Scrbal.5 MATCH "N"
    MOVE (0) TO LINECOUNT
    move Scrbal.6 to out_dest
    gosub output_dest
    IF scrbal.6 EQ 'P' PAGE PRINTSCR
    [STOP_PRINT] GOTO QUIT_REV_SCR

    FIND GE RPTMAST BY INDEX.1
    [FOUND] REPEAT
         RELATE RPTMAST
         INDICATE OK TRUE

        PAGECHECK 1



         IF RPTMAST.CT  MATCH "PH" BEGIN
              TRIM REF.PROSECUTOR   TO SHORT
               GOSUB CENTER
              PRINT LONG               TO REVHEADER.1
              TRIM REF.ADDRESS      TO SHORT
               GOSUB CENTER
              PRINT LONG               TO REVHEADER.2
              TRIM REF.CITY_STATE   TO SHORT
               GOSUB CENTER
              PRINT LONG               TO REVHEADER.3
              LENGTH Scrbal.2 TO ANSWER
               MOVE RPTMAST.ALTDESC TO SHORT
               IF ANSWER GT (0) MOVE Scrbal.2 TO SHORT
              TRIM SHORT            TO SHORT
              TRIM Scrbal.3 TO LONG
               APPEND SHORT " " LONG
               TRIM SHORT           TO SHORT
               GOSUB CENTER
              PRINT LONG               TO REVHEADER.4
               IF RPTMAST.REPORT GE (20) MOVE '20' TO DIVISION.CODE
               FIND EQ DIVISION BY INDEX.1
              PRINT REF.DISTRICT       TO REVHEADER.5
              PRINT DIVISION.CODE      TO REVHEADER.6
              PRINT DIVISION.DESC      TO REVHEADER.7
 
               MOVE Scrbal.1 TO FIELDINDEX
              PRINT MONTHS.MONTH&      TO REVHEADER.8
              [PRT]  OUTPUT REVHEADER
         END

         IF RPTMAST.CT  MATCH "AH" BEGIN
              TRIM DIVISION.DESC    TO SHORT
               GOSUB CENTER
              PRINT LONG               TO REVHEADER.1
              TRIM REF.ADDRESS      TO SHORT
               GOSUB CENTER
              PRINT LONG               TO REVHEADER.2
              TRIM REF.CITY_STATE   TO SHORT
               GOSUB CENTER
              PRINT LONG               TO REVHEADER.3
              LENGTH Scrbal.2 TO ANSWER
               MOVE RPTMAST.ALTDESC TO SHORT
               IF ANSWER GT (0) MOVE Scrbal.2 TO SHORT
              TRIM SHORT TO SHORT
              TRIM Scrbal.3 TO LONG
              APPEND SHORT " " LONG
              TRIM SHORT            TO SHORT
               GOSUB CENTER
              PRINT LONG               TO REVHEADER.4
               MOVE Scrbal.1 TO FIELDINDEX
              PRINT REF.DISTRICT       TO REVHEADER.5
               MOVE RPTMAST.DP TO DIVISION.CODE
              FIND EQ DIVISION BY INDEX.1
              PRINT DIVISION.CODE      TO REVHEADER.6
              PRINT DIVISION.DESC      TO REVHEADER.7
              PRINT MONTHS.MONTH&      TO REVHEADER.8
              [PRT] OUTPUT REVHEADER
         END

         IF RPTMAST.CT  MATCH "GH" BEGIN
              PRINT RPTMAST.ALTDESC TO REVSUBHEADER1.1
              OUTPUT REVSUBHEADER1
         END

         IF RPTMAST.CT MATCH "AC" BEGIN
              MOVE Scrbal.1 TO FIELDINDEX
              MOVE (LEDGER.CD&+ACCUM5) TO ACCUM5
              GOSUB DO_COUNT
              MOVE (ANSWER+ACCUM6)     TO ACCUM6
         END

         IF RPTMAST.CT  MATCH "BL" BEGIN
              OUTPUT REVBLANKLINE
         END

         IF RPTMAST.CT  MATCH "PA" BEGIN
              PRINT RPTMAST.GL                        TO REVBODY.1
              PRINT RPTMAST.ALTDESC                   TO REVBODY.2
              if rptmast.seq gt 220 ;
              PRINT (ACCUM5*RPTMAST.SC)               TO REVBODY.3 
              PRINT (ACCUM6*RPTMAST.SC)               TO REVBODY.4
              MOVE (ACCUM7+ACCUM5) TO ACCUM7
              MOVE (ACCUM8+ACCUM6) TO ACCUM8
              MOVE (0.00)          TO ACCUM5
              [OKA] INDICATE OK AS ACCUM6 NE (0)
              MOVE (0.00)          TO ACCUM6
              [OK] OUTPUT REVBODY
         END



         IF RPTMAST.CT  MATCH "PX" BEGIN
              PRINT RPTMAST.GL                        TO REVBODY2.1
              PRINT RPTMAST.ALTDESC                   TO REVBODY2.2
              PRINT (ACCUM6*RPTMAST.SC)               TO REVBODY2.3
              MOVE (ACCUM7+ACCUM5) TO ACCUM7
              MOVE (ACCUM8+ACCUM6) TO ACCUM8
              MOVE (0.00)          TO ACCUM5
              [OKA] INDICATE OK AS ACCUM6 NE (0)
              MOVE (0.00)          TO ACCUM6
              [OK] OUTPUT REVBODY2
         END


         IF RPTMAST.CT  MATCH "AA" gosub set_5_8

         IF RPTMAST.CT  MATCH "ST" BEGIN
              PRINT ''                             TO REVBODY.1
              PRINT RPTMAST.ALTDESC                TO REVBODY.2
              PRINT (ACCUM7*RPTMAST.SC)            TO REVBODY.3  
              PRINT (ACCUM8*RPTMAST.SC)            TO REVBODY.4
              OUTPUT REVBODY
              gosub set_7_10
         END

         IF RPTMAST.CT  MATCH "SX" BEGIN
              PRINT ''                             TO REVBODY2.1
              PRINT RPTMAST.ALTDESC                TO REVBODY2.2
              PRINT (ACCUM8*RPTMAST.SC)            TO REVBODY2.3
              OUTPUT REVBODY2
              gosub set_7_10
         END



  
         IF RPTMAST.CT  MATCH "AS" gosub set_7_10
  
         IF RPTMAST.CT  MATCH "TT" BEGIN
              PRINT ''                                TO REVBODY.1
              PRINT RPTMAST.ALTDESC                   TO REVBODY.2
              PRINT (ACCUM9*RPTMAST.SC)               TO REVBODY.3  
              PRINT (ACCUM10*RPTMAST.SC)              TO REVBODY.4
              OUTPUT REVBODY
              gosub set_9_12
         END
  
         IF RPTMAST.CT  MATCH "GT" BEGIN
              PRINT ''                                TO REVBODY.1
              PRINT RPTMAST.ALTDESC                   TO REVBODY.2
              PRINT (ACCUM11*RPTMAST.SC)              TO REVBODY.3  
              PRINT (ACCUM12*RPTMAST.SC)              TO REVBODY.4
              OUTPUT REVBODY
              gosub set_11_14
         END
  
         IF RPTMAST.CT  MATCH "AG" gosub set_11_14
  
         IF RPTMAST.CT  MATCH "AT" gosub set_9_12

         IF RPTMAST.CT  MATCH "GI" gosub set_1_6

         IF RPTMAST.CT  MATCH "NI" BEGIN
              PRINT RPTMAST.GL                                  TO REVBODY.1
              IF RPTMAST.USEALT MATCH "Y" PRINT RPTMAST.ALTDESC TO REVBODY.2
              IF RPTMAST.USEALT MATCH "N" PRINT LEDGER.DESC     TO REVBODY.2
              PRINT (ACCUM13*RPTMAST.SC)                        TO REVBODY.3  
              PRINT (ACCUM14*RPTMAST.SC)                        TO REVBODY.4
              OUTPUT REVBODY
              IF STATUS LEDGER BEGIN
                    reread ledger
                        MOVE (Scrbal.1 - 1) TO FIELDINDEX
                        MOVE ACCUM13 TO LEDGER.TYJAN&
                        MOVE (0) TO LEDGER.TYTOTAL
                        FOR FIELDINDEX FROM (0) TO (12)
                             MOVE (LEDGER.TYJAN& + LEDGER.TYTOTAL) TO LEDGER.TYTOTAL
                        LOOP
                        SAVERECORD LEDGER
                    unlock
              END
         END       
  
         IF RPTMAST.CT  MATCH "PC" BEGIN
              FOR COUNT FROM LINECOUNT TO (60)
                   OUTPUT REVBLANKLINE
              LOOP
              PRINT ref.prosecutor TO REVCOMMENT.1
              OUTPUT REVCOMMENT
         END
  
         IF RPTMAST.CT  MATCH "PD" BEGIN
              IF rptmast.seq gt 155 IF rptmast.REPORT EQ (20)  OUTPUT REVDASHES
              if rptmast.seq gt 480 if rptmast.REPORT eq (01)  output revdashes
              IF rptmast.seq le 155 IF rptmast.REPORT EQ (20)  OUTPUT REVDASHES2
              if rptmast.seq le 480 if rptmast.REPORT eq (01)  output revdashes2
         end
         IF RPTMAST.CT  MATCH "PE" BEGIN
        [PRT] if rptmast.seq gt 165 if rptmast.REPORT eq (20) OUTPUT REVEQUALS
              if rptmast.seq gt 480 if rptmast.REPORT eq (01) output revequals

              if rptmast.seq le 165 if rptmast.REPORT eq (20) OUTPUT REVEQUALS2
              if rptmast.seq le 480 if rptmast.REPORT eq (01) output revequals2
         END    

         IF RPTMAST.CT  MATCH "PN" BEGIN
             PRINT RPTMAST.GL                                   TO REVBODY.1
              IF RPTMAST.USEALT MATCH "Y" PRINT RPTMAST.ALTDESC TO REVBODY.2
              IF RPTMAST.USEALT MATCH "N" PRINT LEDGER.DESC     TO REVBODY.2
               MOVE Scrbal.1 TO FIELDINDEX

              PRINT (LEDGER.CD&*RPTMAST.SC)                     TO REVBODY.3

               MOVE (LEDGER.CD&+ACCUM7) TO ACCUM7
               GOSUB DO_TODATE_COUNT
              PRINT (ANSWER*RPTMAST.SC)                         TO REVBODY.4
               MOVE (ANSWER+ACCUM8)    TO ACCUM8
              [OKA] INDICATE OK AS ANSWER NE (0)
              [OK] OUTPUT REVBODY
         END

          if rptmast.ct match "P2" begin
             print rptmast.gl                                   to revbody2.1
             if rptmast.usealt match "Y" print rptmast.altdesc  to revbody2.2
             if rptmast.usealt match "N" print rptmast.altdesc  to revbody2.2
                move scrbal.1 to fieldindex
                  move (ledger.cd&+accum7) to accum7
                  gosub do_count
              PRINT (ANSWER*RPTMAST.SC)                         TO REVBODY2.3
               MOVE (ANSWER+ACCUM8)    TO ACCUM8
              [OKA] INDICATE OK AS ANSWER NE (0)
              [OK] OUTPUT REVBODY2
          end


         IF RPTMAST.CT  MATCH "CL" GOSUB CLEAR_ACCUMALATORS

         [PRT][~ multiuser] IF RPTMAST.CT MATCH "NP" FORMFEED

         IF RPTMAST.CT MATCH "RE" GOTO END_OF_REV_REPORT

         KEYCHECK BEGIN
           START_CHK:
              gosub key_prss
              IF ANSW EQ 'Y' BEGIN
                   CLEAR LEDGER RPTMAST
                   CLEARFORM Scrbal
                   OUTPUT OPABORT
                   [PRT][MULTIUSER] gosub ff_DESPOOL
                   GOTO QUIT_REV_SCR
              END
         END
         CLEARXY 24 0

         FIND GT RPTMAST BY INDEX.1
    [found] indicate found as scrbal.4 eq rptmast.report
    [FOUND] LOOP
    [FINDERR] [~ prt] INKEY ANSW
    [prt] formfeed

  END_OF_REV_REPORT:
  [PRT] gosub ff_DESPOOL
    GOTO QUIT_REV_SCR

  DO_COUNT: MOVE (-1) TO COUNT 
    MOVE LEDGER.TYBEG TO ANSWER
    REPEAT
         INCREMENT COUNT
         MOVE COUNT     TO FIELDINDEX
         MOVE REF.PER1& TO FIELDINDEX
         CALC (ANSWER+LEDGER.CD&) TO ANSWER
         MOVE COUNT TO FIELDINDEX
    UNTIL REF.PER1& EQ Scrbal.1
    RETURN
	
  DO_TODATE_COUNT: MOVE (-1) TO COUNT 
    MOVE 0 TO ANSWER
    REPEAT
         INCREMENT COUNT
         MOVE COUNT     TO FIELDINDEX
         MOVE REF.PER1& TO FIELDINDEX
         CALC (ANSWER+LEDGER.CD&) TO ANSWER
         MOVE COUNT TO FIELDINDEX
    UNTIL REF.PER1& EQ Scrbal.1
    RETURN
  
  QUIT_REV_SCR:
    INDICATE REV_SCR FALSE
  RETURN    //for  (print_revenue:)
//--------------end option 12----------------


//********< Print Revenue 2 Statement >********************************* 13 ***

PRINT_REVENUE2:
    INDICATE REV2_SCR TRUE
    INDICATE STOP_PRINT FALSE
    CLEAR LEDGER RPTMAST
    MOVE 0 TO COUNT
         FORMAT SCRREV2.1        {RANGE=1,12}
         FORMAT SCRREV2.2        {RANGE=1,12}
         FORMAT SCRREV2.5        {RANGE=1,99}
         FORMAT REV2BODY.2       {SIGNRT}
         FORMAT REV2BODY.3       {SIGNRT}
         FORMAT REV2BODY.4       {SIGNRT}
         FORMAT REV2BODY.5       {SIGNRT}
         FORMAT SCRREV2.6   {CAPSLOCK,CHECK="YN"}
         FORMAT SCRREV2.7   {CAPSLOCK,CHECK="CPA"}
    PAGE SCRREV2

  START_REVSCR2:
     MOVE 1 TO SCRREV2.1
    ACCEPT SCRREV2.1
     MOVE 12 TO SCRREV2.2
    ACCEPT SCRREV2.2
     DISPLAY "Revenue Statement" TO SCRREV2.3
    ACCEPT SCRREV2.3
    ACCEPT SCRREV2.4
     MOVE 1 TO SCRREV2.5
    ACCEPT SCRREV2.5 TO RPTMAST.REPORT
     DISPLAY "Y" TO SCRREV2.6
    ACCEPT SCRREV2.6
     DISPLAY "C" TO SCRREV2.7
    ACCEPT SCRREV2.7
     IF ~ SCRREV2.7 IN "PCA" goto START_REVSCR2
    INDICATE OKA AS SCRREV2.6 MATCH "N"

    move SCRREV2.7 to out_dest
    gosub output_dest
    IF out_dest EQ 'P' PAGE PRINTSCR
    [STOP_PRINT] GOTO QUIT_REV2_SCR

    FIND GE RPTMAST BY INDEX.1
    [FINDERR] GOTO QUIT_REV2_SCR
    [FOUND] REPEAT
         RELATE RPTMAST
         INDICATE OK TRUE

         IF RPTMAST.CT  MATCH "PH" BEGIN
              TRIM REF.PROSECUTOR TO SHORT
               GOSUB CENTER
              PRINT LONG          TO REV2HEADER.1
              TRIM REF.ADDRESS                   TO SHORT
               GOSUB CENTER
              PRINT LONG          TO REV2HEADER.2
              TRIM REF.CITY_STATE                TO SHORT
               GOSUB CENTER
              PRINT LONG          TO REV2HEADER.3
              LENGTH SCRREV2.3 TO ANSWER
              MOVE RPTMAST.ALTDESC               TO SHORT
              IF ANSWER GT (0) MOVE SCRREV2.3    TO SHORT
              TRIM SHORT                         TO SHORT
              TRIM SCRREV2.4 TO LONG
              APPEND SHORT " " LONG
              TRIM SHORT                         TO SHORT
               GOSUB CENTER
              PRINT LONG          TO REV2HEADER.4
              MOVE SCRREV2.1 TO FIELDINDEX
              PRINT MONTHS.MONTH& TO REV2HEADER.5
              MOVE SCRREV2.2 TO FIELDINDEX
              PRINT MONTHS.MONTH& TO REV2HEADER.6
              OUTPUT REV2HEADER
         END

         IF RPTMAST.CT  MATCH "AH" BEGIN
              TRIM REF.PROSECUTOR             TO SHORT
               GOSUB CENTER
              PRINT LONG          TO REV2HEADER.1
              TRIM REF.ADDRESS                TO SHORT
               GOSUB CENTER
              PRINT LONG          TO REV2HEADER.2
              TRIM REF.CITY_STATE             TO SHORT
               GOSUB CENTER
              PRINT LONG          TO REV2HEADER.3
              LENGTH SCRREV2.3 TO ANSWER
              MOVE RPTMAST.ALTDESC            TO SHORT
              IF ANSWER GT (0) MOVE SCRREV2.3 TO SHORT
              TRIM SHORT                      TO SHORT
              TRIM SCRREV2.4 TO LONG
              APPEND SHORT " " LONG
              TRIM SHORT                      TO SHORT
               GOSUB CENTER
              PRINT LONG          TO REV2HEADER.4
               MOVE SCRREV2.1 TO FIELDINDEX
              PRINT MONTHS.MONTH& TO REV2HEADER.5
               MOVE SCRREV2.2 TO FIELDINDEX
              PRINT MONTHS.MONTH& TO REV2HEADER.6
              OUTPUT REV2HEADER
         END

         IF RPTMAST.CT  MATCH "GH" BEGIN
              PRINT RPTMAST.ALTDESC TO REV2SUBHEADER1.1
              OUTPUT REV2SUBHEADER1
         END

         IF RPTMAST.CT MATCH "AC" BEGIN
              GOSUB COUNT_REV2
              MOVE (PERIOD+ACCUM5) TO ACCUM5
              GOSUB COUNT_REV1
              MOVE (ANSWER+ACCUM6) TO ACCUM6
         END

         IF RPTMAST.CT  MATCH "BL" OUTPUT REV2BLANKLINE

         IF RPTMAST.CT  MATCH "PA" BEGIN
              PRINT RPTMAST.ALTDESC                TO REV2BODY.1
              PRINT (ACCUM5*RPTMAST.SC)            TO REV2BODY.2
              PRINT (ACCUM6*RPTMAST.SC)            TO REV2BODY.4
              PRINT (ACCUM5/ACCUM1*100*RPTMAST.SC) TO REV2BODY.3
              PRINT (ACCUM6/ACCUM2*100*RPTMAST.SC) TO REV2BODY.5
              MOVE (ACCUM7+ACCUM5) TO ACCUM7
              MOVE (ACCUM8+ACCUM6) TO ACCUM8
              MOVE (0.00)          TO ACCUM5
              [OKA] INDICATE OK AS ACCUM6 NE (0)
              MOVE (0.00)          TO ACCUM6
              [OK] OUTPUT REV2BODY
         END

         IF RPTMAST.CT  MATCH "AA" gosub set_5_8

         IF RPTMAST.CT  MATCH "ST" BEGIN
              PRINT RPTMAST.ALTDESC                   TO REV2BODY.1
              PRINT (ACCUM7*RPTMAST.SC)               TO REV2BODY.2
              PRINT (ACCUM7/ACCUM1*100*RPTMAST.SC)    TO REV2BODY.3
              PRINT (ACCUM8*RPTMAST.SC)               TO REV2BODY.4
              PRINT (ACCUM8/ACCUM2*100*RPTMAST.SC)    TO REV2BODY.5
              OUTPUT REV2BODY
              gosub set_7_10
         END

         IF RPTMAST.CT  MATCH "AS" gosub set_7_10

         IF RPTMAST.CT  MATCH "TT" BEGIN
              PRINT RPTMAST.ALTDESC                   TO REV2BODY.1
              PRINT (ACCUM9*RPTMAST.SC)               TO REV2BODY.2
              PRINT (ACCUM9/ACCUM1*100*RPTMAST.SC)    TO REV2BODY.3
              PRINT (ACCUM10*RPTMAST.SC)              TO REV2BODY.4
              PRINT (ACCUM10/ACCUM2*100*RPTMAST.SC)   TO REV2BODY.5
              OUTPUT REV2BODY
              gosub set_9_12
         END

         IF RPTMAST.CT  MATCH "GT" BEGIN
              PRINT RPTMAST.ALTDESC                   TO REV2BODY.1
              PRINT (ACCUM11*RPTMAST.SC)              TO REV2BODY.2
              PRINT (ACCUM11/ACCUM1*100*RPTMAST.SC)   TO REV2BODY.3
              PRINT (ACCUM12*RPTMAST.SC)              TO REV2BODY.4
              PRINT (ACCUM12/ACCUM2*100*RPTMAST.SC)   TO REV2BODY.5
              OUTPUT REV2BODY
              gosub set_11_14
         END

         IF RPTMAST.CT  MATCH "AG" gosub set_11_14

         IF RPTMAST.CT  MATCH "AT" gosub set_9_12

         IF RPTMAST.CT  MATCH "GI" gosub set_1_6

         IF RPTMAST.CT  MATCH "NI" BEGIN
              IF RPTMAST.USEALT MATCH "Y" PRINT RPTMAST.ALTDESC TO REV2BODY.1
              IF RPTMAST.USEALT MATCH "N" PRINT LEDGER.DESC     TO REV2BODY.1
              PRINT (ACCUM13*RPTMAST.SC)                        TO REV2BODY.2
              PRINT (ACCUM13/ACCUM1*100*RPTMAST.SC)             TO REV2BODY.3
              PRINT (ACCUM14*RPTMAST.SC)                        TO REV2BODY.4
              PRINT (ACCUM14/ACCUM2*100*RPTMAST.SC)             TO REV2BODY.5
              OUTPUT REV2BODY
         END       

         IF RPTMAST.CT  MATCH "PC" BEGIN
              FOR COUNT FROM LINECOUNT TO (60)
              OUTPUT REV2BLANKLINE
         LOOP
              PRINT REF.PROSECUTOR TO REV2COMMENT.1
              OUTPUT REV2COMMENT
         END

         IF RPTMAST.CT  MATCH "PD" OUTPUT REV2DASHES

         IF RPTMAST.CT  MATCH "PE" OUTPUT REV2EQUALS

         IF RPTMAST.CT  MATCH "PN" BEGIN
              IF RPTMAST.USEALT MATCH "Y" PRINT RPTMAST.ALTDESC TO REV2BODY.1
              IF RPTMAST.USEALT MATCH "N" PRINT LEDGER.DESC     TO REV2BODY.1
               GOSUB COUNT_REV2
              PRINT (PERIOD*RPTMAST.SC)                         TO REV2BODY.2
               MOVE (PERIOD+ACCUM7)    TO ACCUM7
              PRINT (PERIOD/ACCUM1*100*RPTMAST.SC)              TO REV2BODY.3
               GOSUB COUNT_REV1
              PRINT (ANSWER*RPTMAST.SC)                         TO REV2BODY.4
              PRINT (ANSWER/ACCUM2*100*RPTMAST.SC)              TO REV2BODY.5
               MOVE (ANSWER+ACCUM8)    TO ACCUM8
              [OKA] INDICATE OK AS ANSWER NE (0)
              [OK] OUTPUT REV2BODY
         END

         IF RPTMAST.CT  MATCH "CL" GOSUB CLEAR_ACCUMALATORS

         IF RPTMAST.CT MATCH "NP" FORMFEED

         IF RPTMAST.CT MATCH "RE" GOTO END_OF_REV2_REPORT

         KEYCHECK BEGIN
  START_CHK2:
              GOSUB KEY_PRSS
              IF ANSW EQ 'Y' BEGIN
                   CLEAR LEDGER RPTMAST
                   CLEARFORM SCRREV2
                   OUTPUT OPABORT
                   GOSUB FF_DESPOOL
                   GOTO QUIT_REV2_SCR
              END
         END

         FIND GT RPTMAST BY INDEX.1
    [FOUND] LOOP

  END_OF_REV2_REPORT:
    GOSUB FF_DESPOOL
    GOTO QUIT_REV2_SCR

  COUNT_REV1:
    MOVE (-1) TO COUNT
    MOVE (0.00) TO ANSWER
    REPEAT
         INCREMENT COUNT
         MOVE COUNT     TO FIELDINDEX
         MOVE REF.PER1& TO FIELDINDEX
         CALC (ANSWER+LEDGER.CD&) TO ANSWER
         MOVE COUNT TO FIELDINDEX
    UNTIL REF.PER1& EQ SCRREV2.2
  RETURN

  COUNT_REV2:
    MOVE (-1) TO COUNT
    MOVE (0.00) TO PERIOD
    REPEAT 
         INCREMENT COUNT
         MOVE COUNT TO FIELDINDEX
    UNTIL REF.PER1& EQ SCRREV2.1
    MOVE (COUNT-1) TO COUNT
    REPEAT
         INCREMENT COUNT
         MOVE COUNT     TO FIELDINDEX
         MOVE REF.PER1& TO FIELDINDEX
         CALC (LEDGER.CD&+PERIOD) TO PERIOD
         MOVE COUNT     TO FIELDINDEX
    UNTIL REF.PER1& EQ SCRREV2.2
  RETURN

  QUIT_REV2_SCR:
    INDICATE REV2_SCR FALSE

  RETURN     // RETURN FOR PRINT_REVENUE2
//---------------end option 14--------------------------


// ***** Print Account Balances **************************************** 17 ***

  QUICK_BALANCE:
    INDICATE QIK_SCR TRUE
    INDICATE STOP_PRINT FALSE
    CLEAR LEDGER
         FORMAT SCRQIK.1    {CAPSLOCK}
         FORMAT SCRQIK.2    {CAPSLOCK}
         FORMAT QIKBODY.5   {SIGNRT}
         FORMAT QIKTOTAL.1  {SIGNRT}
         FORMAT SCRQIK.3    {CAPSLOCK,CHECK="PCA"}
    PAGE SCRQIK
  START_QIKSCR:
    [NOT DIV] MOVE (0) TO SCRQIK.2

    MOVE REF.DISTRICT  TO SCRQIK.1
    [DIV] ACCEPT SCRQIK.2

    ACCEPT SCRQIK.3
    move scrqik.3 to out_dest
    gosub output_dest
//    [prt] Direct_Output "AcntBal.txt"

    IF SCRQIK.3 EQ 'P' PAGE SHOWQIK

    [STOP_PRINT] BEGIN
         gosub ff_despool 
         GOTO QUIT_QIK_SCR
    END
 
    MOVE 0 TO LEDGER.NUMBER
    MOVE REF.DISTRICT TO LEDGER.DISTRICT
    MOVE SCRQIK.2 TO LEDGER.DIVISION

    FIND GE LEDGER BY INDEX.1
    [FINDERR] GOTO QUIT_QIK_SCR
    INDICATE FIRST TRUE
    REPEAT
         INDICATE SELECT TRUE
         IFNOT "A" IN SCRQIK.2 INDICATE SELECT AS LEDGER.DIVISION EQ SCRQIK.2
         [NOT SELECT] GOTO DO_QIK_AGAIN   
         [FIRST] GOSUB DO_QIK_HEADER
         PAGECHECK 4
         [PAGEBREAK] GOSUB DO_QIK_HEADER
         DISPLAY LEDGER.NUMBER    TO SHOWQIK.1
         DISPLAY LEDGER.DESC      TO SHOWQIK.2
         PRINT LEDGER.NUMBER      TO QIKBODY.1
         PRINT LEDGER.DISTRICT    TO QIKBODY.2
         PRINT LEDGER.DIVISION    TO QIKBODY.3
         PRINT LEDGER.DESC        TO QIKBODY.4
         REREAD Ledger
              MOVE (0) TO LEDGER.TYTOTAL
              FOR FIELDINDEX FROM 0 TO 12
                   MOVE (LEDGER.TYJAN& + LEDGER.TYTOTAL) TO LEDGER.TYTOTAL
  DO_SELECT_AGAIN:
              LOOP
              IF LEDGER.NUMBER NE REF.TYRETAINED PRINT LEDGER.TYTOTAL TO ;
                                                                     QIKBODY.5
              IF LEDGER.NUMBER EQ REF.TYRETAINED PRINT LEDGER.TYBEG TO ;
                                                                     QIKBODY.5
              OUTPUT QIKBODY
              SAVERECORD LEDGER
          UNLOCK
         INDICATE FIRST FALSE
         KEYCHECK BEGIN
  CHK_QIK:
              gosub key_prss
              IF ANSW EQ 'Y' BEGIN
                   CLEARXY 24 0
                   CLEAR LEDGER
                   CLEARFORM SCRQIK
                   OUTPUT OPABORT
                   gosub ff_despool 
                   GOTO QUIT_QIK_SCR
              END
         END

  DO_QIK_AGAIN:
         FIND GT LEDGER BY INDEX.1
    [FOUND] LOOP

  END_QIK_REPORT:
    GOSUB DO_QIK_TOTAL
    gosub ff_despool
//    CopyFile "\dataflex\acntbal.txt" to "LPT1:"
    GOTO QUIT_QIK_SCR

DO_QIK_HEADER:
    PAGECHECK 6
    [PAGEBREAK] 
    PRINT REF.PROSECUTOR  TO QIKHEADER.1
    PRINT PAGECOUNT       TO QIKHEADER.2
    OUTPUT QIKHEADER
  RETURN

  DO_QIK_TOTAL:
    PAGECHECK 6
    [PAGEBREAK] GOSUB DO_QIK_HEADER
    SUBTOTAL QIKBODY.5 TO QIKTOTAL.1
    OUTPUT QIKTOTAL
  RETURN

  QUIT_QIK_SCR:
    INDICATE QIK_SCR FALSE
    CLEARFORM SCRQIK
  RETURN   //for (quick_balance:)
//---------------end option 17---------------------


//*******< General Ledger Division Master >***************************** 18 ***

  MASTER_DIV:
    IF USER$_ACCESS LT 90 RETURN
    INDICATE DIV_SCR TRUE
    ENTERGROUP
  TOP_DIV:
         AUTOPAGE SCRDIV
         ENTRY DIVISION.CODE             SCRDIV.1     {CAPSLOCK,AUTOFIND}
         INDICATE NEWREC TRUE
         [FOUND] INDICATE NEWREC FALSE
         ENTRY DIVISION.DESC             SCRDIV.2     {CAPSLOCK}
         ENTRY DIVISION.A_P_ACCOUNT      SCRDIV.3 
         ENTRY DIVISION.A_R_ACCOUNT      SCRDIV.4
         ENTRY DIVISION.BANK_CODE        SCRDIV.5     {CAPSLOCK}
         ENTRY DIVISION.TYPE             SCRDIV.6     {CAPSLOCK}
         [NEWREC] MOVE 0 TO SCRDIV.7
         ENTRY DIVISION.ACCOUNTS         SCRDIV.7     {NOENTER}
  SAVE_DIV_QUES:
         gosub sav_rec
         IF ANSW IN 'Y' GOTO SAVE_DIV_DOIT
         IF NOT ANSW IN 'Y' BEGIN
              CLEAR DIVISION
              CLEARFORM
              GOTO MASTER_DIV
         END
  SAVE_DIV_DOIT:

         [multiuser] REREAD
    ENDGROUP
         INDICATE NEWREC FALSE
         SAVE DIVISION
    [multiuser] UNLOCK
    CLEAR DIVISION
    CLEARFORM
    GOTO TOP_DIV  
  QUIT_DIV_SCR:
    INDICATE DIV_SCR FALSE
    CLEARFORM 
    CLEAR DIVISION
  RETURN   // for (master_div:)
//------------------end option 18-----------------


//*******< Replicate General Ledger Accounts >************************** 21 ***

  REP_ACCOUNTS:
    IF USER$_ACCESS LT 90 RETURN
    BLANKFORM SCRREP
    INDICATE REP_SCR TRUE
    MOVE '' TO CHECK_DIV
         FORMAT SCRREP.1         {REQUIRED}
         FORMAT SCRREP.2         {REQUIRED}
         FORMAT SCRREP.3         {NOENTER}
         FORMAT SCRREP.4         {CAPSLOCK,REQUIRED}
         FORMAT SCRREP.5         {NOENTER}
         FORMAT SCRREP.6         {CAPSLOCK,REQUIRED}
    //direct_output "LEDGER.REP"
    PAGE SCRREP

  START_REP:              
    ACCEPT SCRREP.1
    ACCEPT SCRREP.2
     MOVE REF.DISTRICT TO SCRREP.3
    ACCEPT SCRREP.3
  DO_1:
    ACCEPT SCRREP.4
     INDICATE FIRST TRUE
     MOVE SCRREP.4 TO CHECK_DIV
     GOSUB VALID_DIV
     MOVE '' TO CHECK_DIV
     INDICATE FIRST FALSE
     MOVE REF.DISTRICT TO SCRREP.5
    ACCEPT SCRREP.5
  DO_2:
    ACCEPT SCRREP.6
     MOVE SCRREP.6 TO CHECK_DIV
     GOSUB VALID_DIV
     MOVE '' TO CHECK_DIV
    MOVE 0 TO PAGEEND

    CLEAR LEDGER
    MOVE SCRREP.1 TO LEDGER.NUMBER
    FIND GE LEDGER BY INDEX.1
    [FINDERR] GOTO QUIT_REP

  TOP_REP_OUTPUT:
    PAGE SCRREP2
    REPEAT
         INDICATE BUSY TRUE
         INDICATE SELECT AS LEDGER.NUMBER GE SCRREP.1
         [SELECT] INDICATE SELECT AS LEDGER.NUMBER LE SCRREP.2
         [NOT SELECT] GOTO DO_REP_AGAIN     
         [SELECT] INDICATE SELECT AS LEDGER.DISTRICT EQ SCRREP.3
         [SELECT] INDICATE SELECT AS LEDGER.DIVISION EQ SCRREP.4
         [NOT SELECT] GOTO DO_REP_AGAIN

         PRINT LEDGER.NUMBER         TO REPBODY.1
         PRINT SCRREP.5              TO REPBODY.2
         PRINT SCRREP.6              TO REPBODY.3
         PRINT LEDGER.DESC           TO REPBODY.4
         PRINT LEDGER.BR             TO REPBODY.5
         DISPLAY LEDGER.NUMBER       TO SCRREP2.1
         DISPLAY LEDGER.DISTRICT     TO SCRREP2.2
         DISPLAY LEDGER.DIVISION     TO SCRREP2.3
         DISPLAY LEDGER.BR           TO SCRREP2.4
         DISPLAY LEDGER.DESC         TO SCRREP2.5
         OUTPUT REPBODY

  DO_REP_AGAIN:
         FIND GT LEDGER BY INDEX.1
         [FINDERR] GOTO END_REP_OUTPUT
    [FOUND]  LOOP

  END_REP_OUTPUT:
    INDICATE BUSY FALSE
    BLANKFORM SCRREP2.1 THRU SCRREP2.5
    OUTCLOSE
    DIRECT_INPUT "LEDGER.REP"
    [SEQEOF] ERROR 75 "LEDGER.REP"
    [SEQEOF] GOTO QUIT_REP
    DISPLAY SCRREP.6 TO SCRREP2.6
    CLEAR DIVISION
    MOVE SCRREP.6 TO DIVISION.CODE
    FIND EQ DIVISION BY INDEX.1
    REPEAT
         CLEAR LEDGER
         READLN LEDGER.NUMBER
         READLN LEDGER.DISTRICT
         READLN LEDGER.DIVISION
         READLN LEDGER.DESC
         READLN LEDGER.BR
         FOR COUNT FROM 0 TO 41
              MOVE COUNT TO FIELDINDEX
              MOVE (0) TO LEDGER.TYJAN&
         LOOP
         SAVERECORD LEDGER   
         DISPLAY LEDGER.NUMBER    TO SCRREP2.7
         DISPLAY LEDGER.DISTRICT  TO SCRREP2.8
         DISPLAY LEDGER.DIVISION  TO SCRREP2.9
         DISPLAY LEDGER.BR        TO SCRREP2.10
         DISPLAY LEDGER.DESC      TO SCRREP2.11
         [NOT SEQEOF] MOVE (DIVISION.ACCOUNTS + 1) TO DIVISION.ACCOUNTS
    [NOT SEQEOF] LOOP
    [SEQEOF] BLANKFORM SCRREP2
    IF STATUS DIVISION SAVERECORD DIVISION

  REPEAT_REF:
    GOTOXY 24 0
    SHOW " Do You Want To Duplicate More Accounts? Y/N"
    INKEY ANSW
    UPPERCASE ANSW
    IF ~ ANSW IN 'YN' GOTO REPEAT_REF
     CLEARXY 24 0
     CLEARFORM
     CLEAR LEDGER DIVISION
    IF ANSW EQ 'Y' RETURN REP_ACCOUNTS
    IF ANSW EQ 'N' GOTO QUIT_REP
  RETURN

  VALID_DIV:
    INDICATE BUSY TRUE
    CLEAR DIVISION
    MOVE CHECK_DIV TO DIVISION.CODE
    FIND EQ DIVISION BY INDEX.1
    [FINDERR] BEGIN
         gosub err_msg_124
         INDICATE BUSY FALSE
         [FIRST] BEGIN
              MOVE '' TO CHECK_DIV
              CLEARFORM SCRREP.4
              RETURN DO_1
         END
         [~ FIRST] BEGIN
              CLEARFORM SCRREP.6
              RETURN DO_2
         END
    END
    CLEAR DIVISION
    RETURN

  QUIT_REP:
    CLEARFORM SCRREP
    BLANKFORM SCRREP2
    INDICATE REP_SCR FALSE
  RETURN
//---------------end option 21---------------


// GLUPDATE *********************************************************** 23 ***

  JOURNAL_UPDATE:

//    direct_output "lpt1:"
    INDICATE UPDATE_SCR TRUE
         FORMAT SCRUPDATE.1 {CAPSLOCK,CHECK="CA"}
    PAGE SCRUPDATE
    ACCEPT SCRUPDATE.1
    IF SCRUPDATE.1 MATCH "A" GOTO QUIT_JOURNAL_UPDATE

    CLEARSCREEN
    GOTOXY 12 9
    SHOWLN 'THIS PROGRAM CAN NOT BE STOPPED WITH OUT REBOOTING COMPUTER.'

REPEAT
  SKIPX:
              FIND GT LEDGER BY INDEX.1
              [FINDERR] GOTO QUIT_JOURNAL_UPDATE
              IF LEDGER.NUMBER EQ REF.TYRETAINED GOTO SKIPX
              SHOWLN "Updating    " LEDGER.NUMBER "-" LEDGER.DISTRICT "-" ;
                                                                LEDGER.DIVISION
              
              reread ledger
              FOR FIELDINDEX FROM 0 TO 11
                   MOVE (0) TO LEDGER.TYJAN&
              
              LOOP
                 MOVE (0) TO LEDGER.TYTOTAL
                 CLEAR JOURNALS
                 MOVE LEDGER.OVERLAP TO JOURNALS.DIST_DIV
              
              REPEAT
                   FIND GT JOURNALS BY INDEX.2
                   [FINDERR] WRITELN "NOT FOUND"
                   [FINDERR] GOTO THEEND
                   
        
                   IF LEDGER.OVERLAP NE JOURNALS.DIST_DIV GOTO THEEND
                   MOVE (JOURNALS.MN - 1) TO FIELDINDEX
                   MOVE (LEDGER.TYJAN& + JOURNALS.AMOUNT) TO LEDGER.TYJAN&
              
              LOOP
              move (0) to fieldindex
  THEEND:
             FOR FIELDINDEX FROM 0 TO 12
                   MOVE (LEDGER.TYTOTAL + LEDGER.TYJAN&) TO LEDGER.TYTOTAL
              
             
             LOOP
                   SAVERECORD LEDGER
                   unlock
LOOP

    KEYCHECK GOTO QUIT_JOURNAL_UPDATE
   
  QUIT_JOURNAL_UPDATE:
    
    clear ledger journals
    INDICATE UPDATE_SCR FALSE
  RETURN     // for (journal_update:)
//---------------end option 23--------------


//********< Process Year End >****************************************** 24 ***

  PROCESS_YREND:

    INDICATE YREND_SCR TRUE
    PAGE YRENDWARN
    DISPLAY 'N' TO YRENDWARN.1
    ACCEPT YRENDWARN.1       {CAPSLOCK}
    IF YRENDWARN.1 EQ 'Y' CHAIN "YREND"

  QUIT_PROCESS_YREND:
    INDICATE YREND_SCR FALSE
    CLEAR LEDGER JOURNALS
  RETURN     // for (process_yrend:)
//---------------end option 24-------------


//**********< Enter Last Year's Account Totals >************************ 26 ***

  LAST_YEAR_BAL:

    ENTERGROUP
         INDICATE LY_SCR TRUE
         INDICATE DIV AS REF.DIVISION MATCH "Y"

  TOP_LASTYR:
         ENTRY LEDGER.NUMBER                SCRLY.1 
         [NOT DIV] MOVE  ''              TO SCRLY.3
          MOVE REF.DISTRICT              TO SCRLY.2
         ENTRY LEDGER.DISTRICT              SCRLY.2   {NOENTER}
         [DIV] ENTRY LEDGER.DIVISION        SCRLY.3   {AUTOFIND}
         [NOT DIV] ENTRY LEDGER.DIVISION    SCRLY.3   {NOENTER,AUTOFIND}
         [FINDERR] BEGIN
              CLEARFORM SCRLY
              GOTO TOP_LASTYR
         END 
         ENTRY LEDGER.DESC                  SCRLY.4      {NOENTER}
  PASS_TOP_LASTYR:
         ENTRY LEDGER.LYBEG                 SCRLY.5
         ENTRY LEDGER.LYJAN                 SCRLY.6
         ENTRY LEDGER.LYFEB                 SCRLY.7
         ENTRY LEDGER.LYMAR                 SCRLY.8
         ENTRY LEDGER.LYAPR                 SCRLY.9
         ENTRY LEDGER.LYMAY                 SCRLY.10
         ENTRY LEDGER.LYJUN                 SCRLY.11
         ENTRY LEDGER.LYJUL                 SCRLY.12
         ENTRY LEDGER.LYAUG                 SCRLY.13
         ENTRY LEDGER.LYSEP                 SCRLY.14
         ENTRY LEDGER.LYOCT                 SCRLY.15
         ENTRY LEDGER.LYNOV                 SCRLY.16
         ENTRY LEDGER.LYDEC                 SCRLY.17
         MOVE (SCRLY.5+SCRLY.6+SCRLY.7+SCRLY.8+SCRLY.9+SCRLY.10+SCRLY.11+ ;
             SCRLY.12+SCRLY.13+SCRLY.14+SCRLY.15+SCRLY.16+SCRLY.17) TO SCRLY.18
  SAVE_LAST_YEAR:
         gosub sav_rec
         IF ANSW IN 'N' BEGIN 
              CLEARFORM
              CLEAR LEDGER
              GOTO LAST_YEAR_BAL
         END
         [multiuser] REREAD
              ENDGROUP
         SAVERECORD LEDGER
    [multiuser] unlock
    GOTO TOP_LASTYR    

  QUIT_LAST_YEAR_BAL:
    INDICATE LY_SCR FALSE

  RETURN     // return for (last_year_bal)
//--------------------end option 26------------------


//********< Maintain Budget Amounts >********************************** 27 ***

  MAINTAIN_BUDGET:
    INDICATE BUD_SCR TRUE

    ENTERGROUP
         AUTOPAGE SCRBUD

  START_BUDGET:
         ENTRY LEDGER.NUMBER                SCRBUD.1 
          [~ DIV] MOVE ''                TO SCRBUD.3
          MOVE REF.DISTRICT              TO SCRBUD.2
         ENTRY LEDGER.DISTRICT              SCRBUD.2        {NOENTER}
         [DIV] ENTRY LEDGER.DIVISION        SCRBUD.3        {AUTOFIND,FINDREQ}
         [NOT DIV] ENTRY LEDGER.DIVISION    SCRBUD.3        {AUTOFIND,NOENTER}
         IFNOT STATUS LEDGER GOTO START_BUDGET
         ENTRY LEDGER.DESC                  SCRBUD.4        {DISPLAYONLY}
         ENTRY LEDGER.BYTOTAL               SCRBUD.5

         FOR WINDOWINDEX FROM 0 TO 11
              MOVE (SCRBUD.5 /12)        TO SCRBUD.6&
         LOOP
         MOVE (0) TO SCRBUD.5
         FOR WINDOWINDEX FROM 0 TO 11
              MOVE (SCRBUD.6& + SCRBUD.5) TO SCRBUD.5
         LOOP

         ENTRY LEDGER.BJAN                  SCRBUD.6
         ENTRY LEDGER.BFEB                  SCRBUD.7
         ENTRY LEDGER.BMAR                  SCRBUD.8
         ENTRY LEDGER.BAPR                  SCRBUD.9
         ENTRY LEDGER.BMAY                  SCRBUD.10
         ENTRY LEDGER.BJUN                  SCRBUD.11
         ENTRY LEDGER.BJUL                  SCRBUD.12
         ENTRY LEDGER.BAUG                  SCRBUD.13
         ENTRY LEDGER.BSEP                  SCRBUD.14
         ENTRY LEDGER.BOCT                  SCRBUD.15
         ENTRY LEDGER.BNOV                  SCRBUD.16
         ENTRY LEDGER.BDEC                  SCRBUD.17
          MOVE (0) TO SCRBUD.5
         FOR WINDOWINDEX FROM 0 TO 11
              MOVE (SCRBUD.6& + SCRBUD.5) TO SCRBUD.5
         LOOP

  SAVE_BUDGET_QUES:
         GOsub sav_rec 
         IF ANSW IN 'N' BEGIN
              CLEARFORM SCRBUD
              CLEAR LEDGER
              GOTO START_BUDGET
         END
         [multiuser] REREAD
         ENDGROUP
         SAVERECORD LEDGER
    [multiuser] UNLOCK
    GOTO START_BUDGET

  QUIT_BUDGET:
    INDICATE BUD_SCR FALSE
  RETURN    // Return for (maintain_budget:)
//--------------------end option 27---------------------------


//**********< Universal Subroutines >******************************************

  NO_DELETE_MSG:
    CLEARXY 24 0
    GOTOXY 24 0
    SCREENMODE 112 ON
    SHOW ' Cannot Delete Accounts From This Screen !!!  Press <Space Bar> to continue!   '
    SCREENMODE 1 ON
    INKEY ANSW
    CLEARXY 24 0
  RETURN

  err_msg_124:
    error 124 'PRESS ANY KEY '
    INKEY ANSW
    CLEARWARNING
  RETURN

  err_msg_129:
    error 129 'END OF FILE'
    gosub time_delay
    clearwarning
  return

  CHECK_JR_ENTRIES:
    [NOTZERO] BEGIN
         ERROR 126 'PRESS ANY KEY'
         INKEY ANSW
         CLEARFORM SCRALTER.47
         CLEARWARNING
         RETURN ASK_JR_COMBINE
    END
    GOTOXY 24 0
    SHOW ' Standby Checking For Journal Entries'
    REPEAT
         FIND GT JOURNALS BY RECNUM
         [FINDERR] GOSUB JR_WARNING
         IF JOURNALS.DIST_DIV NE LEDGER.OVERLAP GOTO JR_PASS
         IF JOURNALS.DIST_DIV EQ LEDGER.OVERLAP BEGIN
              CLEARXY 24 0
              GOTOXY 24 0
              SHOW 'Cannot Delete Account / Journal Entries Found'
              GOSUB TIME_DELAY
              CLEARXY 24 0
              CLEARFORM SCRALTER.47
              RETURN ASK_JR_COMBINE
         END
  JR_PASS:
    LOOP
  END_CHECK:
  RETURN

  JR_WARNING:
    GOTOXY 24 0
    CLEARXY 24 0
    SHOW ' Are You Sure You Want To Delete This Account? (Y/N) '
    INKEY ANSW
    UPPERCASE ANSW
    IF NOT ANSW IN "YN" GOTO JR_WARNING
    IF ANSW EQ 'Y' BEGIN
         CLEAR DIVISION
         MOVE LEDGER.DIVISION TO DIVISION.CODE
         FIND EQ DIVISION BY INDEX.1
         MOVE (DIVISION.ACCOUNTS - 1) TO DIVISION.ACCOUNTS
         IF STATUS DIVISION SAVERECORD DIVISION
         DELETE LEDGER
         CLEARFORM SCRALTER
         CLEARXY 24 0
         RETURN RETURN COMBINE_ACCOUNTS
    END
    IF ANSW EQ 'N' BEGIN
         CLEARFORM SCRALTER.47
         CLEARXY 24 0
         RETURN RETURN ASK_JR_COMBINE
    END
  RETURN

  TIME_DELAY:
    MOVE 0 TO TIMER
    FOR TIMER FROM 0 TO 600
    LOOP
  RETURN

  output_dest:
    if out_dest match "A" begin
         gosub key_prss
         indicate stop_print false
         if answ eq 'Y' indicate stop_print true
         goto end_output_dest
    end 
    IF out_dest MATCH "P" BEGIN
         INDICATE PRT TRUE
         DIRECT_OUTPUT "LPT1:"
         //direct_output "Ledger.txt"
         MOVE 60 TO PAGEEND
         MOVE 0 TO PAGEFEED
    end
    else if out_dest match "C" begin
         INDICATE PRT FALSE
         direct_output "CON:"
         MOVE 24 TO PAGEEND
         MOVE -1 TO PAGEFEED
         CLEARSCREEN
    end
  end_output_dest:
  return

  CENTER:     LENGTH SHORT TO LCOUNT
    MOVE "" TO LONG
    MOVE (50 - LCOUNT / 2 + (.5)) TO LCOUNT
    FOR COUNT FROM 0 TO LCOUNT
         APPEND LONG " "
    LOOP
    APPEND LONG SHORT
  RETURN

  CLEAR_ACCUMALATORS:
    MOVE (0.00) TO ACCUM1
    MOVE (0.00) TO ACCUM2
    MOVE (0.00) TO ACCUM3
    MOVE (0.00) TO ACCUM4
    MOVE (0.00) TO ACCUM5
    MOVE (0.00) TO ACCUM6
    MOVE (0.00) TO ACCUM7
    MOVE (0.00) TO ACCUM8
    MOVE (0.00) TO ACCUM9
    MOVE (0.00) TO ACCUM10
    MOVE (0.00) TO ACCUM11
    MOVE (0.00) TO ACCUM12
    MOVE  0.00  TO ACCUM13
    MOVE  0.00  TO ACCUM14
RETURN

  key_prss:
    CLEARXY 24 0
    GOTOXY 24 0
    SHOW " Do You Wish To Abort? "
    repeat
         INKEY ANSW
         UPPERCASE ANSW
    if ~ answ in 'YN' loop
    clearxy 24 0
  return

  sav_rec:
    clearxy 24 0
    gotoxy 24 0
    show 'Do You Wish To Save This Record? '
    repeat
         inkey answ
         uppercase answ
    if ~ answ in 'YN' loop
    clearxy 24 0
  return

  ff_despool:
     DESPOOL
    CLEARXY 24 0
  return

  set_1_6:
    MOVE (ACCUM5*-1) TO ACCUM1
    MOVE (ACCUM6*-1) TO ACCUM2
    MOVE (0.00)      TO ACCUM5
    MOVE (0.00)      TO ACCUM6
  return

  set_5_8:
    MOVE (ACCUM7+ACCUM5) TO ACCUM7
    MOVE (ACCUM8+ACCUM6) TO ACCUM8
    MOVE (0.00)          TO ACCUM5
    MOVE (0.00)          TO ACCUM6
  return

  set_7_10:
    MOVE (ACCUM7+ACCUM9)  TO ACCUM9
    MOVE (ACCUM8+ACCUM10) TO ACCUM10
    MOVE (0.00)           TO ACCUM7
    MOVE (0.00)           TO ACCUM8
  return

  set_9_12:
    MOVE (ACCUM9+ACCUM11)  TO ACCUM11
    MOVE (ACCUM10+ACCUM12) TO ACCUM12
    MOVE (0.00)            TO ACCUM9
    MOVE (0.00)            TO ACCUM10
return

set_11_14:
    MOVE (ACCUM11+ACCUM13) TO ACCUM13
    MOVE (ACCUM12+ACCUM14) TO ACCUM14
    MOVE (0.00)            TO ACCUM11
    MOVE (0.00)            TO ACCUM12
return


//**********< Key Procedures >************************************************

//----< Key Proc  Key.Any >---------------------------------------------------

//----< Key Proc  Key.Escape >-------------------------------------------------

  KEYPROC KEY.ESCAPE
    MOVE 'Y' TO EXIT_SCREEN
    [MAST_SCR] BEGIN
         CLEAR LEDGER
         RETURN QUIT_MASTER_LEDGER
    END

    [EDIT_SCR] BEGIN
         CLEAR JOURNALS
         CLEARFORM SCREDIT
         RETURN END_EDIT_JOURNAL
    END

    [ADD_SCR] BEGIN
         RETURN QUIT_ADD_ACCOUNTS
    END

    [CHART_SCR] BEGIN
         CLEAR LEDGER
         CLEARFORM
         RETURN END_STOP_CHART
    END

    [GEN_SCR][~ GEN2_SCR] BEGIN
         [multiuser] REREAD
              IF REF.REF_NUM EQ SEQ MOVE (SEQ - 1) TO REF.REF_NUM
              SAVERECORD REF
         [multiuser] UNLOCK
         CLEAR LEDGER JOURNALS
         CLEARSCREEN
         RETURN QUIT_GENERAL_JOURNAL
    END

//    [JR_SCR] BEGIN
//         RETURN QUIT_PRINT_JOURNALS
//    END

    [LD_SCR] BEGIN
         CLEARFORM SCRLD
         CLEARSCREEN
         RETURN QUIT_LD_SCR
    END

    [SUM_SCR] BEGIN
         RETURN QUIT_SUM_SCR
    END

    [SEL_SCR] BEGIN
         RETURN QUIT_PRT_JR_SELECT
    END
    
    [REV2_SCR] BEGIN
         CLEAR LEDGER
         CLEARFORM SCRREV2
         RETURN QUIT_REV2_SCR
    END

    [COMBINE_SCREENS] BEGIN
         CLEAR LEDGER
         CLEARFORM SCRALTER
         CLEARFORM SCRALTER2
         CLEARSCREEN
         RETURN QUIT_ALTER_SCR
    END

    [BAL_SCR] BEGIN
         CLEAR LEDGER RPTMAST
         CLEARFORM SCRBAL
         RETURN QUIT_BAL_SCR
    END

    [DIV_SCR] BEGIN
         CLEAR DIVISION
         CLEARFORM
         RETURN QUIT_DIV_SCR
    END

    [REP_SCR][~ BUSY] BEGIN
         CLEAR LEDGER
         RETURN QUIT_REP
    END

    [LY_SCR] BEGIN
         CLEAR LEDGER
         CLEARFORM
         RETURN QUIT_LAST_YEAR_BAL
    END

    [BUD_SCR] BEGIN
         CLEARFORM SCRBUD
         CLEAR LEDGER
         RETURN QUIT_BUDGET
    END

    [REV_SCR] RETURN QUIT_REV_SCR
  
    [QIK_SCR] BEGIN
         RETURN QUIT_QIK_SCR
    END

    [START_SCR][PROS_SCR] BEGIN
         INDICATE PROS_SCR FALSE
         RETURN START_MENU
    END

    [START_SCR][HC_SCR] BEGIN
         INDICATE HC_SCR FALSE
         RETURN START_MENU
    END

    [START_SCR][MENU_SCR] BEGIN
         INDICATE MENU_SCR FALSE
         RETURN START_MENU
    END

    [START_SCR] BEGIN
         [~ MENU_SCR][~ HC_SCR][~ PROS_SCR] BEGIN
              GOTOXY 24 1
              SHOW " READY TO EXIT PROGRAM ? (Y/N) "
              INKEY CHAR
              IF CHAR IN "Yy" BEGIN
                   CLEARSCREEN
                   ABORT    //WILL RETURN TO PREVIOUS DATAFLEX MENU
              END
              ELSE BEGIN
                   CLEARXY 24 1
                   ENTAGAIN
                   RETURN
              END
         END
    END

    ENTAGAIN
  RETURN

//----< Key Proc   Key.help >--------------------------------------------------

  KEYPROC KEY.HELP
    [GEN_SCR][~ GEN2_SCR] BEGIN
         PAGE SCRGENHELP
         INKEY ANSW
         PAGE SCRGEN
    END

    [ADD_SCR] PAGE HELPSCR1
     
    [COMBINE_SCREENS]  BEGIN    
         PAGE SCRALTERHELP
         INKEY ANSW
         [ALTER_SCR][FIRST]   RETURN ASK_JR_COMBINE
         [ALTER_SCR][~ FIRST] RETURN DO_ENT1
         [ALTER2_SCR] ENTAGAIN           
    END

    [LY_SCR] BEGIN
         PAGE SCRLYHELP
         INKEY ANSW
         PAGE SCRLY
    END

    ENTAGAIN
  RETURN

//----< Key proc   Key.Field >-------------------------------------------------

  KEYPROC KEY.FIELD
    [GEN2_SCR] RETURN
    [GEN_SCR] RETURN
    BACKFIELD
  RETURN

//----< Key Proc   Key.Find >--------------------------------------------------

//----< Key Proc   Key.Save >--------------------------------------------------

  KEYPROC KEY.SAVE
    [MAST_SCR] RETURN SAVE_LEDGER_DOIT
    [ADD_SCR]  RETURN SAVE_ACC_QUES
    [DIV_SCR]  RETURN SAVE_DIV_QUES
    [LY_SCR]   RETURN SAVE_LAST_YEAR
    [BUD_SCR]  RETURN SAVE_BUDGET_QUES
    ENTAGAIN
  RETURN

//----< Key Proc   Key.Delete >------------------------------------------------

  KEYPROC KEY.DELETE
    [MAST_SCR] GOSUB NO_DELETE_MSG
    [ADD_SCR]  GOSUB NO_DELETE_MSG
    [GEN_SCR]  GOSUB NO_DELETE_MSG
    [DIV_SCR]  IF STATUS DIVISION BEGIN
         IF DIVISION.ACCOUNTS GT 0 BEGIN
              ERROR 125 "PRESS ANY KEY"
              INKEY ANSW
              CLEARWARNING
              CLEARFORM
              CLEAR DIVISION
              RETURN MASTER_DIV
         END                
  START_DIV_DEL:
         GOTOXY 24 0
         SHOW " Are You Sure You Want To delete This Division (Y/N).?"
         INKEY ANSW
         UPPERCASE ANSW
         IF ANSW EQ "Y" BEGIN          
              CLEARXY 24 0
              DELETE DIVISION
              CLEARFORM SCRDIV
         END
         IF ANSW EQ "N" CLEARXY 24 0
         IF NOT ANSW IN "YN" GOTO START_DIV_DEL
    END
    [LY_SCR]  GOSUB NO_DELETE_MSG
    [BUD_SCR] GOSUB NO_DELETE_MSG
    ENTAGAIN
  RETURN

//----< Key Proc   Key.Clear >-------------------------------------------------

  KEYPROC KEY.CLEAR
    [GEN_SCR] BEGIN
         MOVE REF.RUN_BAL TO SCRGEN.141
         CLEARFORM SCRGEN.4 THRU SCRGEN.140
         CLEAR LEDGER JOURNALS
         [multiuser] REREAD
              IF REF.REF_NUM EQ SEQ BEGIN
                   MOVE (SEQ - 1) TO REF.REF_NUM
                   SAVERECORD REF
              END
         [multiuser] UNLOCK
         RETURN GENERAL_JOURNAL
    END     
    [EDIT_SCR] BEGIN
         CLEAR LEDGER JOURNALS
         CLEARFORM SCREDIT
         RETURN EDIT_JOURNAL
    END 
    [ADD_SCR] BEGIN
         CLEAR LEDGER
         CLEARFORM SCRADD
    END
    [MAST_SCR] BEGIN
         CLEAR LEDGER
         CLEARFORM SCRMAST
    END
    [CHART_SCR] BEGIN
         CLEAR LEDGER
         CLEARFORM
    END
    [JR_SCR]  CLEARFORM SCRJR
    [LD_SCR]  CLEARFORM SCRLD
    [SEL_SCR] BEGIN           
         CLEARFORM SCRSEL
         CLEARFORM SCRSEL2
         MOVE 0 TO PAGECOUNT
         RETURN PRINT_JOURNALS_SELECT
    END
    [COMBINE_SCREENS] BEGIN
         [ALTER_SCR] CLEARFORM SCRALTER
         [ALTER_SCR] RETURN STARTOLD
         [ALTER2_SCR] CLEARFORM SCRALTER2
         [ALTER2_SCR] RETURN CREATENEW
    END
    [BAL_SCR] ENTAGAIN
    [DIV_SCR] CLEARFORM SCRDIV
    [LY_SCR]  BEGIN
         CLEARFORM SCRLY
         CLEAR LEDGER
         RETURN LAST_YEAR_BAL
    END
    [BUD_SCR] BEGIN
         CLEARFORM SCRBUD
         CLEAR LEDGER
         RETURN MAINTAIN_BUDGET
    END
    [ADD_SCR]   RETURN ADD_ACCOUNTS
    [MAST_SCR]  RETURN MASTER_LEDGER
    [CHART_SCR] RETURN CHART_LEDGER
//    [JR_SCR]    RETURN PRINT_JOURNALS
    [LD_SCR]    RETURN QUES4
    [DIV_SCR]   RETURN MASTER_DIV
    ENTAGAIN
  RETURN

//----< Key Proc   Key.Next >--------------------------------------------------

  KEYPROC KEY.NEXT

    [MAST_SCR] IF STATUS LEDGER BEGIN
         CLEAR LEDGER
         MOVE MAST_DEPT TO LEDGER.DIVISION
         MOVE MAST_DIV TO LEDGER.DISTRICT
         MOVE MAST_ACC TO LEDGER.NUMBER
         FIND GT LEDGER BY INDEX.2
         [FOUND] ENTDISPLAY LEDGER
         [FINDERR] ENTAGAIN
    END
    [MAST_SCR] IF ~ STATUS LEDGER BEGIN 
         CLEAR LEDGER
         MOVE MAST_DEPT TO LEDGER.DIVISION
         MOVE MAST_DIV TO LEDGER.DISTRICT
         MOVE MAST_ACC TO LEDGER.NUMBER
         FIND GE LEDGER BY INDEX.2
         [FOUND] ENTDISPLAY LEDGER
         [FINDERR] BEGIN
              CLEARXY 24 0
              GOTOXY 24 0
              SCREENMODE 112 ON
              SHOW "No Accounts Have Been Entered In The Ledger !! Press Space Bar to Continue."
              SCREENMODE 1 ON
              INKEY ANSW
              CLEARXY 24 0
              RETURN TOP_MAST
         END
    END

    [ADD_SCR] IF STATUS LEDGER BEGIN
         CLEAR LEDGER
         MOVE SCRADD.1 TO LEDGER.NUMBER
         MOVE SCRADD.2 TO LEDGER.DISTRICT
         MOVE SCRADD.3 TO LEDGER.DIVISION
         FIND GT LEDGER BY INDEX.1
         [FOUND] ENTDISPLAY LEDGER
         [FINDERR] ENTAGAIN
    END
    [ADD_SCR] IF ~ STATUS LEDGER BEGIN 
         CLEAR LEDGER
         FIND GE LEDGER BY INDEX.1
         [FOUND] ENTDISPLAY LEDGER
         [FINDERR] BEGIN
              CLEARXY 24 0
              GOTOXY 24 0
              SCREENMODE 112 ON
              SHOW " No Accounts Have Been Entered Into The Ledger !! Press Space Bar to Continue."
              SCREENMODE 1 ON
              MOVE '' TO ANSW
              INKEY ANSW
              CLEARXY 24 0
              RETURN TOP_MAST
         END
    END

    [DIV_SCR] BEGIN
         IF STATUS DIVISION FIND GT DIVISION BY INDEX.1
         IF ~ STATUS DIVISION FIND GE DIVISION BY INDEX.1
         [FINDERR] gosub err_msg_129
         [FOUND] ENTDISPLAY DIVISION
         RETURN TOP_DIV
    END

    [LY_SCR] BEGIN
         IF STATUS LEDGER FIND GT LEDGER BY INDEX.1
         IF ~ STATUS LEDGER FIND GE LEDGER BY INDEX.1
         [FINDERR] gosub err_msg_129
         [FOUND] ENTDISPLAY LEDGER
         RETURN PASS_TOP_LASTYR
    END

    [BUD_SCR] BEGIN
         IF STATUS LEDGER FIND GT LEDGER BY INDEX.1
         IF ~ STATUS LEDGER FIND GE LEDGER BY INDEX.1
         [FINDERR] gosub err_msg_129
         [FOUND] ENTDISPLAY LEDGER
         RETURN START_BUDGET 
    END

    [MAST_SCR] RETURN PASS_SCRMAST_FIND   
    [ADD_SCR]  RETURN ADD_ACCOUNTS
    ENTAGAIN 
  RETURN

//----< Key Proc   Key.Previous >----------------------------------------------

  KEYPROC KEY.PREVIOUS

    [MAST_SCR] IF STATUS LEDGER BEGIN
         CLEAR LEDGER
         MOVE MAST_DEPT TO LEDGER.DIVISION
         MOVE MAST_DIV TO LEDGER.DISTRICT
         MOVE MAST_ACC TO LEDGER.NUMBER
         FIND LT LEDGER BY INDEX.2
         [FOUND] ENTDISPLAY LEDGER
         [FINDERR] ENTAGAIN                 
    END
      
    [MAST_SCR] IF ~ STATUS LEDGER ENTAGAIN

    [ADD_SCR] IF STATUS LEDGER BEGIN
         CLEAR LEDGER
         MOVE SCRADD.1 TO LEDGER.NUMBER
         MOVE SCRADD.2 TO LEDGER.DISTRICT
         MOVE SCRADD.3 TO LEDGER.DIVISION
         FIND LT LEDGER BY INDEX.1
         [FOUND] ENTDISPLAY LEDGER
         [FINDERR] ENTAGAIN                 
    END

    [ADD_SCR] IF ~ STATUS LEDGER ENTAGAIN

    [DIV_SCR]  BEGIN
         IF STATUS DIVISION FIND LT DIVISION BY INDEX.1
         IF ~ STATUS DIVISION FIND LE DIVISION BY INDEX.1
         [FOUND] ENTDISPLAY DIVISION
         [FINDERR] gosub err_msg_129
    END

    [LY_SCR] BEGIN
         IF STATUS LEDGER FIND LT LEDGER BY INDEX.1
         IF ~ STATUS LEDGER FIND LE LEDGER BY INDEX.1
         [FINDERR] gosub err_msg_129
         [FOUND] ENTDISPLAY LEDGER
         RETURN PASS_TOP_LASTYR
    END

    [BUD_SCR] BEGIN
         IF STATUS LEDGER FIND LT LEDGER BY INDEX.1
         IF ~ STATUS LEDGER FIND LE LEDGER BY INDEX.1
         [FINDERR] gosub err_msg_129
         [FOUND] ENTDISPLAY LEDGER
         RETURN START_BUDGET
    END
      
    [MAST_SCR] RETURN PASS_SCRMAST_FIND   
    [ADD_SCR]  RETURN ADD_ACCOUNTS

    ENTAGAIN
  RETURN

//----< Key Proc   Key.up >----------------------------------------------------

  KEYPROC KEY.UP
    ENTAGAIN
  RETURN

//----< Key Proc   Key.Down >--------------------------------------------------

  KEYPROC KEY.DOWN
    ENTAGAIN
  RETURN

//----< Key Proc   Key.Print >--------------------------------------------------

  KEYPROC KEY.PRINT
    ENTAGAIN
  RETURN

//----< Key Proc   Key.User >--------------------------------------------------

  KEYPROC KEY.USER
    [SEL_SCR]  BEGIN
         PAGE SCRSEL2
         INKEY ANSW
         IF GLCOUNT LT 9 RETURN LOOKUP
         IF GLCOUNT GE 9 RETURN CONT
    END
    ENTAGAIN
  RETURN

//----< Key Proc   Key.User2 >-------------------------------------------------

  KEYPROC KEY.USER2
    ENTAGAIN
  RETURN
