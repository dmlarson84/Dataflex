/SCREEN resident
ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
ณ                                                                             ณ
ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
                                                                               
/SCREEN1 resident
รฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤด
ณ                                                                             ณ
ณ      Input File: _________________                                          ณ
ณ     Output File: _________________                                          ณ
ณ                                                                             ณ
ณ Lines Processed:        ____.                  Items Selected: ______.      ณ
ณ    Current Line:         ___.                                               ณ
ณ                                                                             ณ
ณ                                                                             ณ
ณ ___________________________________________________________________________ ณ
ณ                                                                             ณ
ณ                                                                             ณ
ณ                                                                             ณ
ณ Selection Criteria:                                                         ณ
ณ                                                                             ณ
ณ      ________      ________      ________      ________      ________       ณ
ณ      ________      ________      ________      ________      ________       ณ
ณ                                                                             ณ
ณ                                                                             ณ
ณ                                                                             ณ
ณ                                                                             ณ
ณ                                                                             ณ
ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
/SCREEN2 resident
รฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤด
ณ                                                                             ณ
ณ      Input File: _________________                                          ณ
ณ     Output File: _________________                                          ณ
ณ                                                                             ณ
ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
/SCREEN3 resident
รฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤด
ณ                                                                             ณ
ณ      Input File: _________________                                          ณ
ณ     Output File: _________________                                          ณ
ณ                                                                             ณ
ณ                                                                             ณ
ณ  Select Criteria:                                                           ณ
ณ                                                                             ณ
ณ                                                                             ณ
ณ      ________      ________      ________      ________      ________       ณ
ณ      ________      ________      ________      ________      ________       ณ
ณ                                                                             ณ
ณ                                                                             ณ
ณ                          Press <RETURN> To Select                           ณ
ณ                                                                             ณ
ณ Selected Criteria:                                                          ณ
ณ                                                                             ณ
ณ      ________      ________      ________      ________      ________       ณ
ณ      ________      ________      ________      ________      ________       ณ
ณ                                                                             ณ
ณ                                                                             ณ
ณ                                                                             ณ
ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
/INCS
ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
ณ____________ ____________ ____________ ____________ ____________ ____________ณ
ณ____________ ____________ ____________ ____________ ____________ ____________ณ
ณ____________ ____________ ____________ ____________ ____________ ____________ณ
ณ____________ ____________ ____________ ____________ ____________ ____________ณ
ณ____________ ____________ ____________ ____________ ____________ ____________ณ
ณ____________ ____________ ____________ ____________ ____________ ____________ณ
ณ____________ ____________ ____________ ____________ ____________ ____________ณ
ณ____________ ____________ ____________ ____________ ____________ ____________ณ
ณ____________ ____________ ____________ ____________ ____________ ____________ณ
ณ____________ ____________ ____________ ____________ ____________ ____________ณ
ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
/*
//ีอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออธ
//ณ           Name: FLEXUTIL.PRG                                            ณ
//ณ         System: Version Control System (VCS) v1.05a                     ณ
//ณ         Author: Gerald H. Ablan, Jr.   (312) 422-0203                   ณ
//ณ           Date: 06.01.87                                                ณ
//ณ       Modified:                                                         ณ
//ณ        Purpose: DataFlex Source Code Dissector                          ณ
//ิอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออพ
//
// You can just execute "DFRUN FLEXUTIL" or your command Line should 
// look like this:
//
// DFRUN FLEXUTIL [<filename>] [<options>] [NOWARN]
//
// Example: All labels & errors from file SAMPLE.FRM
//
//          "DFRUN FLEXUTIL SAMPLE.FRM LE"
//
// Example: Completely Dissect SAMPLE.FRM
//
//          "DFRUN FLEXUTIL SAMPLE.FRM"
//
// Example: Files opened, include files, & errors from file SAMPLE.FRM &
//          no warnings...
//
//          "DFRUN FLEXUTIL SAMPLE.FRM OIE NOWARN"
//
//
// There are 10 options for this program. If you don't specify any, all are
// selected. Otherwise, you must append each letter to the end of the command
// line. The options are:
//
//      A = Author
//      D = Date
//      E = Errors
//      I = Include Files
//      L = Label Names
//      M = Modified Date
//      N = Program Name
//      O = DataFlex Files that are opened
//      P = Purpose
//      S = System Name
//    VCS = For VCS output...
//
// Options A, D, M, N, S and P are derived from the standard file descriptor
// that follows...
//
//ีอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออธ
//ณ           Name: xxxxxxxx.xxx                                            ณ
//ณ         System: xxxxxxxxxxxxxxxxxxxxxxxxxxxx                            ณ
//ณ         Author: xxxxxxxxxxxxxxxxxxxx                                    ณ
//ณ           Date: xx.xx.xx                                                ณ
//ณ       Modified: xx.xx.xx                                                ณ
//ณ        Purpose: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx ณ
//ิอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออพ
// 
// The "x"'s represent the maximum field lengths.
//
// The remaining options are all taken from the program.
//
// All include files are read in for processing along with the specified 
// input file, please make these available to FLEXUTIL.
//
// All #INCLUDE and OPEN statements must be within the first 10 characters of
// a line for them to be recognized.
//
// If you have questions or comments, please direct them to:
//
// Jerry Ablan   
// 9339 S. Richmond Ave. 
// Evergreen Park, IL. 60642
//
//
// This program is PUBLIC DOMAIN.
// 
// Feel free to distribute it to your friends, but keep this message intact.
// FLEXUTIL (c) 1987 By Gerald H. Ablan, Jr.  All Rights Reserved
//
// If you like this program, and would like to purchase the version control
// system that it belongs to, please send $25.00 to the above address. This
// will get you the ENHANCED FlexUtil(tm), the new, and improved VCS (used
// by developers worldwide (honest!)) and free updates and other stuff.
//
// Shareware Systems & Other Systems available:
//
// Name                                Price                  Source Code
//==============================================================================
// VCS (w/FlexUtil(tm))                $ 25.00		      N/A (Comes free!)
//
// CBS (Client Billing System)         $100.00		      $100.00
// PTS (Problem Tracking System)       $100.00                $100.00
//
// CBS & PTS are full blown applications and are really cool for software 
// developers, and consultants like myself. I recommend highly that you add
// these two winners to your DataFlex software library...(p.s. Runtimes not
// included...)
//
//
//**********> Declare Variables <*********************************************
//	

	string	the_line 78	attrib 1	temp_string 255	
	string	comment 2	comstr 2	options 6
	string	esc 1		flash 1         noflash 1
        string  error_name      response
	
	integer x       y       line_length     label_length    front_length
        integer rear_length     label_position  total_includes

        indicator nowarn

	character 27  to esc
	character 138 to flash
	character 5   to noflash

        move 'SIGNAL.ERROR' to error_name       // Change to your error name

//
//**********> Initialize Screens <********************************************
//	

INITIALIZE_SCREENS:
	page set SCREEN  at 0  0
	page set SCREEN1 at 2  0
	page set SCREEN2 at 2  0
	page set SCREEN3 at 2  0
        page set INCS    at 10 0
    
    	name screen1
		name 	w_file_in
                name	w_file_out
                name    w_line_count
                name	w_total_labs
                name    w_current_line

                name    w_screenmessage

		name 	w_opt1
                name	w_opt2
                name	w_opt3
                name	w_opt4
                name	w_opt5
                name	w_opt6
		name	w_opt7
                name	w_opt8
                name	w_opt9
                name	w_opt10

        name screen2
                name    s_file_in
                name    s_file_out

        name screen3
                name    s_file_in_2
                name    s_file_out_2

                name    c_1
                name    c_2
                name    c_3
                name    c_4
                name    c_5
                name    c_6
                name    c_7
                name    c_8
                name    c_9
                name    c_10

                name    sc_1
                name    sc_2
                name    sc_3
                name    sc_4
                name    sc_5
                name    sc_6
                name    sc_7
                name    sc_8
                name    sc_9
                name    sc_10

	character 47 to comment
	append comment comment

//
//**********> Initialize Program <********************************************
//	

INITIALIZE_PROGRAM:
        #INCLUDE POINT.INC

	blankform screen1

	cmdline w_file_in
	cmdline w_file_out
	cmdline options

	uppercase w_file_in
	uppercase w_file_out
	uppercase options

        gosub PROCESS_OPTIONS
        gosub DISPLAY_CRITERIA

//
//**********> Main Program Routine <******************************************
//	

MAIN:   gosub SHOW_TOP
	page screen1

	gosub CHECK_EXIST
	outfile w_file_out

	direct_input w_file_in
	[seqeof] begin
		gosub SHOW_TOP
		move 'Cannot Open File ' to the_line
		append the_line w_file_in '.'
		gosub SHOW_PROBLEM
	end

	gotoxy 23 35
	show esc flash 'Working...' esc noflash

	move 0 to w_total_labs
	move 0 to windowindex
	blankform incs
	indicate including false

        move 'Processing: ' to the_line
        append the_line w_file_in '...'                       // Display
        move the_line to w_screenmessage

	gosub READ_FILE				            // read main file

	move windowindex to total_includes
	indicate including true

	for windowindex from 0 to total_includes
		if incs.1& ne '' begin

                        move 'Processing: ' to the_line
                        append the_line incs.1& '...'       // Display
                        move the_line to w_screenmessage

			direct_input incs.1&	
				[seqeof] begin
					move 'Include File: ' to the_line
					append the_line incs.1& ' Not Found.'
					gosub flash_message
				end
				[not seqeof] begin
					move incs.1& to w_file_in
					gosub READ_FILE
				end
		end
ENDLPA:	loop

	gosub SHOW_TOP
	outclose
	close_input
system

//
//**********> Check Exist <***************************************************
//	

//
// This routine checks for the existance of the .LAB file before it is opened.
// If it exists, a message and prompt is shown to overwrite or not. The
// "NOWARN" option overrides this prompting.
//

CHECK_EXIST:
	direct_input w_file_out
	[not nowarn][not seqeof] begin
		gotoxy 22 20
		screenmode 2
		show '*** ' 
		screenmode 1
		show esc flash 'File Exists' esc noflash
		screenmode 2
		show ' *** '
		screenmode 1
		show 'Overwrite? (Y/N) - '
		repeat
			inkey attrib
			uppercase attrib
			until attrib in 'Y|N'

		show attrib

		if attrib eq 'N' begin
			gosub SHOW_TOP
			system
		end
	end
	close_input
	screenmode off
	gotoxy 22 20
	show '                                               '
return

//
//**********> Process Command Line Options <**********************************
//	

PROCESS_OPTIONS:
	if w_file_in eq '' goto NO_FILE_IN

	indicate nowarn as 'NOWARN' in w_file_out
        [nowarn] move '' to w_file_out

        [not nowarn] indicate nowarn as 'NOWARN' in options

	indicate VCS as 'VCS' in w_file_out
	[vcs] move '' to w_file_out

        [not vcs] indicate vcs as 'VCS' in options

	if w_file_out eq '' begin
		indicate m_author   true
		indicate m_date     true
[not vcs]	indicate m_errors   true
		indicate m_includes true
[not vcs]	indicate m_labels   true
		indicate m_modified true
		indicate m_name     true
		indicate m_opens    true
		indicate m_purpose  true
		indicate m_system   true
	end
	else begin
		indicate m_author   as 'A' in w_file_out
		indicate m_date     as 'D' in w_file_out
		indicate m_errors   as 'E' in w_file_out
		indicate m_includes as 'I' in w_file_out
		indicate m_labels   as 'L' in w_file_out
		indicate m_modified as 'M' in w_file_out
		indicate m_name     as 'N' in w_file_out
		indicate m_opens    as 'O' in w_file_out
		indicate m_purpose  as 'P' in w_file_out
		indicate m_system   as 'S' in w_file_out
	end
	
	pos '.' in w_file_in to x
	left w_file_in to w_file_out (x-1)
	append w_file_out '.LAB'
        insert '.\' in w_file_out at 1
return

//
//**********> Display Criteria Routine <**************************************
//	

DISPLAY_CRITERIA:
        move 0 to windowindex

	[m_author]   move 'Author'   to w_opt1&
	[m_author]   increment windowindex
        [m_date]     move 'Date'     to w_opt1&
        [m_date]     increment windowindex
	[m_errors]   move 'Errors'   to w_opt1&
	[m_errors]   increment windowindex
	[m_includes] move 'Includes' to w_opt1&
	[m_includes] increment windowindex
	[m_labels]   move 'Labels'   to w_opt1&
	[m_labels]   increment windowindex
	[m_modified] move 'Modified' to w_opt1&
	[m_modified] increment windowindex
	[m_name]     move 'Name'     to w_opt1&
	[m_name]     increment windowindex
	[m_opens]    move 'Opens'    to w_opt1&
	[m_opens]    increment windowindex
	[m_purpose]  move 'Purpose'  to w_opt1&
	[m_purpose]  increment windowindex
	[m_system]   move 'System'   to w_opt1&
	[m_system]   increment windowindex
return

//
//**********> Flash Message Routine <*****************************************
//	

//
// This routine flashes text stored in THE_LINE on the 22nd line of the
// screen and prompted to press any key...
//

FLASH_MESSAGE:
        append the_line ' Press Any Key To Continue...'
	length the_line to line_length
	gotoxy 22 ((80 - line_length)/2)
	show esc flash the_line esc noflash
	inkey attrib
	uppercase attrib
	gotoxy 22 ((80 - line_length)/2)
	for x from 1 to line_length
		show ' '
	loop
return

//
//**********> Label Routine <*************************************************
//	

GOT_ONE:
    	left temp_string to comstr 2
    	indicate not valid as comment in comstr
	[valid] indicate not valid as '"' in temp_string
	[valid] indicate not valid as "'" in temp_string
    	[valid] begin
		pos comment in temp_string to label_position
		if label_position gt 0 move (label_position - 2) to label_position
		if label_position gt 0 mid temp_string to temp_string label_position 1
		trim temp_string to temp_string

		pos ':' in temp_string to y
		move (y-1) to x
		mid temp_string to temp_string x 1
		uppercase temp_string
		move (w_total_labs + 1) to w_total_labs
                pad temp_string to temp_string 50
		writeln temp_string ' (Label <' w_file_in ',' w_current_line '>)'
	end
return

//
//**********> Include Routine <***********************************************
//	

GOT_INCLUDE:
    left temp_string to comstr 2
    indicate not valid as comment in comstr
    [valid] pos '#INCLUDE' in temp_string to label_position
    [valid] indicate valid as label_position le 10
    [valid] begin
	pos comment in temp_string to label_position
	if label_position gt 0 move (label_position - 2) to label_position
	if label_position gt 0 mid temp_string to temp_string label_position 1
	trim temp_string to temp_string

        length temp_string to line_length
        pos '#INCLUDE' in temp_string to label_position
        right temp_string to temp_string (line_length - (label_position + 8))
	replace '#INCLUDE' in temp_string with ''
	move (w_total_labs + 1) to w_total_labs
        trim temp_string to temp_string
	move temp_string to incs.1&
	increment windowindex
        pad temp_string to temp_string 50
        [m_includes] writeln temp_string ' (Included <' w_file_in ',' w_current_line '>)'
    end
return

//
//**********> Error Routine <*************************************************
//	

GOT_ERROR:
    left temp_string to comstr 2
    indicate not valid as comment in comstr
    [valid] begin
	pos comment in temp_string to label_position
	if label_position gt 0 move (label_position - 2) to label_position
	if label_position gt 0 mid temp_string to temp_string label_position 1
	trim temp_string to temp_string

        length temp_string to line_length
        pos error_name in temp_string to label_position
        right temp_string to temp_string (line_length - (label_position + 12))
	replace error_name in temp_string with ''
	move (w_total_labs + 1) to w_total_labs
        pad temp_string to temp_string 43
	if temp_string ne '' writeln 'Error #' temp_string ' (Error <' w_file_in ',' w_current_line '>)'
    end
return

//
//**********> Open Routine <**************************************************
//	

GOT_OPEN:
    left temp_string to comstr 2
    indicate not valid as comment in comstr
    [valid] indicate not valid as '"' in temp_string
    [valid] indicate not valid as "'" in temp_string
    [valid] pos 'OPEN' in temp_string to label_position
    [valid] indicate valid as label_position le 10
    [valid] begin
	pos comment in temp_string to label_position
	if label_position gt 0 move (label_position - 2) to label_position
	if label_position gt 0 mid temp_string to temp_string label_position 1
	trim temp_string to temp_string

        length temp_string to line_length
        pos 'OPEN' in temp_string to label_position
        right temp_string to temp_string (line_length - (label_position + 4))
	replace 'OPEN' in temp_string with ''
        trim temp_string to temp_string

        indicate valid as temp_string ne ''
            [valid] ;
                begin
                    move (w_total_labs + 1) to w_total_labs
                    pad temp_string to temp_string 50       
                    writeln temp_string ' (Opened <' w_file_in ',' w_current_line '>)'
                end
    end
return

//
//**********> Name Routine <**************************************************
//	

GOT_NAME:
	replace 'ณ' in temp_string with ''
	replace 'ณ' in temp_string with ''
	replace comment in temp_string with ''
	replace 'NAME:' in temp_string with ''
	trim temp_string to temp_string
	move (w_total_labs + 1) to w_total_labs
        pad temp_string to temp_string 50
        writeln temp_string ' (Name <' w_file_in ',' w_current_line '>)'
return

//
//**********> Date Routine <**************************************************
//	

GOT_DATE:
	replace 'ณ' in temp_string with ''
	replace 'ณ' in temp_string with ''
	replace comment in temp_string with ''
	replace 'DATE:' in temp_string with ''
	trim temp_string to temp_string
	move (w_total_labs + 1) to w_total_labs
        pad temp_string to temp_string 50 
        writeln temp_string ' (Date <' w_file_in ',' w_current_line '>)'
return

//
//**********> Modified Routine <**********************************************
//	

GOT_MODIFIED:
	replace 'ณ' in temp_string with ''
	replace 'ณ' in temp_string with ''
	replace comment in temp_string with ''
	replace 'MODIFIED:' in temp_string with ''
	trim temp_string to temp_string
	move (w_total_labs + 1) to w_total_labs
        pad temp_string to temp_string 50
        writeln temp_string ' (Modified <' w_file_in ',' w_current_line '>)'
return

//
//**********> Author Routine <************************************************
//	

GOT_AUTHOR:
	replace 'ณ' in temp_string with ''
	replace 'ณ' in temp_string with ''
	replace comment in temp_string with ''
	replace 'AUTHOR:' in temp_string with ''
	trim temp_string to temp_string
	left temp_string to temp_string 20
	trim temp_string to temp_string
	move (w_total_labs + 1) to w_total_labs
        pad temp_string to temp_string 50
        writeln temp_string ' (Author <' w_file_in ',' w_current_line '>)'
return

//
//**********> System Routine <************************************************
//	

GOT_SYSTEM:
	replace 'ณ' in temp_string with ''
	replace 'ณ' in temp_string with ''
	replace comment in temp_string with ''
	replace 'SYSTEM:' in temp_string with ''
	trim temp_string to temp_string
	left temp_string to temp_string 28
	trim temp_string to temp_string
	move (w_total_labs + 1) to w_total_labs
        pad temp_string to temp_string 50
        writeln temp_string ' (System <' w_file_in ',' w_current_line '>)'
return

//
//**********> Purpose Routine <***********************************************
//	

GOT_PURPOSE:
	replace 'ณ' in temp_string with ''
	replace 'ณ' in temp_string with ''
	replace comment in temp_string with ''
	replace 'PURPOSE:' in temp_string with ''
	trim temp_string to temp_string
	move (w_total_labs + 1) to w_total_labs
        pad temp_string to temp_string 50
        writeln temp_string ' (Purpose <' w_file_in ',' w_current_line '>)'
return

//
//**********> Read File Routine <*********************************************
//	

READ_FILE:
	repeat
		[not seqeof] readln temp_string

		[not seqeof] move (w_line_count + 1)   to w_line_count
                [not seqeof] move (w_current_line + 1) to w_current_line

		[not seqeof] if '/*' in temp_string goto NXTLP
		[not seqeof] [including] if not comment in temp_string goto NXTLP
		[not seqeof] loop

NXTLP:	repeat
		[not seqeof] readln temp_string
                [not seqeof] keycheck gosub ABORT_RTN

		[not seqeof] move (w_line_count + 1)   to w_line_count
                [not seqeof] move (w_current_line + 1) to w_current_line

		[not seqeof] uppercase temp_string

		[not seqeof] [m_author]   if comment    in temp_string if 'AUTHOR:' in temp_string gosub GOT_AUTHOR
		[not seqeof] [m_date]     if comment    in temp_string if 'DATE:' in temp_string gosub GOT_DATE
		[not seqeof] [m_errors]   if error_name in temp_string gosub GOT_ERROR
		[not seqeof]              if '#INCLUDE' in temp_string gosub GOT_INCLUDE
		[not seqeof] [m_labels]   if ':'        in temp_string gosub GOT_ONE
		[not seqeof] [m_modified] if comment    in temp_string if 'MODIFIED:' in temp_string gosub GOT_MODIFIED
		[not seqeof] [m_name]     if comment    in temp_string if 'NAME:' in temp_string gosub GOT_NAME
		[not seqeof] [m_opens]    if 'OPEN'     in temp_string gosub GOT_OPEN
		[not seqeof] [m_purpose]  if comment    in temp_string if 'PURPOSE:' in temp_string gosub GOT_PURPOSE
		[not seqeof] [m_system]   if comment    in temp_string if 'SYSTEM:' in temp_string gosub GOT_SYSTEM

		[not seqeof] loop
	close_input
        move 0 to w_current_line
return

//
//**********> Show Problem <**************************************************
//	

SHOW_PROBLEM:
	length the_line to x
	gotoxy 12 ((80-x)/2)
	show the_line
	for x from 1 to 1000
	loop
	gotoxy 23 0
	show 'Press Any Key To Return To DOS...'
	inkey attrib
	system
return

//=====> Show Top <============================================================

SHOW_TOP:
	page screen
	screenmode 1
        move '      FlexUtil Version 2.00 (c) Copyright 1987 By Gerald H. Ablan, Jr.     ' to the_line
	character 27  to esc
	character 112 to attrib
	gotoxy 1 2
	show esc attrib the_line
	character 5 to attrib
	show esc attrib
return

keyproc key.escape 
        if current_window le 30 if current_window ge 20 return DONE_SELECT
        else gosub ABORT_RTN
return

//=====> No Options Selected <=================================================

NO_FILE_IN:
        blankform screen3

        screenmode 2 on
	move 'Author'   to c_1
        move 'Date'     to c_2
	move 'Errors'   to c_3
	move 'Includes' to c_4
	move 'Labels'   to c_5
	move 'Modified' to c_6
	move 'Name'     to c_7
	move 'Opens'    to c_8
	move 'Purpose'  to c_9
	move 'System'   to c_10
        screenmode off

        clearscreen
        gosub SHOW_TOP
        page screen2

        accept s_file_in {capslock}
                if s_file_in eq '' gosub BACK_FIELD

	pos '.' in s_file_in to x
	left s_file_in to s_file_out (x-1)
	append s_file_out '.LAB'
        insert '.\' in s_file_out at 1

        accept s_file_out {capslock}
                if s_file_out eq '' gosub BACK_FIELD

        move s_file_in  to w_file_in
        move s_file_out to w_file_out

        move s_file_in  to s_file_in_2
        move s_file_out to s_file_out_2

        page screen3

        move 1 to label_position

        repeat
                point_select screen3.3 1 10 5 to label_position label_position
                move (label_position - 1) to windowindex
                move c_1& to sc_1&

                if label_position eq 1  indicate m_author   true   
        	if label_position eq 2  indicate m_date     true   
        	if label_position eq 3  indicate m_errors   true   
        	if label_position eq 4  indicate m_includes true   
        	if label_position eq 5  indicate m_labels   true   
        	if label_position eq 6  indicate m_modified true   
        	if label_position eq 7  indicate m_name     true   
        	if label_position eq 8  indicate m_opens    true   
	        if label_position eq 9  indicate m_purpose  true   
                if label_position eq 10 indicate m_system   true
        
                loop

DONE_SELECT:
        move 'Process? (Y/N) - ' to the_line
        length the_line to line_length
        gotoxy 23 2
        show '                                                            '
        gotoxy 23 ((80-line_length)/2)
        show the_line

        repeat
                inkey response
                uppercase response
                until response in 'Y|N'

        if response eq 'N' system
return

//=====> Backfield Routine <===================================================

BACK_FIELD:
        backfield
return

//=====> Abort Routine <=======================================================

ABORT_RTN:
        move 'Abort This Program? (Y/N) - ' to the_line
        length the_line to line_length
        gotoxy 22 ((80-line_length)/2)
        show the_line

        repeat
            inkey response
            uppercase response
        until response in 'Y|N'

        if response eq 'Y' system
 
        gotoxy 22 2
        show '                                                            '
return

